<!DOCTYPE html><html lang="zh" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.5.0 for Hugo" />
  

  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
    <meta name="google-site-verification" content="google69a5cccb61297807" />
    <meta name="baidu-site-verification" content="cqmZHEleVh" />
  
  
  
  
    
    
    
  
  

  <meta name="author" content="宋净超" />

  
  
  
    
  
  <meta name="description" content="Tetrate Service Bridge collects a large number of metrics. This page is generated from dashboards ran internally at Tetrate and will be updated periodically based on best practices learned from operational experiences in Tetrate and from user deployments. Each heading represents a different dashboard, and each sub-heading is a panel on this dashboard. For this reason, you may see metrics appear multiple times.
The metrics described in this document build up a series of Grafana dashboards that can be downloaded from here, so you can import them into your Grafana setup.
GitOps Operational Status Operational metrics to indicate Cluster GitOps health" />

  
  <link rel="alternate" hreflang="zh" href="https://lib.jimmysong.io/tsb/operations/telemetry/key-metrics/" />

  
  
  
    <meta name="theme-color" content="#0a55a7" />
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css" media="print" onload="this.media='all'">

  
  
  
    
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.b26eb9b802629dccab300faa82cc98c7.css" />

  




<script async src="https://www.googletagmanager.com/gtag/js?id=G-MP490FS739"></script>

<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', "G-MP490FS739");
</script>


  


  


  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?2a4b7f65b1839466beaa48d633aa60c1";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  
  
  

  

  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu0f7d075e895d6f5f1f5fdbc1e33dc138_10087_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://lib.jimmysong.io/tsb/operations/telemetry/key-metrics/" />

  
  
  
  
  
  
  
  
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary_large_image" />
  
    <meta property="twitter:site" content="@jimmysongio" />
    <meta property="twitter:creator" content="@jimmysongio" />
  
  <meta property="og:site_name" content="云原生资料库" />
  <meta property="og:url" content="https://lib.jimmysong.io/tsb/operations/telemetry/key-metrics/" />
  <meta property="og:title" content="Key Metrics | 云原生资料库" />
  <meta property="og:description" content="Tetrate Service Bridge collects a large number of metrics. This page is generated from dashboards ran internally at Tetrate and will be updated periodically based on best practices learned from operational experiences in Tetrate and from user deployments. Each heading represents a different dashboard, and each sub-heading is a panel on this dashboard. For this reason, you may see metrics appear multiple times.
The metrics described in this document build up a series of Grafana dashboards that can be downloaded from here, so you can import them into your Grafana setup.
GitOps Operational Status Operational metrics to indicate Cluster GitOps health" /><meta property="og:image" content="https://lib.jimmysong.io/media/sharing.png" />
    <meta property="twitter:image" content="https://lib.jimmysong.io/media/sharing.png" /><meta property="og:locale" content="zh" />
  
    
      <meta
        property="article:published_time"
        content="2023-08-09T12:00:00&#43;08:00"
      />
    
    <meta property="article:modified_time" content="2023-09-18T14:32:42&#43;08:00">
  

  



  

  

  





  <title>Key Metrics | 云原生资料库</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="752cb06b1c9051d2755545213592252a" >
  <button onclick="topFunction()" id="backTopBtn" title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden="true"></i></button>
  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.62d6f8dfe8493f1c68557dde65bec362.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6 search-title">
          <p>搜索</p>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="关闭"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="搜索..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="搜索...">
        
      </div>

      
      

      
    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

      <div id="search-common-queries">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    











  


<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/"><img src="/media/logo.svg" alt="云原生资料库"
            
            ></a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="切换导航">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/"><img src="/media/logo.svg" alt="云原生资料库"
          
          ></a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#books"><span>图书</span></a>
          </li>

          
          

          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>教程</span><span class="caret"></span>
            </a>
            <div class="dropdown-menu">
              
                <a class="dropdown-item" href="/kubernetes-handbook"><span>Kubernetes 基础教程</span></a>
              
                <a class="dropdown-item" href="https://academy.tetrate.io/courses/istio-fundamentals-zh"><span>Istio 基础教程</span></a>
              
                <a class="dropdown-item" href="https://academy.tetrate.io/courses/envoy-fundamentals-zh"><span>Envoy 基础教程</span></a>
              
            </div>
          </li>

          
          

          

          
          
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/blog"><span>译文</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#feed"><span>更新</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#tags"><span>标签</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>关于</span></a>
          </li>

          
          

          

          
          
          
            
              
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="https://jimmysong.io" target="_blank" rel="noopener"><span>Jimmy Song</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
            
            <li class="nav-item d-none d-lg-inline-flex">
              <a class="nav-link" href="https://jimmysong.io/contact/" data-toggle="tooltip" data-placement="bottom" title="联系" target="_blank" rel="noopener" aria-label="联系">
                <i class="fab fa-weixin" aria-hidden="true"></i>
              </a>
            </li>
          
            
            <li class="nav-item d-none d-lg-inline-flex">
              <a class="nav-link" href="https://twitter.com/jimmysongio" data-toggle="tooltip" data-placement="bottom" title="关注" target="_blank" rel="noopener" aria-label="关注">
                <i class="fab fa-twitter" aria-hidden="true"></i>
              </a>
            </li>
          
        

        
        <li class="nav-item">
            <a class="nav-link" href="https://jimmysong.io" target="_blank" rel="noopener" data-toggle="tooltip" data-placement="bottom" title="主站" aria-label="主站"><i class="fas fa-home" aria-hidden="true"></i></a>
        </li>
        

        
        
        <li class="nav-item">
            <a class="nav-link js-search" href="#" data-toggle="tooltip" data-placement="bottom" title="搜索" aria-label="搜索"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        <li class="nav-item d-none d-lg-inline-flex">
            <a class="nav-link" href="https://github.com/rootsongjc/cloud-native-library/" target="_blank" rel="noopener" data-toggle="tooltip" data-placement="bottom" title="查看源码" aria-label="查看源码" aria-label="GitHub"><i class="fa-brands fa-github" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item">
          <a href="#" class="nav-link set-theme">
            <i class="fa fa-sun" aria-hidden="true" id="theme-icon"></i>
          </a>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    




<div class="container-xl docs">
  <div class="row flex-xl-nowrap">
    <div class="docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <div class="d-flex">
      <span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">
        
          运维指南
        
      </span>
      <span><i class="fas fa-chevron-down"></i></span>
    </div>
  </button>

  
  <button class="form-control sidebar-search js-search d-none d-md-flex">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">搜索...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      



  
    
    
    
    
      
    
    

    
      <ul class="nav docs-sidenav">
          <li class="level "><a href="/tsb/"><i class="fas fa-book pr-1"></i>Tetrate Service Bridge 中文文档</a></li>
    
      



  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id3d30fe67a2f2650cf7b814847b9fc266&#34;)" href="#id3d30fe67a2f2650cf7b814847b9fc266" aria-expanded="false" aria-controls="id3d30fe67a2f2650cf7b814847b9fc266" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/release-notes-announcements/">TSB 1.6 发行说明</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id3d30fe67a2f2650cf7b814847b9fc266" aria-expanded="false" aria-controls="id3d30fe67a2f2650cf7b814847b9fc266">
    
        <i class="fa-solid fa-angle-right" id="caret-id3d30fe67a2f2650cf7b814847b9fc266"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id3d30fe67a2f2650cf7b814847b9fc266">
      



  <li class="child level "><a href="/tsb/release-notes-announcements/support-policy/">TSB 支持策略</a></li>




  <li class="child level "><a href="/tsb/release-notes-announcements/feature-status/">功能状态</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id3b0baa6baef458c089cd1b065e550681&#34;)" href="#id3b0baa6baef458c089cd1b065e550681" aria-expanded="false" aria-controls="id3b0baa6baef458c089cd1b065e550681" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/concepts/">概念</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id3b0baa6baef458c089cd1b065e550681" aria-expanded="false" aria-controls="id3b0baa6baef458c089cd1b065e550681">
    
        <i class="fa-solid fa-angle-right" id="caret-id3b0baa6baef458c089cd1b065e550681"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id3b0baa6baef458c089cd1b065e550681">
      



  <li class="child level "><a href="/tsb/concepts/service-mesh/">服务网格简介</a></li>




  <li class="child level "><a href="/tsb/concepts/architecture/">TSB 架构</a></li>




  <li class="child level "><a href="/tsb/concepts/security/">安全</a></li>




  <li class="child level "><a href="/tsb/concepts/traffic-management/">流量管理</a></li>




  <li class="child level "><a href="/tsb/concepts/observability/">全局可观测性</a></li>




  <li class="child level "><a href="/tsb/concepts/configuration-dataflow/">配置的数据流</a></li>




  <li class="child level "><a href="/tsb/concepts/terminology/">术语</a></li>




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id455c76a6e893f5810403789454118039&#34;)" href="#id455c76a6e893f5810403789454118039" aria-expanded="false" aria-controls="id455c76a6e893f5810403789454118039" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/concepts/operators/">TSB Operator</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id455c76a6e893f5810403789454118039" aria-expanded="false" aria-controls="id455c76a6e893f5810403789454118039">
    
        <i class="fa-solid fa-angle-right" id="caret-id455c76a6e893f5810403789454118039"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id455c76a6e893f5810403789454118039">
      



  <li class="child level "><a href="/tsb/concepts/operators/management-plane/">管理平面</a></li>




  <li class="child level "><a href="/tsb/concepts/operators/control-plane/">控制平面</a></li>




  <li class="child level "><a href="/tsb/concepts/operators/data-plane/">数据平面</a></li>

      
        </ul>
      
    

    
      </div>
    

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id9c8d5edee8fcb5c6a4202ed0aae66c57&#34;)" href="#id9c8d5edee8fcb5c6a4202ed0aae66c57" aria-expanded="false" aria-controls="id9c8d5edee8fcb5c6a4202ed0aae66c57" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/setup/">安装与升级</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id9c8d5edee8fcb5c6a4202ed0aae66c57" aria-expanded="false" aria-controls="id9c8d5edee8fcb5c6a4202ed0aae66c57">
    
        <i class="fa-solid fa-angle-right" id="caret-id9c8d5edee8fcb5c6a4202ed0aae66c57"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id9c8d5edee8fcb5c6a4202ed0aae66c57">
      



  <li class="child level "><a href="/tsb/setup/requirements-and-download/">先决条件和下载</a></li>




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-idd25e30387a56dbb163b60a8a6b01566a&#34;)" href="#idd25e30387a56dbb163b60a8a6b01566a" aria-expanded="false" aria-controls="idd25e30387a56dbb163b60a8a6b01566a" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/setup/self-managed/">使用 tctl 安装</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#idd25e30387a56dbb163b60a8a6b01566a" aria-expanded="false" aria-controls="idd25e30387a56dbb163b60a8a6b01566a">
    
        <i class="fa-solid fa-angle-right" id="caret-idd25e30387a56dbb163b60a8a6b01566a"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="idd25e30387a56dbb163b60a8a6b01566a">
      



  <li class="child level "><a href="/tsb/setup/self-managed/demo-installation/">演示安装</a></li>




  <li class="child level "><a href="/tsb/setup/self-managed/management-plane-installation/">管理平面安装</a></li>




  <li class="child level "><a href="/tsb/setup/self-managed/onboarding-clusters/">加入集群</a></li>




  <li class="child level "><a href="/tsb/setup/self-managed/uninstallation/">TSB 卸载</a></li>




  <li class="child level "><a href="/tsb/setup/self-managed/upgrade/">TSB 升级</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-idc725c0e507058bb12e15a35d994f3d67&#34;)" href="#idc725c0e507058bb12e15a35d994f3d67" aria-expanded="false" aria-controls="idc725c0e507058bb12e15a35d994f3d67" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/setup/helm/">使用 Helm 安装</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#idc725c0e507058bb12e15a35d994f3d67" aria-expanded="false" aria-controls="idc725c0e507058bb12e15a35d994f3d67">
    
        <i class="fa-solid fa-angle-right" id="caret-idc725c0e507058bb12e15a35d994f3d67"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="idc725c0e507058bb12e15a35d994f3d67">
      



  <li class="child level "><a href="/tsb/setup/helm/helm/">TSB Helm Chart</a></li>




  <li class="child level "><a href="/tsb/setup/helm/managementplane/">管理平面安装</a></li>




  <li class="child level "><a href="/tsb/setup/helm/controlplane/">控制平面安装</a></li>




  <li class="child level "><a href="/tsb/setup/helm/dataplane/">数据平面安装</a></li>




  <li class="child level "><a href="/tsb/setup/helm/upgrade/">TSB Helm 升级</a></li>




  <li class="child level "><a href="/tsb/setup/helm/uninstallation/">Helm TSB 卸载</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id24a65c33a9b493c7b9671794da2e21fc&#34;)" href="#id24a65c33a9b493c7b9671794da2e21fc" aria-expanded="false" aria-controls="id24a65c33a9b493c7b9671794da2e21fc" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/setup/workload-onboarding/">载入工作负载</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id24a65c33a9b493c7b9671794da2e21fc" aria-expanded="false" aria-controls="id24a65c33a9b493c7b9671794da2e21fc">
    
        <i class="fa-solid fa-angle-right" id="caret-id24a65c33a9b493c7b9671794da2e21fc"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id24a65c33a9b493c7b9671794da2e21fc">
      



  <li class="child level "><a href="/tsb/setup/workload-onboarding/onboarding-vms/">Onboarding VMs with tctl</a></li>




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-idf57cfc61402f3e44110dd41ca87ad66d&#34;)" href="#idf57cfc61402f3e44110dd41ca87ad66d" aria-expanded="false" aria-controls="idf57cfc61402f3e44110dd41ca87ad66d" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/setup/workload-onboarding/guides/">Workload Onboarding</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#idf57cfc61402f3e44110dd41ca87ad66d" aria-expanded="false" aria-controls="idf57cfc61402f3e44110dd41ca87ad66d">
    
        <i class="fa-solid fa-angle-right" id="caret-idf57cfc61402f3e44110dd41ca87ad66d"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="idf57cfc61402f3e44110dd41ca87ad66d">
      



  <li class="child level "><a href="/tsb/setup/workload-onboarding/guides/managing/">Managing Onboarded Workloads</a></li>




  <li class="child level "><a href="/tsb/setup/workload-onboarding/guides/ecs-workloads/">Onboarding AWS ECS workloads</a></li>




  <li class="child level "><a href="/tsb/setup/workload-onboarding/guides/on-premise-workloads/">Onboarding on-premise workloads</a></li>




  <li class="child level "><a href="/tsb/setup/workload-onboarding/guides/onboarding/">Onboarding VMs</a></li>




  <li class="child level "><a href="/tsb/setup/workload-onboarding/guides/overview/">Overview</a></li>




  <li class="child level "><a href="/tsb/setup/workload-onboarding/guides/setup/">Setting Up Workload Onboarding</a></li>




  <li class="child level "><a href="/tsb/setup/workload-onboarding/guides/troubleshooting/">Troubleshooting Guide</a></li>

      
        </ul>
      
    

    
      </div>
    

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-iddaffab814adc52c72a8fca403c941062&#34;)" href="#iddaffab814adc52c72a8fca403c941062" aria-expanded="false" aria-controls="iddaffab814adc52c72a8fca403c941062" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/setup/aws/">AWS</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#iddaffab814adc52c72a8fca403c941062" aria-expanded="false" aria-controls="iddaffab814adc52c72a8fca403c941062">
    
        <i class="fa-solid fa-angle-right" id="caret-iddaffab814adc52c72a8fca403c941062"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="iddaffab814adc52c72a8fca403c941062">
      



  <li class="child level "><a href="/tsb/setup/aws/container-marketplace/">Install Tetrate Service Bridge from the AWS Container Marketplace</a></li>




  <li class="child level "><a href="/tsb/setup/aws/vpc/">Install Tetrate Service Bridge In AWS</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-idfcce4143b4bc2fa5dc77f908a4761366&#34;)" href="#idfcce4143b4bc2fa5dc77f908a4761366" aria-expanded="false" aria-controls="idfcce4143b4bc2fa5dc77f908a4761366" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/setup/certificate/">证书安装</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#idfcce4143b4bc2fa5dc77f908a4761366" aria-expanded="false" aria-controls="idfcce4143b4bc2fa5dc77f908a4761366">
    
        <i class="fa-solid fa-angle-right" id="caret-idfcce4143b4bc2fa5dc77f908a4761366"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="idfcce4143b4bc2fa5dc77f908a4761366">
      



  <li class="child level "><a href="/tsb/setup/certificate/certificate-setup/">证书类型</a></li>




  <li class="child level "><a href="/tsb/setup/certificate/certificate-requirements/">内部证书要求</a></li>




  <li class="child level "><a href="/tsb/setup/certificate/automated-certificate-management/">自动证书管理</a></li>

      
        </ul>
      
    

    
      </div>
    




  <li class="child level "><a href="/tsb/setup/tctl-connect/">Connect to TSB with tctl</a></li>




  <li class="child level "><a href="/tsb/setup/resource-planning/">Resource Consumption and Capacity Planning</a></li>




  <li class="child level "><a href="/tsb/setup/components/">TSB Components</a></li>




  <li class="child level "><a href="/tsb/setup/firewall-information/">Firewall Information</a></li>




  <li class="child level "><a href="/tsb/setup/isolation-boundaries/">Istio 隔离边界</a></li>




  <li class="child level "><a href="/tsb/setup/remote-registry/">Repository secrets</a></li>




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id062c132c14e80e34ad3ed84386661dc0&#34;)" href="#id062c132c14e80e34ad3ed84386661dc0" aria-expanded="false" aria-controls="id062c132c14e80e34ad3ed84386661dc0" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/setup/upgrades/">控制平面升级</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id062c132c14e80e34ad3ed84386661dc0" aria-expanded="false" aria-controls="id062c132c14e80e34ad3ed84386661dc0">
    
        <i class="fa-solid fa-angle-right" id="caret-id062c132c14e80e34ad3ed84386661dc0"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id062c132c14e80e34ad3ed84386661dc0">
      



  <li class="child level "><a href="/tsb/setup/upgrades/non-revisioned-to-revisioned/">非版本到版本的升级</a></li>




  <li class="child level "><a href="/tsb/setup/upgrades/revisioned-to-revisioned/">已修订版本间的升级</a></li>




  <li class="child level "><a href="/tsb/setup/upgrades/gateway-upgrade/">网关升级</a></li>




  <li class="child level "><a href="/tsb/setup/upgrades/cni-upgrade/">修订的 Istio CNI 和升级</a></li>

      
        </ul>
      
    

    
      </div>
    




  <li class="child level "><a href="/tsb/setup/migrate-tctl-to-helm/">Migration from tctl to Helm</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-idac10970f4e8c33d6bbce355138dde5d4&#34;)" href="#idac10970f4e8c33d6bbce355138dde5d4" aria-expanded="false" aria-controls="idac10970f4e8c33d6bbce355138dde5d4" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/quickstart/">快速入门</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#idac10970f4e8c33d6bbce355138dde5d4" aria-expanded="false" aria-controls="idac10970f4e8c33d6bbce355138dde5d4">
    
        <i class="fa-solid fa-angle-right" id="caret-idac10970f4e8c33d6bbce355138dde5d4"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="idac10970f4e8c33d6bbce355138dde5d4">
      



  <li class="child level "><a href="/tsb/quickstart/introduction/">快速开始简介</a></li>




  <li class="child level "><a href="/tsb/quickstart/deploy-sample-app/">部署应用程序</a></li>




  <li class="child level "><a href="/tsb/quickstart/tenant/">创建租户</a></li>




  <li class="child level "><a href="/tsb/quickstart/workspace/">创建工作区</a></li>




  <li class="child level "><a href="/tsb/quickstart/config-groups/">创建配置组</a></li>




  <li class="child level "><a href="/tsb/quickstart/permissions/">配置权限</a></li>




  <li class="child level "><a href="/tsb/quickstart/ingress-gateway/">入口网关</a></li>




  <li class="child level "><a href="/tsb/quickstart/observability/">拓扑和指标</a></li>




  <li class="child level "><a href="/tsb/quickstart/traffic-shifting/">流量转移</a></li>




  <li class="child level "><a href="/tsb/quickstart/security/">安全</a></li>




  <li class="child level "><a href="/tsb/quickstart/apps/">创建应用程序和 API</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id0ec9af575b8b763b648f8c99ff17610d&#34;)" href="#id0ec9af575b8b763b648f8c99ff17610d" aria-expanded="false" aria-controls="id0ec9af575b8b763b648f8c99ff17610d" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/howto/">操作任务</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id0ec9af575b8b763b648f8c99ff17610d" aria-expanded="false" aria-controls="id0ec9af575b8b763b648f8c99ff17610d">
    
        <i class="fa-solid fa-angle-right" id="caret-id0ec9af575b8b763b648f8c99ff17610d"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id0ec9af575b8b763b648f8c99ff17610d">
      



  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id8450b6d97b7826af020d05b3b52bbecb&#34;)" href="#id8450b6d97b7826af020d05b3b52bbecb" aria-expanded="false" aria-controls="id8450b6d97b7826af020d05b3b52bbecb" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/howto/traffic/">流量管理和迁移</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id8450b6d97b7826af020d05b3b52bbecb" aria-expanded="false" aria-controls="id8450b6d97b7826af020d05b3b52bbecb">
    
        <i class="fa-solid fa-angle-right" id="caret-id8450b6d97b7826af020d05b3b52bbecb"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id8450b6d97b7826af020d05b3b52bbecb">
      



  <li class="child level "><a href="/tsb/howto/traffic/splitting-service-traffic-between-k8s-vms/">Splitting Service Traffic between K8S and VMs</a></li>




  <li class="child level "><a href="/tsb/howto/traffic/migrating-vm-monoliths/">Migrating VM Monoliths to your cluster</a></li>




  <li class="child level "><a href="/tsb/howto/traffic/load-balance/">Client Side Load Balancing</a></li>




  <li class="child level "><a href="/tsb/howto/traffic/external-site-https/">Send traffic to an External Host using HTTPS</a></li>




  <li class="child level "><a href="/tsb/howto/traffic/configure-multi-port-service-route/">Configure ServiceRoute for (multi-port, multi-protocol) services</a></li>




  <li class="child level "><a href="/tsb/howto/traffic/canary-releases/">Canary Releases</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id5753a2129f592fd5880e50dd8423acaf&#34;)" href="#id5753a2129f592fd5880e50dd8423acaf" aria-expanded="false" aria-controls="id5753a2129f592fd5880e50dd8423acaf" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/howto/gateway/">配置网关</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id5753a2129f592fd5880e50dd8423acaf" aria-expanded="false" aria-controls="id5753a2129f592fd5880e50dd8423acaf">
    
        <i class="fa-solid fa-angle-right" id="caret-id5753a2129f592fd5880e50dd8423acaf"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id5753a2129f592fd5880e50dd8423acaf">
      



  <li class="child level "><a href="/tsb/howto/gateway/unified-gateway/">统一网关</a></li>




  <li class="child level "><a href="/tsb/howto/gateway/service-identity-propagation/">Multicluster Access Control and Identity Propagation</a></li>




  <li class="child level "><a href="/tsb/howto/gateway/subset-based-routing-using-igw-and-service-route/">使用 IngressGateway 和 ServiceRoute 基于子集的流量路由</a></li>




  <li class="child level "><a href="/tsb/howto/gateway/multi-cluster-traffic-routing-with-eastwest-gateway/">Multi-cluster traffic failover with EastWest Gateways</a></li>




  <li class="child level "><a href="/tsb/howto/gateway/multi-cluster-traffic-routing-using-tier2gw/">Multi-cluster traffic routing using Tier-2 gateway</a></li>




  <li class="child level "><a href="/tsb/howto/gateway/multi-cluster-traffic-shifting/">Multi cluster traffic shifting with Tier-1 Gateway</a></li>




  <li class="child level "><a href="/tsb/howto/gateway/end-user-auth-keycloak/">End User Authentication with Keycloak</a></li>




  <li class="child level "><a href="/tsb/howto/gateway/egress-gateways/">Controlling Access to External Services</a></li>




  <li class="child level "><a href="/tsb/howto/gateway/distributed-ingress/">Distributed Ingress Gateways</a></li>




  <li class="child level "><a href="/tsb/howto/gateway/configure-and-route-nonhttp-traffic/">Configure and route HTTP, non-HTTP (multi-protocol) and multi-port service traffic in TSB</a></li>




  <li class="child level "><a href="/tsb/howto/gateway/application-gateway-with-openapi-annotations/">Configuring Application Gateways Using OpenAPI Annotations</a></li>




  <li class="child level "><a href="/tsb/howto/gateway/app-ingress/">App Ingress</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id3cf5ddd3a394b71d7fe2cbfced2c0084&#34;)" href="#id3cf5ddd3a394b71d7fe2cbfced2c0084" aria-expanded="false" aria-controls="id3cf5ddd3a394b71d7fe2cbfced2c0084" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/howto/gitops/">GitOps</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id3cf5ddd3a394b71d7fe2cbfced2c0084" aria-expanded="false" aria-controls="id3cf5ddd3a394b71d7fe2cbfced2c0084">
    
        <i class="fa-solid fa-angle-right" id="caret-id3cf5ddd3a394b71d7fe2cbfced2c0084"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id3cf5ddd3a394b71d7fe2cbfced2c0084">
      



  <li class="child level "><a href="/tsb/howto/gitops/gitops/">TSB 中的 GitOps</a></li>




  <li class="child level "><a href="/tsb/howto/gitops/flux/">Configuring Flux CD for GitOps</a></li>




  <li class="child level "><a href="/tsb/howto/gitops/argo-rollouts/">Canary Analysis &amp; Progressive Delivery Using Argo Rollout and SkyWalking</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id75d83e78f127600ecb3d62fc4fb7258f&#34;)" href="#id75d83e78f127600ecb3d62fc4fb7258f" aria-expanded="false" aria-controls="id75d83e78f127600ecb3d62fc4fb7258f" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/howto/rate-limiting/">Rate Limiting Traffic</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id75d83e78f127600ecb3d62fc4fb7258f" aria-expanded="false" aria-controls="id75d83e78f127600ecb3d62fc4fb7258f">
    
        <i class="fa-solid fa-angle-right" id="caret-id75d83e78f127600ecb3d62fc4fb7258f"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id75d83e78f127600ecb3d62fc4fb7258f">
      



  <li class="child level "><a href="/tsb/howto/rate-limiting/internal-rate-limiting/">Enabling the Internal Rate Limiting Server</a></li>




  <li class="child level "><a href="/tsb/howto/rate-limiting/ingress-gateway/">Rate Limiting in Ingress Gateway</a></li>




  <li class="child level "><a href="/tsb/howto/rate-limiting/service-to-service/">Service to service rate limiting</a></li>




  <li class="child level "><a href="/tsb/howto/rate-limiting/tier1-gateway/">Rate limiting in Tier-1 Gateway</a></li>




  <li class="child level "><a href="/tsb/howto/rate-limiting/external-rate-limiting/">Setting Up an External Rate Limiting Server</a></li>




  <li class="child level "><a href="/tsb/howto/rate-limiting/tls-validation/">External Rate Limiting with TLS Verification</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id7cbc5bd680a87da6558c04275045cb6d&#34;)" href="#id7cbc5bd680a87da6558c04275045cb6d" aria-expanded="false" aria-controls="id7cbc5bd680a87da6558c04275045cb6d" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/howto/authorization/">External Authorization</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id7cbc5bd680a87da6558c04275045cb6d" aria-expanded="false" aria-controls="id7cbc5bd680a87da6558c04275045cb6d">
    
        <i class="fa-solid fa-angle-right" id="caret-id7cbc5bd680a87da6558c04275045cb6d"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id7cbc5bd680a87da6558c04275045cb6d">
      



  <li class="child level "><a href="/tsb/howto/authorization/sidecar/">Service to service authorization using external authorization</a></li>




  <li class="child level "><a href="/tsb/howto/authorization/ingress-gateway/">Configuring External Authorization in Ingress Gateways</a></li>




  <li class="child level "><a href="/tsb/howto/authorization/tls-verification/">External Authz with TLS verification</a></li>




  <li class="child level "><a href="/tsb/howto/authorization/tier1-gateway/">External Authorization in Tier-1 Gateways</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-ide54efaf5f496781cf3c3ef789f3781d2&#34;)" href="#ide54efaf5f496781cf3c3ef789f3781d2" aria-expanded="false" aria-controls="ide54efaf5f496781cf3c3ef789f3781d2" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/howto/wasm/">Using WASM extensions</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#ide54efaf5f496781cf3c3ef789f3781d2" aria-expanded="false" aria-controls="ide54efaf5f496781cf3c3ef789f3781d2">
    
        <i class="fa-solid fa-angle-right" id="caret-ide54efaf5f496781cf3c3ef789f3781d2"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="ide54efaf5f496781cf3c3ef789f3781d2">
      



  <li class="child level "><a href="/tsb/howto/wasm/wasm-overview/">Overview</a></li>




  <li class="child level "><a href="/tsb/howto/wasm/wasm-extension/">TSB configuration</a></li>




  <li class="child level "><a href="/tsb/howto/wasm/wasm-try/">Example</a></li>

      
        </ul>
      
    

    
      </div>
    




  <li class="child level "><a href="/tsb/howto/waf/">Using WAF Capabilities</a></li>




  <li class="child level "><a href="/tsb/howto/hpa-using-skywalking/">HPA using SkyWalking</a></li>




  <li class="child level "><a href="/tsb/howto/service-accounts/">Leveraging TSB service accounts</a></li>




  <li class="child level "><a href="/tsb/howto/security-domains/">Creating Security Domains</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id1e39d08ed50e978f0b3e95104b86a45b&#34;)" href="#id1e39d08ed50e978f0b3e95104b86a45b" aria-expanded="false" aria-controls="id1e39d08ed50e978f0b3e95104b86a45b" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/operations/">运维指南</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id1e39d08ed50e978f0b3e95104b86a45b" aria-expanded="false" aria-controls="id1e39d08ed50e978f0b3e95104b86a45b">
    
    <i class="fa-solid fa-angle-down" id="caret-id1e39d08ed50e978f0b3e95104b86a45b"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  show " id="id1e39d08ed50e978f0b3e95104b86a45b">
      



  <li class="child level "><a href="/tsb/operations/telemetry/alerting-guidelines/">Alerting Guidelines</a></li>




  <li class="child level "><a href="/tsb/operations/users/oidc-azure/">Azure AD as the Identity Provider</a></li>




  <li class="child level "><a href="/tsb/operations/postgresql/">Backup and restore PostgreSQL</a></li>




  <li class="child level "><a href="/tsb/operations/users/admin-password/">Change The Administrator Password</a></li>




  <li class="child level "><a href="/tsb/operations/features/enable-config-protection/">Config Protection</a></li>




  <li class="child level "><a href="/tsb/operations/configuration-promotion/">Configuration Promotion</a></li>




  <li class="child level "><a href="/tsb/operations/features/configure-cluster-external-addresses/">Configure cluster external addresses</a></li>




  <li class="child level "><a href="/tsb/operations/configure-log-levels/">Configure Log Levels</a></li>




  <li class="child level "><a href="/tsb/operations/multiple-iam-keys/">Configure multiple IAM token validation keys</a></li>




  <li class="child level "><a href="/tsb/operations/kube-customization/">Customizing TSB Kubernetes Components</a></li>




  <li class="child level "><a href="/tsb/operations/features/edge-dns-resolution/">DNS Resolution at Edge</a></li>




  <li class="child level "><a href="/tsb/operations/vault/elasticsearch/">Elasticsearch Credentials</a></li>




  <li class="child level "><a href="/tsb/operations/elasticsearch/elasticsearch-role/">Elasticsearch privileges</a></li>




  <li class="child level "><a href="/tsb/operations/elasticsearch/wipe-elastic/">Elasticsearch wipe procedure</a></li>




  <li class="child level "><a href="/tsb/operations/features/gateway-deletion-webhook/">Gateway Deletion Hold Webhook</a></li>




  <li class="child level "><a href="/tsb/operations/features/configure-gitops/">GitOps</a></li>




  <li class="child level "><a href="/tsb/operations/graceful-connection-drain/">Graceful Connection Drain of istio-proxy</a></li>




  <li class="child level "><a href="/tsb/operations/vault/istiod-ca/">Istio CA</a></li>




  <li class="child level "><a href="/tsb/operations/features/istio-cni/">Istio CNI</a></li>




  <li class="child level active"><a href="/tsb/operations/telemetry/key-metrics/">Key Metrics</a></li>




  <li class="child level "><a href="/tsb/operations/users/configuring-ldap/">LDAP as the Identity Provider</a></li>




  <li class="child level "><a href="/tsb/operations/lower-istio-resources/">Lower Istio Resource Consumption</a></li>




  <li class="child level "><a href="/tsb/operations/migrate-organization/">Move Data To A New Organization</a></li>




  <li class="child level "><a href="/tsb/operations/telemetry/new-relic/">New Relic integration</a></li>




  <li class="child level "><a href="/tsb/operations/vault/postgresql/">PostgreSQL Credentials</a></li>




  <li class="child level "><a href="/tsb/operations/users/roles-and-permissions/">Roles and Permissions</a></li>




  <li class="child level "><a href="/tsb/operations/telemetry/red-metrics/">Sidecar RED Metrics</a></li>




  <li class="child level "><a href="/tsb/operations/features/streaming-log/">Streaming Service Logs</a></li>




  <li class="child level "><a href="/tsb/operations/telemetry/telemetry-architecture/">Telemetry Architecture</a></li>




  <li class="child level "><a href="/tsb/operations/features/tier1-in-app-cluster/">Tier1 Gateway in an App Cluster</a></li>




  <li class="child level "><a href="/tsb/operations/users/user-synchronization/">User Synchronization</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id1545fcd4f1609551da975e2c615ad00b&#34;)" href="#id1545fcd4f1609551da975e2c615ad00b" aria-expanded="false" aria-controls="id1545fcd4f1609551da975e2c615ad00b" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/troubleshooting/">问题排查</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id1545fcd4f1609551da975e2c615ad00b" aria-expanded="false" aria-controls="id1545fcd4f1609551da975e2c615ad00b">
    
        <i class="fa-solid fa-angle-right" id="caret-id1545fcd4f1609551da975e2c615ad00b"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id1545fcd4f1609551da975e2c615ad00b">
      



  <li class="child level "><a href="/tsb/troubleshooting/troubleshooting/">Basic troubleshooting</a></li>




  <li class="child level "><a href="/tsb/troubleshooting/cluster-onboarding/">Cluster onboarding troubleshooting</a></li>




  <li class="child level "><a href="/tsb/troubleshooting/configuration-status/">Configuration status troubleshooting</a></li>




  <li class="child level "><a href="/tsb/troubleshooting/identify-underperforming-services/">Identify Underperforming Services</a></li>




  <li class="child level "><a href="/tsb/troubleshooting/gateway-troubleshooting/">Ingress Gateway troubleshooting</a></li>




  <li class="child level "><a href="/tsb/troubleshooting/maximum-header-size-exceed/">Maximum Header Size Exceed</a></li>




  <li class="child level "><a href="/tsb/troubleshooting/multiple-transfer-encoding-chunked/">Multiple Transfer Encoding Chunked</a></li>




  <li class="child level "><a href="/tsb/troubleshooting/tsb-ui-metrics/">UI Metrics Troubleshooting</a></li>




  <li class="child level "><a href="/tsb/troubleshooting/debug-container/">Using The Debug Container</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-id0a05687586ea2ab4204a2561c9f624d0&#34;)" href="#id0a05687586ea2ab4204a2561c9f624d0" aria-expanded="false" aria-controls="id0a05687586ea2ab4204a2561c9f624d0" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/reference/">参考</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#id0a05687586ea2ab4204a2561c9f624d0" aria-expanded="false" aria-controls="id0a05687586ea2ab4204a2561c9f624d0">
    
        <i class="fa-solid fa-angle-right" id="caret-id0a05687586ea2ab4204a2561c9f624d0"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="id0a05687586ea2ab4204a2561c9f624d0">
      



  <li class="child level "><a href="/tsb/reference/k8s-api/tsb-crds-gen/"></a></li>




  <li class="child level "><a href="/tsb/reference/cli/">Getting Started</a></li>




  <li class="child level "><a href="/tsb/reference/grpc-api/guide/">gRPC API Guide</a></li>




  <li class="child level "><a href="/tsb/reference/samples/httpbin/">Installing httpbin</a></li>




  <li class="child level "><a href="/tsb/reference/samples/opa/">Installing Open Policy Agent</a></li>




  <li class="child level "><a href="/tsb/reference/samples/sleep-service/">Installing sleep</a></li>




  <li class="child level "><a href="/tsb/reference/rest-api/guide/">REST API Guide</a></li>




  <li class="child level "><a href="/tsb/reference/cli/reference/tctl/">tctl</a></li>




  <li class="child level "><a href="/tsb/reference/cli/reference/apply/">tctl apply</a></li>




  <li class="child level "><a href="/tsb/reference/cli/reference/collect/">tctl collect</a></li>




  <li class="child level "><a href="/tsb/reference/cli/reference/completion/">tctl completion</a></li>




  <li class="child level "><a href="/tsb/reference/cli/reference/config/">tctl config</a></li>




  <li class="child level "><a href="/tsb/reference/cli/reference/delete/">tctl delete</a></li>




  <li class="child level "><a href="/tsb/reference/cli/reference/edit/">tctl edit</a></li>




  <li class="child level "><a href="/tsb/reference/cli/reference/experimental/">tctl experimental</a></li>




  <li class="child level "><a href="/tsb/reference/cli/reference/get/">tctl get</a></li>




  <li class="child level "><a href="/tsb/reference/cli/reference/install/">tctl install</a></li>




  <li class="child level "><a href="/tsb/reference/cli/reference/login/">tctl login</a></li>




  <li class="child level "><a href="/tsb/reference/cli/reference/ui/">tctl ui</a></li>




  <li class="child level "><a href="/tsb/reference/cli/reference/validate/">tctl validate</a></li>




  <li class="child level "><a href="/tsb/reference/cli/reference/version/">tctl version</a></li>




  <li class="child level "><a href="/tsb/reference/cli/reference/whoami/">tctl whoami</a></li>




  <li class="child level "><a href="/tsb/reference/k8s-api/guide/">TSB CRD Reference</a></li>




  <li class="child level "><a href="/tsb/reference/cli/reference/workload-entry-annotations/">WorkloadEntry Annotations</a></li>




  <li class="child level "><a href="/tsb/reference/yaml-api/guide/">YAML API Guide</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-ide176d22749d73536e461f4fe09cdb7ae&#34;)" href="#ide176d22749d73536e461f4fe09cdb7ae" aria-expanded="false" aria-controls="ide176d22749d73536e461f4fe09cdb7ae" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/refs/">API</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#ide176d22749d73536e461f4fe09cdb7ae" aria-expanded="false" aria-controls="ide176d22749d73536e461f4fe09cdb7ae">
    
        <i class="fa-solid fa-angle-right" id="caret-ide176d22749d73536e461f4fe09cdb7ae"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="ide176d22749d73536e461f4fe09cdb7ae">
      



  <li class="child level "><a href="/tsb/refs/tsb/rbac/v2/access-bindings/">Access Bindings</a></li>




  <li class="child level "><a href="/tsb/refs/onboarding/config/agent/v1alpha1/agent-configuration/">Agent Configuration</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/application/v2/api/">API</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/rbac/v2/api-access-bindings/">API Access Bindings</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/application/v2/application/">Application</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/rbac/v2/application-access-bindings/">Application Access Bindings</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/application/v2/application-service/">Application Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/q/v2/approvals-service/">Approvals Service</a></li>




  <li class="child level "><a href="/tsb/refs/audit/v1/audit/">Audit</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/auth/v2/auth/">Auth</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/gateway/v2/auth/">Auth</a></li>




  <li class="child level "><a href="/tsb/refs/onboarding/config/types/identity/aws/v1alpha1/aws/">AWS Identity</a></li>




  <li class="child level "><a href="/tsb/refs/onboarding/config/authorization/aws/v1alpha1/aws/">AWS Identity Matcher</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/v2/cluster-service/">Cluster Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/v2/cluster/">Clusters</a></li>




  <li class="child level "><a href="/tsb/refs/install/common/common-config/">Common Configuration Objects</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/types/v2/types/">Common Object Types</a></li>




  <li class="child level "><a href="/tsb/refs/onboarding/config/types/core/v1alpha1/condition/">Condition</a></li>




  <li class="child level "><a href="/tsb/refs/install/controlplane/v1alpha1/spec/">Control Plane</a></li>




  <li class="child level "><a href="/tsb/refs/onboarding/config/types/core/v1alpha1/namespaced-name/">Core types</a></li>




  <li class="child level "><a href="/tsb/refs/install/dataplane/v1alpha1/spec/">Data Plane</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/gateway/v2/eastwest-gateway/">East/West Gateway</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/gateway/v2/egress-gateway/">Egress Gateway</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/gateway/v2/gateway/">Gateway</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/rbac/v2/gateway-access-bindings/">Gateway Access Bindings</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/gateway/v2/gateway-common/">Gateway Common Configuration Messages</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/gateway/v2/gateway-group/">Gateway Group</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/gateway/v2/gateway-service/">Gateway Service</a></li>




  <li class="child level "><a href="/tsb/refs/onboarding/config/types/registration/v1alpha1/hostinfo/">Host Info</a></li>




  <li class="child level "><a href="/tsb/refs/iam/v2/oauth-service/">IAM (OAuth)</a></li>




  <li class="child level "><a href="/tsb/refs/iam/v2/oidc-service/">IAM (OIDC)</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/v2/info/">Info</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/gateway/v2/ingress-gateway/">Ingress Gateway</a></li>




  <li class="child level "><a href="/tsb/refs/install/helm/common/v1alpha1/common/">install/helm/common/v1alpha1/common.proto</a></li>




  <li class="child level "><a href="/tsb/refs/install/helm/controlplane/v1alpha1/values/">install/helm/controlplane/v1alpha1/values.proto</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/gateway/v2/istio-gateway-direct/">Istio Direct Mode Gateway Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/security/v2/istio-security-direct/">Istio Direct Mode Security Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/traffic/v2/istio-traffic-direct/">Istio Direct Mode Traffic Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/rbac/v2/istio-internal-access-bindings/">Istio Internal Access Bindings</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/istiointernal/v2/istio-istiointernal-direct/">Istio Internal Direct Mode Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/istiointernal/v2/istiointernal-service/">Istio Internal Direct Mode Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/istiointernal/v2/istio-internal-group/">Istio internal Group</a></li>




  <li class="child level "><a href="/tsb/refs/istio.io/api/operator/v1alpha1/operator/">IstioOperator Options</a></li>




  <li class="child level "><a href="/tsb/refs/onboarding/config/types/identity/jwt/v1alpha1/jwt/">JWT Identity</a></li>




  <li class="child level "><a href="/tsb/refs/onboarding/config/authorization/jwt/v1alpha1/jwt/">JWT Identity Matcher</a></li>




  <li class="child level "><a href="/tsb/refs/onboarding/config/install/v1alpha1/jwt-issuer/">JWT Issuer</a></li>




  <li class="child level "><a href="/tsb/refs/install/kubernetes/k8s/">Kubernetes</a></li>




  <li class="child level "><a href="/tsb/refs/install/managementplane/v1alpha1/spec/">Management Plane</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/observability/telemetry/v2/metric/">Metric</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/observability/telemetry/v2/metric-service/">Metric Service</a></li>




  <li class="child level "><a href="/tsb/refs/onboarding/config/agent/v1alpha1/onboarding-configuration/">Onboarding Configuration</a></li>




  <li class="child level "><a href="/tsb/refs/onboarding/config/authorization/v1alpha1/policy/">Onboarding Policy</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/application/v2/openapi-extensions/">OpenAPI Extensions</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/v2/organization/">Organization</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/rbac/v2/organization-access-bindings/">Organization Access Bindings</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/v2/organization-setting/">Organization Setting</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/v2/organization-service/">Organizations Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/rbac/v2/permissions/">Permissions</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/q/v2/permissions-service/">Permissions Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/rbac/v2/binding/">Policy Bindings</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/rbac/v2/policy-service/">Policy Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/registry/v2/service/">Registered Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/rbac/v2/role/">Role</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/rbac/v2/role-service/">Role Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/rbac/v2/security-access-bindings/">Security Access Bindings</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/security/v2/security-group/">Security Group</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/security/v2/security-service/">Security Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/security/v2/security-setting/">Security Setting</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/registry/v2/lookup-service/">Service Registry Lookup Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/traffic/v2/service-route/">Service Route</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/security/v2/service-security-setting/">Service Security Setting</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/registry/v2/registration-service/">Servive Registry Registration Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/observability/telemetry/v2/source/">Source</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/v2/status/">Status</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/v2/status-service/">Status Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/v2/team/">Teams and Users</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/v2/team-service/">Teams Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/observability/telemetry/v2/source-service/">Telemetry Source Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/v2/tenant/">Tenant</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/rbac/v2/tenant-access-bindings/">Tenant Access Bindings</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/v2/tenant-service/">Tenant Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/v2/tenant-setting/">Tenant Setting</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/gateway/v2/tier1-gateway/">Tier1 Gateway</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/rbac/v2/traffic-access-bindings/">Traffic Access Bindings</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/traffic/v2/traffic-group/">Traffic Group</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/traffic/v2/traffic-service/">Traffic Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/traffic/v2/traffic-setting/">Traffic Setting</a></li>




  <li class="child level "><a href="/tsb/refs/onboarding/config/types/config/v1alpha1/transport-security/">Transport layer security config</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/security/v2/waf-settings/">WAF Settings</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/extension/v2/wasm-extension/">WASM Extension</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/extension/v2/wasm-service/">WasmExtension Service</a></li>




  <li class="child level "><a href="/tsb/refs/onboarding/config/runtime/v1alpha1/registration/">Workload Auto Registration</a></li>




  <li class="child level "><a href="/tsb/refs/onboarding/config/install/v1alpha1/workload-configuration/">Workload Configuration</a></li>




  <li class="child level "><a href="/tsb/refs/onboarding/config/types/identity/v1alpha1/identity/">Workload Identity</a></li>




  <li class="child level "><a href="/tsb/refs/onboarding/config/types/registration/v1alpha1/registration/">Workload Registration</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/v2/workspace/">Workspace</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/rbac/v2/workspace-access-bindings/">Workspace Access Bindings</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/v2/workspace-service/">Workspace Service</a></li>




  <li class="child level "><a href="/tsb/refs/tsb/v2/workspace-setting/">Workspace Setting</a></li>

      
        </ul>
      
    

    
      </div>
    




  
    
    
    
    
      
    
    

    
    
    
    <div class="docs-toc-item has-child">
    <div class="parent-node d-flex justify-content-between" onClick="Collapse(&#34;caret-idd067b9f805c069b82516c7d6bafcc0b1&#34;)" href="#idd067b9f805c069b82516c7d6bafcc0b1" aria-expanded="false" aria-controls="idd067b9f805c069b82516c7d6bafcc0b1" aria-hidden="false" data-toggle="collapse">
    
    <a class="d-inline docs-toc-link " href="/tsb/knowledge-base/">知识库和 FAQ</a>
    <a class="nav-toogle d-inline level" aria-hidden="false" data-toggle="collapse" href="#idd067b9f805c069b82516c7d6bafcc0b1" aria-expanded="false" aria-controls="idd067b9f805c069b82516c7d6bafcc0b1">
    
        <i class="fa-solid fa-angle-right" id="caret-idd067b9f805c069b82516c7d6bafcc0b1"></i>
    
    </a>
    
    </div>
    
      
      <ul class="nav docs-sidenav collapse  " id="idd067b9f805c069b82516c7d6bafcc0b1">
      



  <li class="child level "><a href="/tsb/knowledge-base/gitops/">Service Mesh and GitOps</a></li>




  <li class="child level "><a href="/tsb/knowledge-base/faq/">TSB 常见问题解答</a></li>

      
        </ul>
      
    

    
      </div>
    

      
    

    
      </ul>
    

  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      
     
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">目录</a></li>
      </ul>
     

      <nav id="TableOfContents">
  <ul>
    <li><a href="#gitops-operational-status">GitOps Operational Status</a>
      <ul>
        <li><a href="#gitops-status">GitOps Status</a></li>
        <li><a href="#accepted-admission-requests">Accepted Admission Requests</a></li>
        <li><a href="#rejected-admission-requests">Rejected Admission Requests</a></li>
        <li><a href="#admission-review-latency">Admission Review Latency</a></li>
        <li><a href="#resources-pushed-to-tsb">Resources Pushed to TSB</a></li>
        <li><a href="#failed-pushes-to-tsb">Failed pushes to TSB</a></li>
        <li><a href="#resources-conversions">Resources Conversions</a></li>
        <li><a href="#resources-conversions-errors">Resources conversions errors</a></li>
      </ul>
    </li>
    <li><a href="#global-configuration-distribution">Global Configuration Distribution</a>
      <ul>
        <li><a href="#connected-clusters">Connected Clusters</a></li>
        <li><a href="#tsb-error-rate-humans">TSB Error Rate (Humans)</a></li>
        <li><a href="#istio-envoy-sync-time-99th-percentile">Istio-Envoy Sync Time (99th Percentile)</a></li>
        <li><a href="#xcp-central---edge-sync-time-99th-percentile">XCP central -&gt; edge Sync Time (99th Percentile)</a></li>
        <li><a href="#istiod-errors">Istiod Errors</a></li>
      </ul>
    </li>
    <li><a href="#istio-operational-status">Istio Operational Status</a>
      <ul>
        <li><a href="#connected-envoys">Connected Envoys</a></li>
        <li><a href="#total-error-rate">Total Error Rate</a></li>
        <li><a href="#median-proxy-convergence-time">Median Proxy Convergence Time</a></li>
        <li><a href="#istiod-push-rate">Istiod Push Rate</a></li>
        <li><a href="#istiod-error-rate">Istiod Error Rate</a></li>
        <li><a href="#proxy-convergence-time">Proxy Convergence Time</a></li>
        <li><a href="#configuration-validation">Configuration Validation</a></li>
        <li><a href="#sidecar-injection">Sidecar Injection</a></li>
      </ul>
    </li>
    <li><a href="#mpc-operational-status">MPC Operational Status</a>
      <ul>
        <li><a href="#config-update-messages-every-5m">Config Update Messages every 5m</a></li>
        <li><a href="#config-updates-processed-every-5m">Config updates processed every 5m</a></li>
        <li><a href="#config-stream-connection-attempts-every-5m">Config stream connection attempts every 5m</a></li>
        <li><a href="#xcp-config-push-duration">XCP Config Push Duration</a></li>
        <li><a href="#tsb-to-mpc-sent-configs">TSB to MPC sent configs</a></li>
        <li><a href="#xcp-resource-conversion-rate">XCP Resource conversion rate</a></li>
        <li><a href="#mpc-to-xcp-pushed-configs">MPC to XCP pushed configs</a></li>
        <li><a href="#xcp-resource-conversion-error-rate">XCP Resource conversion error rate</a></li>
        <li><a href="#mcp-to-xcp-pushed-configs-error">MCP to XCP pushed configs error</a></li>
        <li><a href="#config-status-updates-every-5m">Config Status updates every 5m</a></li>
        <li><a href="#config-status-updates-processed-every-5m">Config Status updates processed every 5m</a></li>
        <li><a href="#config-status-stream-connection-attempts-every-5m">Config Status stream connection attempts every 5m</a></li>
        <li><a href="#cluster-update-messages-every-5m">Cluster Update Messages every 5m</a></li>
        <li><a href="#tsb-cluster-updates-processed-every-5m">TSB Cluster updates processed every 5m</a></li>
        <li><a href="#tsb-cluster-stream-connection-attempts-every-5m">TSB Cluster stream connection attempts every 5m</a></li>
        <li><a href="#cluster-status-update-from-xcp-every-5m">Cluster Status Update from XCP every 5m</a></li>
        <li><a href="#cluster-updates-from-xcp--processed-every-5m">Cluster updates from XCP  processed every 5m</a></li>
        <li><a href="#cluster-updates-from-xcp-stream-connection-attempts-every-5m">Cluster updates from XCP stream connection attempts every 5m</a></li>
        <li><a href="#xcp-cluster-status-updates-processed-every-5m">XCP cluster status updates processed every 5m</a></li>
        <li><a href="#cluster-status-updates-to-tsb-stream-connection-attempts-every-5m">Cluster status updates to TSB stream connection attempts every 5m</a></li>
      </ul>
    </li>
    <li><a href="#oap-operational-status">OAP Operational Status</a>
      <ul>
        <li><a href="#oap-request-rate">OAP Request Rate</a></li>
        <li><a href="#oap-request-latency">OAP Request Latency</a></li>
        <li><a href="#oap-aggregation-request-rate">OAP Aggregation Request Rate</a></li>
        <li><a href="#oap-aggregation-rows">OAP Aggregation Rows</a></li>
        <li><a href="#oap-mesh-analysis-latency">OAP Mesh Analysis Latency</a></li>
        <li><a href="#oap-zipkin-trace-rate">OAP Zipkin Trace Rate</a></li>
        <li><a href="#oap-zipkin-trace-latency">OAP Zipkin Trace Latency</a></li>
        <li><a href="#oap-zipkin-trace-error-rate">OAP Zipkin Trace Error Rate</a></li>
        <li><a href="#jvm-threads">JVM Threads</a></li>
        <li><a href="#jvm-memory">JVM Memory</a></li>
      </ul>
    </li>
    <li><a href="#tsb-operational-status">TSB Operational Status</a>
      <ul>
        <li><a href="#front-envoy-success-rate">Front Envoy Success Rate</a></li>
        <li><a href="#front-envoy-error-rate">Front Envoy Error Rate</a></li>
        <li><a href="#front-envoy-latency">Front Envoy Latency</a></li>
        <li><a href="#tsb-success-rate">TSB Success Rate</a></li>
        <li><a href="#tsb-error-rate">TSB Error Rate</a></li>
        <li><a href="#authentication-success-rate">Authentication Success Rate</a></li>
        <li><a href="#authentication-error-rate">Authentication Error Rate</a></li>
        <li><a href="#authentication-latency">Authentication Latency</a></li>
        <li><a href="#data-store-success-rate">Data Store Success Rate</a></li>
        <li><a href="#data-store-latency">Data Store Latency</a></li>
        <li><a href="#data-store-error-rate">Data Store Error Rate</a></li>
        <li><a href="#active-transactions">Active Transactions</a></li>
        <li><a href="#pdp-success-rate">PDP Success Rate</a></li>
        <li><a href="#pdp-error-rate">PDP Error Rate</a></li>
        <li><a href="#pdp-latency">PDP Latency</a></li>
        <li><a href="#pip-success-rate">PIP Success Rate</a></li>
        <li><a href="#pip-latency">PIP Latency</a></li>
        <li><a href="#pip-error-rate">PIP Error Rate</a></li>
        <li><a href="#active-pip-transactions">Active PIP Transactions</a></li>
      </ul>
    </li>
    <li><a href="#xcp-central-operational-status">XCP Central Operational Status</a>
      <ul>
        <li><a href="#heading"></a></li>
        <li><a href="#xcp-central-version">XCP Central Version</a></li>
        <li><a href="#time-since-last-cluster-state-received-from-the-edge-seconds">Time since last cluster state received from the edge (seconds)</a></li>
        <li><a href="#time-since-cluster-states-were-sent-to-the-mpc-and-edges-clients-seconds">Time since cluster states were sent to the MPC and Edges clients (seconds)</a></li>
        <li><a href="#time-since-config-resync--request-is-received-from-the-edge-seconds">Time since config resync  request is received from the edge (seconds)</a></li>
        <li><a href="#time-since-config-crs-sent-to--the-edge-seconds">Time since config CRs sent to  the edge (seconds)</a></li>
        <li><a href="#messages-received-by-central-from-edges-in-last-5-min">messages received by central from edges in last 5 min</a></li>
        <li><a href="#number-of-times-config-crs-sent-by-central-to-the-edges-in-last-5m">Number of times config CRs sent by central to the edges in last 5m</a></li>
        <li><a href="#config-propagation-latency-by-edge">Config Propagation Latency by Edge</a></li>
        <li><a href="#errors-in-config-push-requests-to-the-edges-in-last-5-minutes">Errors in config push REQUESTS to the edges in last 5 minutes</a></li>
        <li><a href="#config-pushto-the-edges-requests-enqueued-to-debouncer-in-last-5-min">config push(to the edges) requests enqueued to debouncer in last 5 min</a></li>
        <li><a href="#pending-configurations-orphan-configs">Pending configurations (orphan configs)</a></li>
        <li><a href="#number-of-connectionscluster-state-pushing-and-config-pushing">Number of connections(cluster state pushing and config pushing)</a></li>
        <li><a href="#validation-webhook-passed-count-in-last-5-min">validation webhook passed count in last 5 min</a></li>
        <li><a href="#rate-of-webhook-validation-errors">Rate of webhook validation errors</a></li>
        <li><a href="#all-goroutines">All goroutines</a></li>
        <li><a href="#central-specific-goroutines">Central specific goroutines</a></li>
        <li><a href="#central-memory-consumption">Central memory consumption</a></li>
        <li><a href="#edges-memory-consumption">Edges&rsquo; memory consumption</a></li>
        <li><a href="#central-cpu-consumption">Central CPU consumption</a></li>
        <li><a href="#all-edges-cpu-consumption">All edges&rsquo; CPU consumption</a></li>
      </ul>
    </li>
    <li><a href="#xcp-edge-status">XCP Edge status</a>
      <ul>
        <li><a href="#heading-1"></a></li>
        <li><a href="#xcp-edge-version">XCP Edge Version</a></li>
        <li><a href="#number-of-gatewayhost-exposed">Number of gatewayHost exposed</a></li>
        <li><a href="#active-connections-to-central">Active connections to central</a></li>
        <li><a href="#time-since-any-message-sent-to-central-on-config-stream-seconds">Time since any message sent to central on config stream (seconds)</a></li>
        <li><a href="#number-of-times-edge-updates-were-sent-to-central">Number of times edge updates were sent to Central</a></li>
        <li><a href="#number-of-times-cluster-states-received-by-edge-from-central-in-last-1-min">Number of times cluster states received by edge from central in last 1 min</a></li>
        <li><a href="#number-of-times-config-crs-received-by-edge-from-central-in-last-5-min">Number of times config CRs received by edge from central in last 5 min</a></li>
        <li><a href="#translation-count">Translation count</a></li>
        <li><a href="#number-of-times-config-status-sent-by-edge-to-central-in-last-5-min">Number of times config status sent by edge to central in last 5 min</a></li>
        <li><a href="#istio-config-reconcile-time-ms">Istio config reconcile time (ms)</a></li>
        <li><a href="#number-of-configs-createdupdated-by-edge-at-k8s-apiserver--every-5-minutes">Number of configs created/updated by edge at k8s apiserver  every 5 minutes</a></li>
        <li><a href="#number-of-configs-deleted-by-edge-from-k8s-apiserver--every-5-minutes">Number of configs deleted by edge from k8s apiserver  every 5 minutes</a></li>
        <li><a href="#latency-in-cluster-state-propagation-to-central-ms">latency in cluster-state propagation to central (ms)</a></li>
        <li><a href="#all-goroutines-1">All goroutines</a></li>
        <li><a href="#edge-specific-gorountines">Edge specific gorountines</a></li>
        <li><a href="#edge-cpu-consumption">Edge CPU consumption</a></li>
        <li><a href="#edge-memory-consumption">Edge memory consumption</a></li>
      </ul>
    </li>
  </ul>
</nav>

      
<div class="subscribe-module col-12 mt-1">
    <img src="/img/wechat.webp" alt="image" title="Jimmy Song的微信公众号"/>
    <p class="text-center pt-1">扫码联系站长</p>
    
    
     <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4029167986768912"
     crossorigin="anonymous"></script>
     <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-4029167986768912"
       data-ad-slot="6856371908"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
    <script>
       (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
    
    
</div>



    </div>
    

    <main class="py-md-3 pl-md-3 docs-content col-xl-8" role="main">

      <article class="article">

          

          <h1>Key Metrics</h1>

          <div class="article-style">
            <!-- This file is generated from our dashboards. DO NOT EDIT! -->
<p>Tetrate Service Bridge collects a large number of metrics. This page is generated from dashboards ran internally at Tetrate and will be updated periodically based on best practices learned from operational experiences in Tetrate and from user deployments. Each heading represents a different dashboard, and each sub-heading is a panel on this dashboard. For this reason, you may see metrics appear multiple times.</p>
<p>The metrics described in this document build up a series of Grafana dashboards that can be downloaded from <a href="../../assets/operations/tsb-dashboards.zip">here</a>, so you can import them into your Grafana setup.</p>
<h2 id="gitops-operational-status">GitOps Operational Status</h2>
<p>Operational metrics to indicate Cluster GitOps health</p>
<h3 id="gitops-status">GitOps Status</h3>
<p>Shows the status of the GitOps component for each cluster.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>gitops_enabled</code></td>
<td>N/A</td>
<td><pre class="language-text">gitops_enabled</pre></td>
</tr>
</tbody>
</table>
<h3 id="accepted-admission-requests">Accepted Admission Requests</h3>
<p>Accepted admission requests for each cluster. This is the rate at which operations are processed by the GitOps relay and sent to TSB.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>gitops_admission_count</code></td>
<td><code>allowed</code></td>
<td><pre class="language-text">sum(rate(gitops_admission_count{allowed=&ldquo;true&rdquo;}[1h])) by (cluster_name)</pre></td>
</tr>
</tbody>
</table>
<h3 id="rejected-admission-requests">Rejected Admission Requests</h3>
<p>Rejected admission requests for each cluster. This is the rate at which operations are processed by the GitOps relay and sent to TSB.</p>
<p>A spike in these metrics may indicate an increase in invalid TSB resources being applied to the Kubernetes clusters, or error in the admission webhook processing.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>gitops_admission_count</code></td>
<td><code>allowed</code></td>
<td><pre class="language-text">sum(rate(gitops_admission_count{allowed=&ldquo;false&rdquo;}[1h])) by (cluster_name)</pre></td>
</tr>
</tbody>
</table>
<h3 id="admission-review-latency">Admission Review Latency</h3>
<p>Admission review latency percentiles grouped by cluster.</p>
<p>The GitOps admission reviews make decisions by forwarding the objects to the Management Plane. This metric helps understand the time it takes to make such decisions.</p>
<p>A spike here may indicate network issues or connectivity issues between the Control Plane and the Management Plane.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>gitops_admission_duration_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.99, sum(rate(gitops_admission_duration_bucket[1h])) by (cluster_name, le))</pre></td>
</tr>
<tr>
<td><code>gitops_admission_duration_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.95, sum(rate(gitops_admission_duration_bucket[1h])) by (cluster_name, le))</pre></td>
</tr>
</tbody>
</table>
<h3 id="resources-pushed-to-tsb">Resources Pushed to TSB</h3>
<p>Number of resources pushed to the Management Plane.</p>
<p>This should be equivalent to the admission requests in most cases, but this will also account for object pushes that are done by the background reconcile processes.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>gitops_push_count</code></td>
<td><code>success</code></td>
<td><pre class="language-text">sum(rate(gitops_push_count{success=&ldquo;true&rdquo;}[1h])) by (cluster_name)</pre></td>
</tr>
</tbody>
</table>
<h3 id="failed-pushes-to-tsb">Failed pushes to TSB</h3>
<p>Number of resource pushes to the Management Plane that failed.</p>
<p>This should be equivalent to the failed admission requests in most cases, but this will also account for object pushes that are done by the background reconcile processes.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>gitops_push_count</code></td>
<td><code>success</code></td>
<td><pre class="language-text">sum(rate(gitops_push_count{success=&ldquo;false&rdquo;}[1h])) by (cluster_name)</pre></td>
</tr>
</tbody>
</table>
<h3 id="resources-conversions">Resources Conversions</h3>
<p>Number of Kubernetes resources that have been read from the cluster and successfully converted into TSB objects to be pushed to the Management plane.</p>
<p>The values for this metric should be the same as the Pushed Objects. If there is a difference between them, it probably means some issue when converting the Kubernetes objects to TSB objects.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>gitops_convert_count</code></td>
<td><code>success</code></td>
<td><pre class="language-text">sum(rate(gitops_convert_count{success=&ldquo;true&rdquo;}[1h])) by (cluster_name)</pre></td>
</tr>
</tbody>
</table>
<h3 id="resources-conversions-errors">Resources conversions errors</h3>
<p>Number of Kubernetes resources that have been read from the cluster and failed to be converted into TSB objects.</p>
<p>A spike on this metric indicates that the Kubernetes objects could not be converted to TSB objects and that those resources were not sent to the Management Plane.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>gitops_convert_count</code></td>
<td><code>success</code></td>
<td><pre class="language-text">sum(rate(gitops_convert_count{success=&ldquo;false&rdquo;}[1h])) by (cluster_name)</pre></td>
</tr>
</tbody>
</table>
<h2 id="global-configuration-distribution">Global Configuration Distribution</h2>
<p>These metrics indicate the overall health of Tetrate Service Bridge and should be considered the starting point for any investigation into issues with Tetrate Service Bridge.</p>
<h3 id="connected-clusters">Connected Clusters</h3>
<p>This details all clusters connected to and receiving configuration from the management plane.</p>
<p>If this number drops below 1 or a given cluster does not appear in this table it means that the cluster is disconnected. This may happen for a brief period of time during upgrades/re-deploys.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_central_current_edge_connections</code></td>
<td>N/A</td>
<td><pre class="language-text">xcp_central_current_edge_connections</pre></td>
</tr>
</tbody>
</table>
<h3 id="tsb-error-rate-humans">TSB Error Rate (Humans)</h3>
<p>Rate of failed requests to the TSB apiserver from the UI and CLI.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>grpc_server_handled_total</code></td>
<td><code>component</code> <code>grpc_code</code> <code>grpc_method</code> <code>grpc_type</code></td>
<td><pre class="language-text">sum(rate(grpc_server_handled_total{component=&ldquo;tsb&rdquo;, grpc_code!=&ldquo;OK&rdquo;, grpc_type=&ldquo;unary&rdquo;, grpc_method!=&ldquo;SendAuditLog&rdquo;}[1m])) by (grpc_code) OR on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="istio-envoy-sync-time-99th-percentile">Istio-Envoy Sync Time (99th Percentile)</h3>
<p>Once XCP has synced with the management plane it creates resources for Istio to configure Envoy. Istio usually distributes these within a second.</p>
<p>If this number starts to exceed 10 seconds then you may need to scale out istiod. In small clusters, it is possible this number is too small to be handled by the histogram buckets so may be nil.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pilot_proxy_convergence_time_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.99, sum(rate(pilot_proxy_convergence_time_bucket[1m])) by (le, cluster_name))</pre></td>
</tr>
</tbody>
</table>
<h3 id="xcp-central---edge-sync-time-99th-percentile">XCP central -&gt; edge Sync Time (99th Percentile)</h3>
<p>MPC component translates TSB configuration into XCP objects. XCP central then sends these objects to every Edge connected to it.</p>
<p>This is the time taken for XCP central to send the configs to edges in ms.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_central_config_propagation_time_ms_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.99, sum(rate(xcp_central_config_propagation_time_ms_bucket[1m])) by (le, edge))</pre></td>
</tr>
</tbody>
</table>
<h3 id="istiod-errors">Istiod Errors</h3>
<p>Rate of istiod errors broken down by cluster. This graph helps identify clusters that may be experiencing problems. Typically, there should be no errors. Any non-transient errors should be investigated.</p>
<p>Sometimes this graph will show &ldquo;No data&rdquo; or these metrics won&rsquo;t exist. This is because istiod only emits these metrics if the errors occur.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pilot_total_xds_internal_errors</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(rate(pilot_xds_write_timeout[1m])) by (cluster_name) + sum(rate(pilot_total_xds_internal_errors[1m])) by (cluster_name) + sum(rate(pilot_total_xds_rejects[1m])) by (cluster_name) + sum(rate(pilot_xds_expired_nonce[1m])) by (cluster_name) + sum(rate(pilot_xds_push_context_errors[1m])) by (cluster_name) + sum(rate(pilot_xds_pushes{type=~&quot;.*_senderr&quot;}[1m])) by (cluster_name) OR on() vector(0)</pre></td>
</tr>
<tr>
<td><code>pilot_total_xds_rejects</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(rate(pilot_xds_write_timeout[1m])) by (cluster_name) + sum(rate(pilot_total_xds_internal_errors[1m])) by (cluster_name) + sum(rate(pilot_total_xds_rejects[1m])) by (cluster_name) + sum(rate(pilot_xds_expired_nonce[1m])) by (cluster_name) + sum(rate(pilot_xds_push_context_errors[1m])) by (cluster_name) + sum(rate(pilot_xds_pushes{type=~&quot;.*_senderr&quot;}[1m])) by (cluster_name) OR on() vector(0)</pre></td>
</tr>
<tr>
<td><code>pilot_xds_expired_nonce</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(rate(pilot_xds_write_timeout[1m])) by (cluster_name) + sum(rate(pilot_total_xds_internal_errors[1m])) by (cluster_name) + sum(rate(pilot_total_xds_rejects[1m])) by (cluster_name) + sum(rate(pilot_xds_expired_nonce[1m])) by (cluster_name) + sum(rate(pilot_xds_push_context_errors[1m])) by (cluster_name) + sum(rate(pilot_xds_pushes{type=~&quot;.*_senderr&quot;}[1m])) by (cluster_name) OR on() vector(0)</pre></td>
</tr>
<tr>
<td><code>pilot_xds_push_context_errors</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(rate(pilot_xds_write_timeout[1m])) by (cluster_name) + sum(rate(pilot_total_xds_internal_errors[1m])) by (cluster_name) + sum(rate(pilot_total_xds_rejects[1m])) by (cluster_name) + sum(rate(pilot_xds_expired_nonce[1m])) by (cluster_name) + sum(rate(pilot_xds_push_context_errors[1m])) by (cluster_name) + sum(rate(pilot_xds_pushes{type=~&quot;.*_senderr&quot;}[1m])) by (cluster_name) OR on() vector(0)</pre></td>
</tr>
<tr>
<td><code>pilot_xds_pushes</code></td>
<td><code>type</code></td>
<td><pre class="language-text">sum(rate(pilot_xds_write_timeout[1m])) by (cluster_name) + sum(rate(pilot_total_xds_internal_errors[1m])) by (cluster_name) + sum(rate(pilot_total_xds_rejects[1m])) by (cluster_name) + sum(rate(pilot_xds_expired_nonce[1m])) by (cluster_name) + sum(rate(pilot_xds_push_context_errors[1m])) by (cluster_name) + sum(rate(pilot_xds_pushes{type=~&quot;.*_senderr&quot;}[1m])) by (cluster_name) OR on() vector(0)</pre></td>
</tr>
<tr>
<td><code>pilot_xds_write_timeout</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(rate(pilot_xds_write_timeout[1m])) by (cluster_name) + sum(rate(pilot_total_xds_internal_errors[1m])) by (cluster_name) + sum(rate(pilot_total_xds_rejects[1m])) by (cluster_name) + sum(rate(pilot_xds_expired_nonce[1m])) by (cluster_name) + sum(rate(pilot_xds_push_context_errors[1m])) by (cluster_name) + sum(rate(pilot_xds_pushes{type=~&quot;.*_senderr&quot;}[1m])) by (cluster_name) OR on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h2 id="istio-operational-status">Istio Operational Status</h2>
<p>Operational metrics for istiod health.</p>
<h3 id="connected-envoys">Connected Envoys</h3>
<p>Count of Envoys connected to istiod. This should represent the total number of endpoints in the selected cluster.</p>
<p>If this number significantly decreases for longer than 5 minutes without an obvious reason (e.g. a scale-down event) then you should investigate. This may indicate that Envoys have been disconnected from istiod and are unable to reconnect.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pilot_xds</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">sum(pilot_xds{cluster_name=&quot;$cluster&quot;})</pre></td>
</tr>
</tbody>
</table>
<h3 id="total-error-rate">Total Error Rate</h3>
<p>The total error rate for Istio when configuring Envoy, including generation and transport errors.</p>
<p>Any errors (current and historic) should be investigated using the more detailed split below.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pilot_total_xds_internal_errors</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">sum(rate(pilot_xds_write_timeout{cluster_name=&quot;$cluster&quot;}[1m])) + sum(rate(pilot_total_xds_internal_errors{cluster_name=&quot;$cluster&quot;}[1m])) + sum(rate(pilot_total_xds_rejects{cluster_name=&quot;$cluster&quot;}[1m])) + sum(rate(pilot_xds_expired_nonce{cluster_name=&quot;$cluster&quot;}[1m])) +   sum(rate(pilot_xds_push_context_errors{cluster_name=&quot;$cluster&quot;}[1m])) +   sum(rate(pilot_xds_pushes{cluster_name=&quot;$cluster&quot;, type=~&quot;.*_senderr&quot;}[1m])) OR on() vector(0)</pre></td>
</tr>
<tr>
<td><code>pilot_total_xds_rejects</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">sum(rate(pilot_xds_write_timeout{cluster_name=&quot;$cluster&quot;}[1m])) + sum(rate(pilot_total_xds_internal_errors{cluster_name=&quot;$cluster&quot;}[1m])) + sum(rate(pilot_total_xds_rejects{cluster_name=&quot;$cluster&quot;}[1m])) + sum(rate(pilot_xds_expired_nonce{cluster_name=&quot;$cluster&quot;}[1m])) +   sum(rate(pilot_xds_push_context_errors{cluster_name=&quot;$cluster&quot;}[1m])) +   sum(rate(pilot_xds_pushes{cluster_name=&quot;$cluster&quot;, type=~&quot;.*_senderr&quot;}[1m])) OR on() vector(0)</pre></td>
</tr>
<tr>
<td><code>pilot_xds_expired_nonce</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">sum(rate(pilot_xds_write_timeout{cluster_name=&quot;$cluster&quot;}[1m])) + sum(rate(pilot_total_xds_internal_errors{cluster_name=&quot;$cluster&quot;}[1m])) + sum(rate(pilot_total_xds_rejects{cluster_name=&quot;$cluster&quot;}[1m])) + sum(rate(pilot_xds_expired_nonce{cluster_name=&quot;$cluster&quot;}[1m])) +   sum(rate(pilot_xds_push_context_errors{cluster_name=&quot;$cluster&quot;}[1m])) +   sum(rate(pilot_xds_pushes{cluster_name=&quot;$cluster&quot;, type=~&quot;.*_senderr&quot;}[1m])) OR on() vector(0)</pre></td>
</tr>
<tr>
<td><code>pilot_xds_push_context_errors</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">sum(rate(pilot_xds_write_timeout{cluster_name=&quot;$cluster&quot;}[1m])) + sum(rate(pilot_total_xds_internal_errors{cluster_name=&quot;$cluster&quot;}[1m])) + sum(rate(pilot_total_xds_rejects{cluster_name=&quot;$cluster&quot;}[1m])) + sum(rate(pilot_xds_expired_nonce{cluster_name=&quot;$cluster&quot;}[1m])) +   sum(rate(pilot_xds_push_context_errors{cluster_name=&quot;$cluster&quot;}[1m])) +   sum(rate(pilot_xds_pushes{cluster_name=&quot;$cluster&quot;, type=~&quot;.*_senderr&quot;}[1m])) OR on() vector(0)</pre></td>
</tr>
<tr>
<td><code>pilot_xds_pushes</code></td>
<td><code>cluster_name</code> <code>type</code></td>
<td><pre class="language-text">sum(rate(pilot_xds_write_timeout{cluster_name=&quot;$cluster&quot;}[1m])) + sum(rate(pilot_total_xds_internal_errors{cluster_name=&quot;$cluster&quot;}[1m])) + sum(rate(pilot_total_xds_rejects{cluster_name=&quot;$cluster&quot;}[1m])) + sum(rate(pilot_xds_expired_nonce{cluster_name=&quot;$cluster&quot;}[1m])) +   sum(rate(pilot_xds_push_context_errors{cluster_name=&quot;$cluster&quot;}[1m])) +   sum(rate(pilot_xds_pushes{cluster_name=&quot;$cluster&quot;, type=~&quot;.*_senderr&quot;}[1m])) OR on() vector(0)</pre></td>
</tr>
<tr>
<td><code>pilot_xds_write_timeout</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">sum(rate(pilot_xds_write_timeout{cluster_name=&quot;$cluster&quot;}[1m])) + sum(rate(pilot_total_xds_internal_errors{cluster_name=&quot;$cluster&quot;}[1m])) + sum(rate(pilot_total_xds_rejects{cluster_name=&quot;$cluster&quot;}[1m])) + sum(rate(pilot_xds_expired_nonce{cluster_name=&quot;$cluster&quot;}[1m])) +   sum(rate(pilot_xds_push_context_errors{cluster_name=&quot;$cluster&quot;}[1m])) +   sum(rate(pilot_xds_pushes{cluster_name=&quot;$cluster&quot;, type=~&quot;.*_senderr&quot;}[1m])) OR on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="median-proxy-convergence-time">Median Proxy Convergence Time</h3>
<p>The median (50th percentile) delay between istiod receiving configuration changes and the proxy receiving all required configuration in the selected cluster. This number indicates how stale the proxy configuration is. As this number increases, it may start to impact application traffic.</p>
<p>This number is typically in the hundreds of milliseconds. In small clusters, this number may be zero.</p>
<p>If this number creeps up to 30s for an extended period, istiod likely needs to be scaled out (or up).</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pilot_proxy_convergence_time_bucket</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">histogram_quantile(0.5, sum(rate(pilot_proxy_convergence_time_bucket{cluster_name=&quot;$cluster&quot;}[1m])) by (le))</pre></td>
</tr>
</tbody>
</table>
<h3 id="istiod-push-rate">Istiod Push Rate</h3>
<p>The rate of istiod pushes to Envoy grouped by discovery service. Istiod pushes clusters (CDS), endpoints (EDS), listeners (LDS) or routes (RDS) any time it receives a configuration change.</p>
<p>Changes are triggered by a user interacting with TSB or a change in infrastructure such as a new endpoint (service instance/pod) creation.</p>
<p>In small relatively static clusters these values can be zero most of the time.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pilot_xds_pushes</code></td>
<td><code>cluster_name</code> <code>type</code></td>
<td><pre class="language-text">sum(irate(pilot_xds_pushes{cluster_name=&quot;$cluster&quot;, type=~&ldquo;cds|eds|rds|lds&rdquo;}[1m])) by (type)</pre></td>
</tr>
</tbody>
</table>
<h3 id="istiod-error-rate">Istiod Error Rate</h3>
<p>The different error rates for Istio during general operations. Including the generation and distribution of Envoy configuration.</p>
<p><code>pilot_xds_write_timeout</code>
Rate of connection timeouts between Envoy and istiod. This number indicates that an Envoy has taken too long to acknowledge a configuration change from Istio. An increase in these errors typically indicates network issues, envoy resource limits or istiod resource limits (usually cpu)</p>
<p><code>pilot_total_xds_internal_errors</code>
Rate of errors thrown inside istiod whilst generating Envoy configuration. Check the istiod logs for more details if you see internal errors.</p>
<p><code>pilot_total_xds_rejects</code>
Rate of rejected configuration from Envoy. Istio should never produce any invalid Envoy configuration so any errors here warrants investigation, starting with the istiod logs.</p>
<p><code>pilot_xds_expired_nonce</code>
Rate of expired nonces from Envoys. This number indicates that an Envoy has responded to the wrong request sent from Istio. An increase in these errors typically indicates network issues (saturation or partition), Envoy resource limits or istiod resource limits (usually cpu).</p>
<p><code>pilot_xds_push_context_errors</code>
Rate of errors setting a connection with an Envoy instance. An increase in these errors typically indicates network issues (saturation or partition), Envoy resource limits or istiod resource limits (usually cpu). Check istiod logs for further details.</p>
<p><code>pilot_xds_pushes</code>
Rate of transport errors sending configuration to Envoy.  An increase in these errors typically indicates network issues (saturation or partition), Envoy resource limits or istiod resource limits (usually cpu).</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pilot_total_xds_internal_errors</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">sum(rate(pilot_total_xds_internal_errors{cluster_name=&quot;$cluster&quot;}[1m]))</pre></td>
</tr>
<tr>
<td><code>pilot_total_xds_rejects</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">sum(rate(pilot_total_xds_rejects{cluster_name=&quot;$cluster&quot;}[1m]))</pre></td>
</tr>
<tr>
<td><code>pilot_xds_expired_nonce</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">sum(rate(pilot_xds_expired_nonce{cluster_name=&quot;$cluster&quot;}[1m]))</pre></td>
</tr>
<tr>
<td><code>pilot_xds_push_context_errors</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">sum(rate(pilot_xds_push_context_errors{cluster_name=&quot;$cluster&quot;}[1m]))</pre></td>
</tr>
<tr>
<td><code>pilot_xds_pushes</code></td>
<td><code>cluster_name</code> <code>type</code></td>
<td><pre class="language-text">sum(rate(pilot_xds_pushes{cluster_name=&quot;$cluster&quot;, type=~&quot;.*_senderr&quot;}[1m])) by (type)</pre></td>
</tr>
<tr>
<td><code>pilot_xds_write_timeout</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">sum(rate(pilot_xds_write_timeout{cluster_name=&quot;$cluster&quot;}[1m]))</pre></td>
</tr>
</tbody>
</table>
<h3 id="proxy-convergence-time">Proxy Convergence Time</h3>
<p>The delay between an istiod receiving configuration changes and a proxy receiving all required configuration in the cluster. Broken down by percentiles.</p>
<p>This number indicates how stale the proxy configuration is. As this number increases it may start to affect application traffic.</p>
<p>This number is typically in the hundreds of milliseconds. If this number creeps up to 30s for an extended period of time, it is likely that istiod needs to be scaled out (or up) as it is likely pinned up against its CPU limits.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pilot_proxy_convergence_time_bucket</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">histogram_quantile(0.5, sum(rate(pilot_proxy_convergence_time_bucket{cluster_name=&quot;$cluster&quot;}[1m])) by (le))</pre></td>
</tr>
<tr>
<td><code>pilot_proxy_convergence_time_bucket</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">histogram_quantile(0.90, sum(rate(pilot_proxy_convergence_time_bucket{cluster_name=&quot;$cluster&quot;}[1m])) by (le))</pre></td>
</tr>
<tr>
<td><code>pilot_proxy_convergence_time_bucket</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">histogram_quantile(0.99, sum(rate(pilot_proxy_convergence_time_bucket{cluster_name=&quot;$cluster&quot;}[1m])) by (le))</pre></td>
</tr>
<tr>
<td><code>pilot_proxy_convergence_time_bucket</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">histogram_quantile(0.999, sum(rate(pilot_proxy_convergence_time_bucket{cluster_name=&quot;$cluster&quot;}[1m])) by (le))</pre></td>
</tr>
</tbody>
</table>
<h3 id="configuration-validation">Configuration Validation</h3>
<p>Success and failure rate of <code>istio</code> configuration validation requests. This is triggered when TSB configuration is created or updated.</p>
<p>Any failures here should be investigated in the istiod and <code>edge</code> logs.</p>
<p>If there are TSB configuration changes being made that affect the selected cluster and the success number is zero then there is an issue with configuration propagation. Check the XCP <code>edge</code> logs to debug further.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>galley_validation_failed</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">sum(rate(galley_validation_failed{cluster_name=&quot;$cluster&quot;}[1m]))</pre></td>
</tr>
<tr>
<td><code>galley_validation_passed</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">sum(rate(galley_validation_passed{cluster_name=&quot;$cluster&quot;}[1m]))</pre></td>
</tr>
</tbody>
</table>
<h3 id="sidecar-injection">Sidecar Injection</h3>
<p>Rate of sidecar injection requests. Sidecar injection is triggered whenever a new instance/pod is created.</p>
<p>Any errors displayed here should be investigated further by checking the istiod logs.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sidecar_injection_failure_total</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">sum(rate(sidecar_injection_failure_total{cluster_name=&quot;$cluster&quot;}[1m]))</pre></td>
</tr>
<tr>
<td><code>sidecar_injection_success_total</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">sum(rate(sidecar_injection_success_total{cluster_name=&quot;$cluster&quot;}[1m]))</pre></td>
</tr>
</tbody>
</table>
<h2 id="mpc-operational-status">MPC Operational Status</h2>
<p>Operational metrics to indicate Management Plane Controller (MPC) health.</p>
<h3 id="config-update-messages-every-5m">Config Update Messages every 5m</h3>
<p>Config update messages sent over the gRPC stream from TSB and received by MPC.</p>
<p>This metric can help understand how messages are queued in MPC when it is under load. The value for both metrics should always be the same. If the Received by MPC metric has a value lower than the TSB one, it means MPC is under load and cannot process all messages sent by TSB as fast as TSB is sending them.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>grpc_client_msg_received_total</code></td>
<td><code>component</code> <code>grpc_method</code></td>
<td><pre class="language-text">sum(increase(grpc_client_msg_received_total{component=&ldquo;mpc&rdquo;, grpc_method=&ldquo;GetAllConfigObjects&rdquo;}[5m])) or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>grpc_server_msg_sent_total</code></td>
<td><code>component</code> <code>grpc_method</code></td>
<td><pre class="language-text">sum(increase(grpc_server_msg_sent_total{component=&ldquo;tsb&rdquo;, grpc_method=&ldquo;GetAllConfigObjects&rdquo;}[5m])) or on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="config-updates-processed-every-5m">Config updates processed every 5m</h3>
<p>The number of configuration updates received by the Management Plane Controller (MPC) is to be processed and sent to XCP.</p>
<p>TSB sends the config updates over a permanently connected gRPC stream to MPC, and this metric shows the number of messages received and processed by MPC on that stream.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>permanent_stream_operation</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_operation{name=&ldquo;ConfigUpdates&rdquo;, error=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>permanent_stream_operation</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_operation{name=&ldquo;ConfigUpdates&rdquo;, error!=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="config-stream-connection-attempts-every-5m">Config stream connection attempts every 5m</h3>
<p>The number of connection (and reconnection) attempts on the config updates stream.</p>
<p>TSB sends the config updates over a permanently connected gRPC stream to MPC. This metric shows the number of connections and reconnections that happened on that stream.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>permanent_stream_connection_attempts</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_connection_attempts{name=&ldquo;ConfigUpdates&rdquo;, error=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>permanent_stream_connection_attempts</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_connection_attempts{name=&ldquo;ConfigUpdates&rdquo;, error!=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="xcp-config-push-duration">XCP Config Push Duration</h3>
<p>Time it took for configuration objects to be pushed to XCP.</p>
<p>This metric shows the time it takes for MPC to apply all the configuration objects in the XCP namespace once all the configuration objects have been received from TSB and translated into XCP objects.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mpc_xcp_config_push_time</code></td>
<td><code>error</code></td>
<td><pre class="language-text">mpc_xcp_config_push_time{error=&quot;&quot;} or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>mpc_xcp_config_push_time</code></td>
<td><code>error</code></td>
<td><pre class="language-text">mpc_xcp_config_push_time{error!=&quot;&quot;} or on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="tsb-to-mpc-sent-configs">TSB to MPC sent configs</h3>
<p>The number of resources that sent from TSB to MPC.</p>
<p>This metric shows the number of objects that are created, updated, and deleted as part of a configuration push from MPC to XCP.</p>
<p>This metric can be used together with the XCP push operations and push duration to get an understanding of how the amount of resources being pushed to XCP affects the time it takes for the entire configuration push operation to complete.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mpc_tsb_config_received_count</code></td>
<td>N/A</td>
<td><pre class="language-text">mpc_tsb_config_received_count</pre></td>
</tr>
</tbody>
</table>
<h3 id="xcp-resource-conversion-rate">XCP Resource conversion rate</h3>
<p>Configuration updates received from TSB are processed by MPC and translated into XCP resources. This metric shows the conversion rate of TSB resources to XCP resources.
It gives a good idea of the number of resources of each type in the runtime configuration.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mpc_xcp_conversion_count</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(rate(mpc_xcp_conversion_count[1m])) by (resource)</pre></td>
</tr>
</tbody>
</table>
<h3 id="mpc-to-xcp-pushed-configs">MPC to XCP pushed configs</h3>
<p>The number of resources that are pushed to XCP.</p>
<p>This metric shows the number of objects that are created, updated, and deleted as part of a configuration push from MPC to XCP.
It also shows how many fetch calls to the k8s api server are done.</p>
<p>This metric can be used together with the TSB tp MPC sent configs and XCP push operations and push duration to get an understanding of how the amount of resources being pushed to XCP affects the time it takes for the entire configuration push operation to complete.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mpc_xcp_config_create_ops</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(mpc_xcp_config_create_ops)</pre></td>
</tr>
<tr>
<td><code>mpc_xcp_config_delete_ops</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(mpc_xcp_config_delete_ops)</pre></td>
</tr>
<tr>
<td><code>mpc_xcp_config_fetch_ops</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(mpc_xcp_config_fetch_ops)</pre></td>
</tr>
<tr>
<td><code>mpc_xcp_config_update_ops</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(mpc_xcp_config_update_ops)</pre></td>
</tr>
</tbody>
</table>
<h3 id="xcp-resource-conversion-error-rate">XCP Resource conversion error rate</h3>
<p>Configuration updates received from TSB are processed by MPC and translated into XCP resources. This metric shows the conversion error rate of TSB resources to XCP resources.
It should always be zero. If there are errors reported in this graph, there are incompatibilities between the XCP resources and the TSB ones. This may be the result of mismatching version compatibility between TSB and XCP.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mpc_xcp_conversion_count</code></td>
<td><code>error</code></td>
<td><pre class="language-text">sum(rate(mpc_xcp_conversion_count{error != &ldquo;&rdquo;}[5m])) by (resource) or on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="mcp-to-xcp-pushed-configs-error">MCP to XCP pushed configs error</h3>
<p>The number of resources that failed while pushing to XCP.</p>
<p>This metric shows the number of objects that fail when they are tried to be created, updated, and deleted as part of a configuration push from MPC to XCP.
It also shows the number of failed fetch calls to the k8s api server.</p>
<p>This metric can be used together with the MPC to TSB push configs and the XCP push operations and push duration to get an understanding of how the amount of resources being pushed to XCP affects the time it takes for the entire configuration push operation to complete.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mpc_xcp_config_create_ops_err</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(mpc_xcp_config_create_ops_err)</pre></td>
</tr>
<tr>
<td><code>mpc_xcp_config_delete_ops_err</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(mpc_xcp_config_delete_ops_err)</pre></td>
</tr>
<tr>
<td><code>mpc_xcp_config_fetch_ops_err</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(mpc_xcp_config_fetch_ops_err)</pre></td>
</tr>
<tr>
<td><code>mpc_xcp_config_update_ops_err</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(mpc_xcp_config_update_ops_err)</pre></td>
</tr>
</tbody>
</table>
<h3 id="config-status-updates-every-5m">Config Status updates every 5m</h3>
<p>Config Status update messages sent over the gRPC streams, from XCP to MPC to XCP.</p>
<p>This metric can help understand how messages are queued in TSB when it is under load. The value for both metrics should always be the same. If the Received by TSB metric has a value lower than the MPC one, it means TSB is under load and cannot process all messages sent by MPC as fast as MPC is sending them.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>grpc_client_msg_received_total</code></td>
<td><code>component</code> <code>grpc_method</code></td>
<td><pre class="language-text">sum(increase(grpc_client_msg_received_total{grpc_method=&ldquo;PullStatus&rdquo;,component=&ldquo;mpc&rdquo;}[5m])) or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>grpc_client_msg_sent_total</code></td>
<td><code>component</code> <code>grpc_method</code></td>
<td><pre class="language-text">sum(increase(grpc_client_msg_sent_total{grpc_method=&ldquo;PullStatus&rdquo;,component=&ldquo;mpc&rdquo;}[5m])) or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>grpc_client_msg_sent_total</code></td>
<td><code>component</code> <code>grpc_method</code></td>
<td><pre class="language-text">sum(increase(grpc_client_msg_sent_total{grpc_method=&ldquo;PushStatus&rdquo;,component=&ldquo;mpc&rdquo;}[5m])) or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>grpc_server_msg_received_total</code></td>
<td><code>component</code> <code>grpc_method</code></td>
<td><pre class="language-text">sum(increase(grpc_server_msg_received_total{grpc_method=&ldquo;PushStatus&rdquo;, component=&ldquo;tsb&rdquo;}[5m])) or on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="config-status-updates-processed-every-5m">Config Status updates processed every 5m</h3>
<p>This is the number of config status updates that are processed by the Management Plane Controller (MPC), that are received from XCP and to be sent to TSB.</p>
<p>There are two gRPC streams, one that connects XCP to MPC and another one that connects MPC to TSB.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>permanent_stream_operation</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_operation{name=&ldquo;StatusPush&rdquo;, error=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>permanent_stream_operation</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_operation{name=&ldquo;StatusPush&rdquo;, error!=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>permanent_stream_operation</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_operation{name=&ldquo;StatusPull&rdquo;, error=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>permanent_stream_operation</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_operation{name=&ldquo;StatusPull&rdquo;, error!=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="config-status-stream-connection-attempts-every-5m">Config Status stream connection attempts every 5m</h3>
<p>The number of connection (and reconnection) attempts on the config status updates streams.
MPC sends the config status updates over a permanently connected gRPC stream to TSB. At the same time, XCP sends them to MPC. This metric shows the number of connections and reconnections that happened on each stream.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>permanent_stream_connection_attempts</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_connection_attempts{name=&ldquo;StatusPull&rdquo;, error=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>permanent_stream_connection_attempts</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_connection_attempts{name=&ldquo;StatusPull&rdquo;, error!=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>permanent_stream_connection_attempts</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_connection_attempts{name=&ldquo;StatusPush&rdquo;, error=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>permanent_stream_connection_attempts</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_connection_attempts{name=&ldquo;StatusPush&rdquo;, error!=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="cluster-update-messages-every-5m">Cluster Update Messages every 5m</h3>
<p>Cluster update messages sent over the gRPC stream from TSB and received by MPC.</p>
<p>This metric can help understand how messages are queued in MPC when it is under load. The value for both metrics should always be the same. If the Received by MPC metric has a value lower than the TSB one, it means MPC is under load and cannot process all messages sent by TSB as fast as TSB is sending them.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>grpc_client_msg_received_total</code></td>
<td><code>component</code> <code>grpc_method</code></td>
<td><pre class="language-text">sum(increase(grpc_client_msg_received_total{component=&ldquo;mpc&rdquo;, grpc_method=&ldquo;GetAllClusters&rdquo;}[5m])) or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>grpc_server_msg_sent_total</code></td>
<td><code>component</code> <code>grpc_method</code></td>
<td><pre class="language-text">sum(increase(grpc_server_msg_sent_total{component=&ldquo;tsb&rdquo;, grpc_method=&ldquo;GetAllClusters&rdquo;}[5m])) or on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="tsb-cluster-updates-processed-every-5m">TSB Cluster updates processed every 5m</h3>
<p>The number of cluster updates received by the Management Plane Controller (MPC) that must be processed and sent to XCP.</p>
<p>TSB sends the cluster updates (e.g. new onboarded clusters, deleted clusters) over a permanently connected gRPC stream to MPC. This metric shows the number of messages received and processed by MPC on that stream.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>permanent_stream_operation</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_operation{name=&ldquo;ClusterPush&rdquo;, error=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>permanent_stream_operation</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_operation{name=&ldquo;ClusterPush&rdquo;, error!=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="tsb-cluster-stream-connection-attempts-every-5m">TSB Cluster stream connection attempts every 5m</h3>
<p>The number of connection (and reconnection) attempts on the cluster updates stream.
TSB sends the cluster updates over a permanently connected gRPC stream to MPC. This metric shows the number of connections and reconnections that happened on that stream.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>permanent_stream_connection_attempts</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_connection_attempts{name=&ldquo;ClusterPush&rdquo;, error=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>permanent_stream_connection_attempts</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_connection_attempts{name=&ldquo;ClusterPush&rdquo;, error!=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="cluster-status-update-from-xcp-every-5m">Cluster Status Update from XCP every 5m</h3>
<p>Cluster status update messages received from XCP over a gRPC stream.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>grpc_client_msg_received_total</code></td>
<td><code>component</code> <code>grpc_method</code></td>
<td><pre class="language-text">sum(increase(grpc_client_msg_received_total{component=&ldquo;mpc&rdquo;, grpc_method=&ldquo;GetClusterState&rdquo;}[5m])) or on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="cluster-updates-from-xcp--processed-every-5m">Cluster updates from XCP  processed every 5m</h3>
<p>The number of cluster status updates received by the Management Plane Controller (MPC) from XCP that must be processed and sent to TSB.</p>
<p>XCP sends the cluster status updates (e.g. services deployed in the cluster) over a permanently connected gRPC stream to MPC. This metric shows the number of messages received and processed by MPC on that stream.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>permanent_stream_operation</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_operation{name=&ldquo;ClusterStateFromXCP&rdquo;, error=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>permanent_stream_operation</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_operation{name=&ldquo;ClusterStateFromXCP&rdquo;, error!=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="cluster-updates-from-xcp-stream-connection-attempts-every-5m">Cluster updates from XCP stream connection attempts every 5m</h3>
<p>The number of connection (and reconnection) attempts on the cluster status updates from XCP stream.
XCP sends the cluster status updates over a permanently connected gRPC stream to MPC. This metric shows the number of connections and reconnections that happened on that stream.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>permanent_stream_connection_attempts</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_connection_attempts{name=&ldquo;ClusterStateFromXCP&rdquo;, error=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>permanent_stream_connection_attempts</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_connection_attempts{name=&ldquo;ClusterStateFromXCP&rdquo;, error!=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="xcp-cluster-status-updates-processed-every-5m">XCP cluster status updates processed every 5m</h3>
<p>This is the number of cluster status updates that are processed by the Management Plane Controller (MPC) to be sent to TSB.</p>
<p>MPC sends the cluster status updates over a gRPC stream that is permanently connected to TSB, and this metric shows the number of cluster updates that are processed by MPC and sent to TSB on that stream.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>permanent_stream_operation</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_operation{name=&ldquo;ClusterUpdates&rdquo;, error=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>permanent_stream_operation</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_operation{name=&ldquo;ClusterUpdates&rdquo;, error!=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="cluster-status-updates-to-tsb-stream-connection-attempts-every-5m">Cluster status updates to TSB stream connection attempts every 5m</h3>
<p>The number of connection (and reconnection) attempts on the cluster status updates stream.
MPC sends the cluster status updates over a permanently connected gRPC stream to TSB. This metric shows the number of connections and reconnections that happened on that stream.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>permanent_stream_connection_attempts</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_connection_attempts{name=&ldquo;ClusterUpdates&rdquo;, error=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
<tr>
<td><code>permanent_stream_connection_attempts</code></td>
<td><code>error</code> <code>name</code></td>
<td><pre class="language-text">sum(increase(permanent_stream_connection_attempts{name=&ldquo;ClusterUpdates&rdquo;, error!=&quot;&quot;}[5m])) or on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h2 id="oap-operational-status">OAP Operational Status</h2>
<p>Operational metrics to indicate Tetrate Service Bridge OAP stack health.</p>
<h3 id="oap-request-rate">OAP Request Rate</h3>
<p>The request rate to OAP, by status.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>envoy_cluster_upstream_rq_xx</code></td>
<td><code>envoy_cluster_name</code> <code>plane</code></td>
<td><pre class="language-text">sum by (envoy_response_code_class) (rate(envoy_cluster_upstream_rq_xx{envoy_cluster_name=&ldquo;oap-grpc&rdquo;, plane=&ldquo;management&rdquo;}[1m]))</pre></td>
</tr>
</tbody>
</table>
<h3 id="oap-request-latency">OAP Request Latency</h3>
<p>The OAP, request latency.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>envoy_cluster_upstream_rq_time_bucket</code></td>
<td><code>envoy_cluster_name</code> <code>plane</code></td>
<td><pre class="language-text">histogram_quantile(0.99, sum(rate(envoy_cluster_upstream_rq_time_bucket{envoy_cluster_name=&ldquo;oap-grpc&rdquo;, plane=&ldquo;management&rdquo;}[1m])) by (le))</pre></td>
</tr>
<tr>
<td><code>envoy_cluster_upstream_rq_time_bucket</code></td>
<td><code>envoy_cluster_name</code> <code>plane</code></td>
<td><pre class="language-text">histogram_quantile(0.95, sum(rate(envoy_cluster_upstream_rq_time_bucket{envoy_cluster_name=&ldquo;oap-grpc&rdquo;, plane=&ldquo;management&rdquo;}[1m])) by (le))</pre></td>
</tr>
<tr>
<td><code>envoy_cluster_upstream_rq_time_bucket</code></td>
<td><code>envoy_cluster_name</code> <code>plane</code></td>
<td><pre class="language-text">histogram_quantile(0.90, sum(rate(envoy_cluster_upstream_rq_time_bucket{envoy_cluster_name=&ldquo;oap-grpc&rdquo;, plane=&ldquo;management&rdquo;}[1m])) by (le))</pre></td>
</tr>
<tr>
<td><code>envoy_cluster_upstream_rq_time_bucket</code></td>
<td><code>envoy_cluster_name</code> <code>plane</code></td>
<td><pre class="language-text">histogram_quantile(0.75, sum(rate(envoy_cluster_upstream_rq_time_bucket{envoy_cluster_name=&ldquo;oap-grpc&rdquo;, plane=&ldquo;management&rdquo;}[1m])) by (le))</pre></td>
</tr>
<tr>
<td><code>envoy_cluster_upstream_rq_time_bucket</code></td>
<td><code>envoy_cluster_name</code> <code>plane</code></td>
<td><pre class="language-text">histogram_quantile(0.50, sum(rate(envoy_cluster_upstream_rq_time_bucket{envoy_cluster_name=&ldquo;oap-grpc&rdquo;, plane=&ldquo;management&rdquo;}[1m])) by (le))</pre></td>
</tr>
</tbody>
</table>
<h3 id="oap-aggregation-request-rate">OAP Aggregation Request Rate</h3>
<p>OAP Aggregation Request Rate, by type:</p>
<ul>
<li>central aggregation service handler received</li>
<li>central application aggregation received</li>
<li>central service aggregation received</li>
</ul>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>central_aggregation_handler</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(rate(central_aggregation_handler[1m]))</pre></td>
</tr>
<tr>
<td><code>central_app_aggregation</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(rate(central_app_aggregation[1m]))</pre></td>
</tr>
<tr>
<td><code>central_service_aggregation</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(rate(central_service_aggregation[1m]))</pre></td>
</tr>
</tbody>
</table>
<h3 id="oap-aggregation-rows">OAP Aggregation Rows</h3>
<p>Cumulative rate of rows in OAP aggreagation.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>metrics_aggregation</code></td>
<td><code>plane</code></td>
<td><pre class="language-text">sum(rate(metrics_aggregation{plane=&ldquo;management&rdquo;}[1m]))</pre></td>
</tr>
</tbody>
</table>
<h3 id="oap-mesh-analysis-latency">OAP Mesh Analysis Latency</h3>
<p>The process latency of OAP service mesh telemetry streaming process.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mesh_analysis_latency_bucket</code></td>
<td><code>component</code> <code>plane</code></td>
<td><pre class="language-text">histogram_quantile(0.99, sum(rate(mesh_analysis_latency_bucket{plane=&ldquo;control&rdquo;, component=&ldquo;oap&rdquo;}[1m])) by (le))</pre></td>
</tr>
<tr>
<td><code>mesh_analysis_latency_bucket</code></td>
<td><code>component</code> <code>plane</code></td>
<td><pre class="language-text">histogram_quantile(0.95, sum(rate(mesh_analysis_latency_bucket{plane=&ldquo;control&rdquo;, component=&ldquo;oap&rdquo;}[1m])) by (le))</pre></td>
</tr>
<tr>
<td><code>mesh_analysis_latency_bucket</code></td>
<td><code>component</code> <code>plane</code></td>
<td><pre class="language-text">histogram_quantile(0.90, sum(rate(mesh_analysis_latency_bucket{plane=&ldquo;control&rdquo;, component=&ldquo;oap&rdquo;}[1m])) by (le))</pre></td>
</tr>
<tr>
<td><code>mesh_analysis_latency_bucket</code></td>
<td><code>component</code> <code>plane</code></td>
<td><pre class="language-text">histogram_quantile(0.75, sum(rate(mesh_analysis_latency_bucket{plane=&ldquo;control&rdquo;, component=&ldquo;oap&rdquo;}[1m])) by (le))</pre></td>
</tr>
</tbody>
</table>
<h3 id="oap-zipkin-trace-rate">OAP Zipkin Trace Rate</h3>
<p>The OAP Zipkin processing trace rate</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>trace_in_latency_count</code></td>
<td><code>plane</code> <code>protocol</code></td>
<td><pre class="language-text">sum(rate(trace_in_latency_count{protocol=&lsquo;zipkin-http&rsquo;,plane=&lsquo;control&rsquo;}[1m]))</pre></td>
</tr>
</tbody>
</table>
<h3 id="oap-zipkin-trace-latency">OAP Zipkin Trace Latency</h3>
<p>The OAP trace processing latency</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>trace_in_latency_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.99, sum(rate(trace_in_latency_bucket[5m])) by (le))</pre></td>
</tr>
<tr>
<td><code>trace_in_latency_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.95, sum(rate(trace_in_latency_bucket[5m])) by (le))</pre></td>
</tr>
<tr>
<td><code>trace_in_latency_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.90, sum(rate(trace_in_latency_bucket[5m])) by (le))</pre></td>
</tr>
<tr>
<td><code>trace_in_latency_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.75, sum(rate(trace_in_latency_bucket[5m])) by (le))</pre></td>
</tr>
<tr>
<td><code>trace_in_latency_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.50, sum(rate(trace_in_latency_bucket[5m])) by (le))</pre></td>
</tr>
</tbody>
</table>
<h3 id="oap-zipkin-trace-error-rate">OAP Zipkin Trace Error Rate</h3>
<p>The OAP Zipkin processing trace error rate</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>trace_analysys_error_count</code></td>
<td><code>plane</code> <code>protocol</code></td>
<td><pre class="language-text">sum(rate(trace_analysys_error_count{protocol=&lsquo;zipkin-http&rsquo;,plane=&lsquo;control&rsquo;}[1m]))</pre></td>
</tr>
</tbody>
</table>
<h3 id="jvm-threads">JVM Threads</h3>
<p>Numbed of threads in OAP JVM</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>jvm_threads_current</code></td>
<td><code>component</code> <code>plane</code></td>
<td><pre class="language-text">sum(jvm_threads_current{component=&ldquo;oap&rdquo;, plane=&ldquo;management&rdquo;})</pre></td>
</tr>
<tr>
<td><code>jvm_threads_daemon</code></td>
<td><code>component</code> <code>plane</code></td>
<td><pre class="language-text">sum(jvm_threads_daemon{component=&ldquo;oap&rdquo;, plane=&ldquo;management&rdquo;})</pre></td>
</tr>
<tr>
<td><code>jvm_threads_deadlocked</code></td>
<td><code>component</code> <code>plane</code></td>
<td><pre class="language-text">sum(jvm_threads_deadlocked{component=&ldquo;oap&rdquo;, plane=&ldquo;management&rdquo;})</pre></td>
</tr>
<tr>
<td><code>jvm_threads_peak</code></td>
<td><code>component</code> <code>plane</code></td>
<td><pre class="language-text">sum(jvm_threads_peak{component=&ldquo;oap&rdquo;, plane=&ldquo;management&rdquo;})</pre></td>
</tr>
</tbody>
</table>
<h3 id="jvm-memory">JVM Memory</h3>
<p>JVM Memory stats of OAP JVM instances.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>jvm_memory_bytes_max</code></td>
<td><code>component</code> <code>plane</code></td>
<td><pre class="language-text">sum by (area, instance) (jvm_memory_bytes_max{component=&ldquo;oap&rdquo;, plane=&ldquo;management&rdquo;})</pre></td>
</tr>
<tr>
<td><code>jvm_memory_bytes_used</code></td>
<td><code>component</code> <code>plane</code></td>
<td><pre class="language-text">sum by (area, instance) (jvm_memory_bytes_used{component=&ldquo;oap&rdquo;, plane=&ldquo;management&rdquo;})</pre></td>
</tr>
</tbody>
</table>
<h2 id="tsb-operational-status">TSB Operational Status</h2>
<p>Operational metrics to indicate Tetrate Service Bridge API server health.</p>
<h3 id="front-envoy-success-rate">Front Envoy Success Rate</h3>
<p>Rate of successful requests to Front Envoy. This includes all user and cluster requests into the management plane.</p>
<p>Note: This indicates the health of the AuthZ server not whether the user or cluster making the request has the correct permissions.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>envoy_cluster_internal_upstream_rq</code></td>
<td><code>component</code> <code>envoy_response_code</code></td>
<td><pre class="language-text">sum(rate(envoy_cluster_internal_upstream_rq{envoy_response_code=~&ldquo;2.<em>|3.</em>|401&rdquo;, component=&ldquo;front-envoy&rdquo;}[1m])) by (envoy_cluster_name)</pre></td>
</tr>
</tbody>
</table>
<h3 id="front-envoy-error-rate">Front Envoy Error Rate</h3>
<p>The error rate of requests to the Front Envoy server. This includes all user and cluster requests into the management plane.
Note: This indicates the health of the AuthZ server not whether the user or cluster making the request has the correct permissions.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>envoy_cluster_internal_upstream_rq</code></td>
<td><code>component</code> <code>envoy_response_code</code></td>
<td><pre class="language-text">sum(rate(envoy_cluster_internal_upstream_rq{envoy_response_code!~&ldquo;2.<em>|3.</em>|401&rdquo;, component=&ldquo;front-envoy&rdquo;}[1m])) by (envoy_cluster_name, envoy_response_code)</pre></td>
</tr>
</tbody>
</table>
<h3 id="front-envoy-latency">Front Envoy Latency</h3>
<p>Front Envoy request latency percentiles.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>envoy_cluster_internal_upstream_rq_time_bucket</code></td>
<td><code>component</code></td>
<td><pre class="language-text">histogram_quantile(0.99, sum(rate(envoy_cluster_internal_upstream_rq_time_bucket{component=&ldquo;front-envoy&rdquo;}[1m])) by (le, envoy_cluster_name))</pre></td>
</tr>
<tr>
<td><code>envoy_cluster_internal_upstream_rq_time_bucket</code></td>
<td><code>component</code></td>
<td><pre class="language-text">histogram_quantile(0.95, sum(rate(envoy_cluster_internal_upstream_rq_time_bucket{component=&ldquo;front-envoy&rdquo;}[1m])) by (le, envoy_cluster_name))</pre></td>
</tr>
</tbody>
</table>
<h3 id="tsb-success-rate">TSB Success Rate</h3>
<p>Rate of successful requests to the TSB apiserver from the UI and CLI.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>grpc_server_handled_total</code></td>
<td><code>component</code> <code>grpc_code</code> <code>grpc_method</code> <code>grpc_type</code></td>
<td><pre class="language-text">sum(rate(grpc_server_handled_total{component=&ldquo;tsb&rdquo;, grpc_code=&ldquo;OK&rdquo;, grpc_type=&ldquo;unary&rdquo;, grpc_method!=&ldquo;SendAuditLog&rdquo;}[1m])) by (grpc_method)</pre></td>
</tr>
</tbody>
</table>
<h3 id="tsb-error-rate">TSB Error Rate</h3>
<p>Rate of failed requests to the TSB apiserver from the UI and CLI.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>grpc_server_handled_total</code></td>
<td><code>component</code> <code>grpc_code</code> <code>grpc_method</code> <code>grpc_type</code></td>
<td><pre class="language-text">sum(rate(grpc_server_handled_total{component=&ldquo;tsb&rdquo;, grpc_code!=&ldquo;OK&rdquo;, grpc_type=&ldquo;unary&rdquo;, grpc_method!=&ldquo;SendAuditLog&rdquo;}[1m])) by (grpc_code)</pre></td>
</tr>
</tbody>
</table>
<h3 id="authentication-success-rate">Authentication Success Rate</h3>
<p>The success rate for authentication operations for each type of authentication provider.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>iam_auth_time_count</code></td>
<td><code>error</code></td>
<td><pre class="language-text">sum(rate(iam_auth_time_count{error=&quot;&quot;}[1m])) by (provider)</pre></td>
</tr>
</tbody>
</table>
<h3 id="authentication-error-rate">Authentication Error Rate</h3>
<p>The error rate for authentication operations for each type of authentication provider.</p>
<p>Spikes may indicate problems with the provider or the given credentials, such as expired JWT tokens.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>iam_auth_time_count</code></td>
<td><code>error</code></td>
<td><pre class="language-text">sum(rate(iam_auth_time_count{error!=&quot;&quot;}[1m])) by (provider)</pre></td>
</tr>
</tbody>
</table>
<h3 id="authentication-latency">Authentication Latency</h3>
<p>The latency for authentication operations for each type of authentication provider.</p>
<p>Spikes in the latency may indicate that the authentication provider has a sub-optimal configuration (such as too wide LDAP queries).</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>iam_auth_time_bucket</code></td>
<td><code>error</code></td>
<td><pre class="language-text">histogram_quantile(0.99, sum(rate(iam_auth_time_bucket{error=&quot;&quot;}[1m])) by (le, provider))</pre></td>
</tr>
<tr>
<td><code>iam_auth_time_bucket</code></td>
<td><code>error</code></td>
<td><pre class="language-text">histogram_quantile(0.95, sum(rate(iam_auth_time_bucket{error=&quot;&quot;}[1m])) by (le, provider))</pre></td>
</tr>
</tbody>
</table>
<h3 id="data-store-success-rate">Data Store Success Rate</h3>
<p>Successful request rate for operations persisting data to the datastore grouped by method and kind.</p>
<p>This graph also includes transactions. These are standard SQL transactions and consist of multiple operations.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>persistence_operation</code></td>
<td><code>error</code></td>
<td><pre class="language-text">sum(rate(persistence_operation{error=&quot;&quot;}[1m])) by (kind, method)</pre></td>
</tr>
<tr>
<td><code>persistence_transaction</code></td>
<td><code>error</code></td>
<td><pre class="language-text">sum(rate(persistence_transaction{error=&quot;&quot;}[1m]))</pre></td>
</tr>
</tbody>
</table>
<h3 id="data-store-latency">Data Store Latency</h3>
<p>The request latency for operations persisting data to the datastore grouped by method.</p>
<p>This graph also includes transactions. These are standard SQL transactions and consist of multiple operations.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>persistence_operation_duration_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.99, sum(rate(persistence_operation_duration_bucket[1m])) by (le, method))</pre></td>
</tr>
<tr>
<td><code>persistence_transaction_duration_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.99, sum(rate(persistence_transaction_duration_bucket[1m])) by (le))</pre></td>
</tr>
</tbody>
</table>
<h3 id="data-store-error-rate">Data Store Error Rate</h3>
<p>The request error rate for operations persisting data to the datastore grouped by method and kind.
This graph also includes transactions. These are standard SQL transactions and consists of multiple operations.
Note: The graph explicitly excludes &ldquo;resource not found&rdquo; errors. A small number of &ldquo;not found&rdquo; responses are normal as TSB for optimization often uses Get queries instead of Exists to determine the resource existence.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>persistence_operation</code></td>
<td><code>error</code> <code>kind</code></td>
<td><pre class="language-text">sum(rate(persistence_operation{error!=&quot;&quot;, kind!=&ldquo;iam_revoked_token&rdquo;}[1m])) by (kind, method, error)</pre></td>
</tr>
<tr>
<td><code>persistence_transaction</code></td>
<td><code>error</code></td>
<td><pre class="language-text">sum(rate(persistence_transaction{error!=&quot;&quot;}[1m])) by (error)</pre></td>
</tr>
</tbody>
</table>
<h3 id="active-transactions">Active Transactions</h3>
<p>The number of running transactions on the datastore.</p>
<p>This graph shows how many active transactions are running at a given point in time. It helps you understand the load of the system generated by concurrent access to the platform.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>persistence_concurrent_transaction</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(persistence_concurrent_transaction)</pre></td>
</tr>
</tbody>
</table>
<h3 id="pdp-success-rate">PDP Success Rate</h3>
<p>Successful request rate of PDP grouped by method.
NGAC is a graph-based authorization framework that consists of three main components:
Policy Information Point (PIP): Maintains the NGAC graph. It creates the nodes and edges in the graph that represents the state of the system. The other components of NGAC use this graph to perform access decisions.
Policy Decision Point (PDP): Performs access decisions based on the NGAC graph&rsquo;s policies. The PDP is used to perform binary Allow/Deny access decisions (Check) and determine the objects a user has access to (List). These access decisions are enforced at the Policy Enforcement Point (PEP).
Policy Enforcement Point (PEP): Enforces access control by calling the PDP to get an access decision. Successful requests to the PDP show the number of requests that the PEP has successfully made to the PDP. A successful request does not represent &ldquo;access granted&rdquo; decisions; they represent the access decision requests for which a verdict was obtained.
A drop in this metric may show that operations against the graph are failing. This may mean that the graph is unavailable for reads and this is usually a consequence of failures in the PIP. Failures in the PIP for write operations will result in the graph not being properly updated to the latest status, resulting in access decisions based on stale models.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ngac_pdp_operation</code></td>
<td><code>error</code></td>
<td><pre class="language-text">sum(rate(ngac_pdp_operation{error=&quot;&quot;}[1m])) by (method)</pre></td>
</tr>
</tbody>
</table>
<h3 id="pdp-error-rate">PDP Error Rate</h3>
<p>Rate of errors for PDP requests grouped by method.
NGAC is a graph-based authorization framework that consists of three main components:
Policy Information Point (PIP): Maintains the NGAC graph. It creates the nodes and edges in the graph that represents the state of the system. The other components of NGAC use this graph to perform access decisions.
Policy Decision Point (PDP): Performs access decisions based on the NGAC graph&rsquo;s policies. The PDP is used to perform binary Allow/Deny access decisions (Check) and determine the objects a user has access to (List). These access decisions are enforced at the Policy Enforcement Point (PEP).
Policy Enforcement Point (PEP): Enforces access control by calling the PDP to get an access decision. Successful requests to the PDP show the number of requests that the PEP has successfully made to the PDP. A successful request does not represent &ldquo;access granted&rdquo; decisions; they represent the access decision requests where a verdict was obtained.
Failed requests to the PDP show the number of requests from the PEP to the PDP that have failed. They do not represent &ldquo;access denied&rdquo; decisions; they represent the access decision requests where a verdict could not be obtained.
A rise in this metric may show that operations against the graph are failing. This may mean that the graph is unavailable for reads and this is usually a consequence of failures in the PIP. Failures in the PIP for write operations will result in the graph not being correctly updated to the latest status, resulting in access decisions based on stale models.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ngac_pdp_operation</code></td>
<td><code>error</code></td>
<td><pre class="language-text">sum(rate(ngac_pdp_operation{error!=&quot;&quot;}[1m])) by (method)</pre></td>
</tr>
</tbody>
</table>
<h3 id="pdp-latency">PDP Latency</h3>
<p>PDP latency percentiles grouped by method.
NGAC is a graph-based authorization framework that consists of three main components:
Policy Information Point (PIP): Maintains the NGAC graph. It creates the nodes and edges in the graph that represents the state of the system. The other components of NGAC use this graph to perform access decisions.
Policy Decision Point (PDP): Performs access decisions based on the NGAC graph&rsquo;s policies. The PDP is used to perform binary Allow/Deny access decisions (Check) and determine the objects a user has access to (List). These access decisions are enforced at the Policy Enforcement Point (PEP).
Policy Enforcement Point (PEP): Enforces access control by calling the PDP to get an access decision. Successful requests to the PDP show the number of requests that the PEP has successfully made to the PDP. A successful request does not represent &ldquo;access granted&rdquo; decisions; they represent the access decision requests for which a verdict was obtained.
This metric shows the time it takes to get an access decision for authorization requests.
Degradation in PDP operations may result in general degradation of the system. PDP latency represents the time it takes to make access decisions, and that will impact user experience since access decisions are made and enforced for every operation.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ngac_pdp_operation_duration_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.99, sum(rate(ngac_pdp_operation_duration_bucket[1m])) by (method, le))</pre></td>
</tr>
<tr>
<td><code>ngac_pdp_operation_duration_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.95, sum(rate(ngac_pdp_operation_duration_bucket[1m])) by (method, le))</pre></td>
</tr>
</tbody>
</table>
<h3 id="pip-success-rate">PIP Success Rate</h3>
<p>Successful request rate of PIP grouped by method.</p>
<p>NGAC is a graph based authorization framework that consists on three main components:</p>
<ul>
<li>Policy Information Point (PIP): Maintains the NGAC graph. It creates the nodes and edges in the graph that represents the state of the system. This graph is used by the other components of NGAC to perform access decisions.</li>
<li>Policy Decision Point (PDP): Performs access decisions based on the policies configured in the NGAC graph. The PDP is used to perform binary Allow/Deny access decisions (Check), and to determine the objects a user has access to (List). These access decisions are enforced at the Policy Enforcement Point (PEP).</li>
<li>Policy Enforcement Point (PEP): Enforces access control by calling the PDP to get an access decision. Successful requests to the PDP show the number of requests that the PEP has successfully made to the PDP. Successful request do not represent &ldquo;access granted&rdquo; decisions; they just represent the access decision requests for which a verdict was obtained.</li>
</ul>
<p>PIP operations are executed against the NGAC graph to represent and maintain the objects in the system and the relationships between them.</p>
<p>A drop in this metric may show that operations against the graph are failing. This may mean that the graph is unavailable for reads, or that it is failing to persist data. Read failures may result in failed access decisions (in the PDP) and user interaction with the system may be rejected as well. Failures in write operations will result in the graph not being properly updated to the latest status and that could result in access decisions based on stale models.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ngac_pip_operation</code></td>
<td><code>error</code></td>
<td><pre class="language-text">sum(rate(ngac_pip_operation{error=&quot;&quot;}[1m])) by (method)</pre></td>
</tr>
</tbody>
</table>
<h3 id="pip-latency">PIP Latency</h3>
<p>PiP latency percentiles grouped by method.</p>
<p>NGAC is a graph based authorization framework that consists on three main components:</p>
<ul>
<li>Policy Information Point (PIP): Maintains the NGAC graph. It creates the nodes and edges in the graph that represents the state of the system. This graph is used by the other components of NGAC to perform access decisions.</li>
<li>Policy Decision Point (PDP): Performs access decisions based on the policies configured in the NGAC graph. The PDP is used to perform binary Allow/Deny access decisions (Check), and to determine the objects a user has access to (List). These access decisions are enforced at the Policy Enforcement Point (PEP).</li>
<li>Policy Enforcement Point (PEP): Enforces access control by calling the PDP to get an access decision. Successful requests to the PDP show the number of requests that the PEP has successfully made to the PDP. Successful request do not represent &ldquo;access granted&rdquo; decisions; they just represent the access decision requests for which a verdict was obtained.</li>
</ul>
<p>This metric shows the time it takes for a PIP operation to complete and, in the case of write operations, to have data persisted in the NGAC graph.</p>
<p>Degradation in PIP operations may result in general degradation of the system. PIP latency represents the time it takes to access the NGAC graph, and this directly affects the PDP when running access decisions. A degraded PIP may result in a degraded PDP, and that will impact user experience, as access decisions are made and enforced for every operation.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ngac_pip_operation_duration_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.99, sum(rate(ngac_pip_operation_duration_bucket[1m])) by (method, le))</pre></td>
</tr>
<tr>
<td><code>ngac_pip_operation_duration_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.95, sum(rate(ngac_pip_operation_duration_bucket[1m])) by (method, le))</pre></td>
</tr>
</tbody>
</table>
<h3 id="pip-error-rate">PIP Error Rate</h3>
<p>Rate of errors for PIP requests grouped by method.</p>
<p>NGAC is a graph based authorization framework that consists on three main components:</p>
<ul>
<li>Policy Information Point (PIP): Maintains the NGAC graph. It creates the nodes and edges in the graph that represents the state of the system. This graph is used by the other components of NGAC to perform access decisions.</li>
<li>Policy Decision Point (PDP): Performs access decisions based on the policies configured in the NGAC graph. The PDP is used to perform binary Allow/Deny access decisions (Check), and to determine the objects a user has access to (List). These access decisions are enforced at the Policy Enforcement Point (PEP).</li>
<li>Policy Enforcement Point (PEP): Enforces access control by calling the PDP to get an access decision. Successful requests to the PDP show the number of requests that the PEP has successfully made to the PDP. Successful request do not represent &ldquo;access granted&rdquo; decisions; they just represent the access decision requests for which a verdict was obtained.</li>
</ul>
<p>PIP operations are executed against the NGAC graph to represent and maintain the objects in the system and the relationships between them.</p>
<p>Note: the &ldquo;Node not found&rdquo; errors are explicitly excluded as TSB often uses <code>GetNode</code> method instead of <code>Exists</code> to determine the node existence, for the purposes of optimisation.</p>
<p>A general raise in this metric may show that operations against the graph are failing. This may mean that the graph is unavailable for reads, or that it is failing to persist data. Read failures may result in failed access decisions (in the PDP) and user interaction with the system may be rejected as well. Failures in write operations will result in the graph not being properly updated to the latest status and that could result in access decisions based on stale models.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ngac_pip_operation</code></td>
<td><code>error</code></td>
<td><pre class="language-text">sum(rate(ngac_pip_operation{error!=&quot;&quot;, error!=&ldquo;Node not found&rdquo;}[1m])) by (method)</pre></td>
</tr>
</tbody>
</table>
<h3 id="active-pip-transactions">Active PIP Transactions</h3>
<p>The number of running transactions on the NGAC PIP.
NGAC is a graph-based authorization framework that consists on three main components:
Policy Information Point (PIP): Maintains the NGAC graph. It creates the nodes and edges in the graph that represents the state of the system. The other components of NGAC use this graph to perform access decisions.
Policy Decision Point (PDP): Performs access decisions based on the NGAC graph&rsquo;s policies. The PDP is used to perform binary Allow/Deny access decisions (Check) and determine the objects a user has access to (List). These access decisions are enforced at the Policy Enforcement Point (PEP).
Policy Enforcement Point (PEP): Enforces access control by calling the PDP to get an access decision. Successful requests to the PDP show the number of requests that the PEP has successfully made to the PDP. A successful request does not represent &ldquo;access granted&rdquo; decisions; they represent the access decision requests for which a verdict was obtained.
This metric shows the number of active write operations against the NGAC graph. It can be useful to understand the load of the system generated by concurrent access to the platform.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ngac_pip_concurrent_transaction</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(ngac_pip_concurrent_transaction)</pre></td>
</tr>
</tbody>
</table>
<h2 id="xcp-central-operational-status">XCP Central Operational Status</h2>
<p>Operational metrics to indicate XCP Central health.</p>
<h3 id="heading"></h3>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>process_start_time_seconds</code></td>
<td><code>component</code> <code>plane</code></td>
<td><pre class="language-text">time() - process_start_time_seconds{component=&ldquo;xcp&rdquo;,plane=&ldquo;management&rdquo;}</pre></td>
</tr>
</tbody>
</table>
<h3 id="xcp-central-version">XCP Central Version</h3>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_central_version</code></td>
<td>N/A</td>
<td><pre class="language-text">label_replace(xcp_central_version, &ldquo;xcp_version&rdquo;, &ldquo;$1&rdquo;, &ldquo;version&rdquo;, &ldquo;(.*)&rdquo;)</pre></td>
</tr>
</tbody>
</table>
<h3 id="time-since-last-cluster-state-received-from-the-edge-seconds">Time since last cluster state received from the edge (seconds)</h3>
<p>Since the default cluster state resync time is 10 minutes, any value higher than 600-700 seconds is considered abnormal.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_central_current_onboarded_edge</code></td>
<td>N/A</td>
<td><pre class="language-text">time() - max((increase(xcp_central_current_onboarded_edge[2m]) unless increase(xcp_central_current_onboarded_edge[2m]) == 0) + on(edge) group_right xcp_central_last_config_propagation_event_timestamp_ms{edge!=&quot;&quot;, status=&ldquo;received&rdquo; , type=&ldquo;cluster_state&rdquo;} /1000) by (edge,type) </pre></td>
</tr>
<tr>
<td><code>xcp_central_last_config_propagation_event_timestamp_ms</code></td>
<td><code>edge</code> <code>status</code> <code>type</code></td>
<td><pre class="language-text">time() - max((increase(xcp_central_current_onboarded_edge[2m]) unless increase(xcp_central_current_onboarded_edge[2m]) == 0) + on(edge) group_right xcp_central_last_config_propagation_event_timestamp_ms{edge!=&quot;&quot;, status=&ldquo;received&rdquo; , type=&ldquo;cluster_state&rdquo;} /1000) by (edge,type) </pre></td>
</tr>
</tbody>
</table>
<h3 id="time-since-cluster-states-were-sent-to-the-mpc-and-edges-clients-seconds">Time since cluster states were sent to the MPC and Edges clients (seconds)</h3>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_central_current_onboarded_edge</code></td>
<td>N/A</td>
<td><pre class="language-text">time() - max((xcp_central_last_cluster_state_event_timestamp_ms / 1000  unless on(peer_cluster_name) label_replace(increase(xcp_central_current_onboarded_edge[5m]),&ldquo;peer_cluster_name&rdquo;, &ldquo;$1&rdquo;, &ldquo;edge&rdquo;, &ldquo;(.<em>)&rdquo;) == 0) unless on(cluster_state_event_cluster_name) label_replace(increase(xcp_central_current_onboarded_edge[5m]),&ldquo;cluster_state_event_cluster_name&rdquo;, &ldquo;$1&rdquo;, &ldquo;edge&rdquo;, &ldquo;(.</em>)&rdquo;) == 0) by (peer_cluster_name, cluster_state_event_cluster_name)</pre></td>
</tr>
<tr>
<td><code>xcp_central_last_cluster_state_event_timestamp_ms</code></td>
<td>N/A</td>
<td><pre class="language-text">time() - max((xcp_central_last_cluster_state_event_timestamp_ms / 1000  unless on(peer_cluster_name) label_replace(increase(xcp_central_current_onboarded_edge[5m]),&ldquo;peer_cluster_name&rdquo;, &ldquo;$1&rdquo;, &ldquo;edge&rdquo;, &ldquo;(.<em>)&rdquo;) == 0) unless on(cluster_state_event_cluster_name) label_replace(increase(xcp_central_current_onboarded_edge[5m]),&ldquo;cluster_state_event_cluster_name&rdquo;, &ldquo;$1&rdquo;, &ldquo;edge&rdquo;, &ldquo;(.</em>)&rdquo;) == 0) by (peer_cluster_name, cluster_state_event_cluster_name)</pre></td>
</tr>
</tbody>
</table>
<h3 id="time-since-config-resync--request-is-received-from-the-edge-seconds">Time since config resync  request is received from the edge (seconds)</h3>
<p>Because regular periodic resync requests would be coming, a high value than the resync period, 60 sec default,  is not normal.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_central_current_onboarded_edge</code></td>
<td>N/A</td>
<td><pre class="language-text">time() - max((increase(xcp_central_current_onboarded_edge[2m]) unless increase(xcp_central_current_onboarded_edge[2m]) == 0) + on(edge) group_right xcp_central_last_config_propagation_event_timestamp_ms{edge!=&quot;&quot;, status=&ldquo;received&rdquo;, type=&ldquo;config_resync_request&rdquo; } /1000) by (edge,type) </pre></td>
</tr>
<tr>
<td><code>xcp_central_last_config_propagation_event_timestamp_ms</code></td>
<td><code>edge</code> <code>status</code> <code>type</code></td>
<td><pre class="language-text">time() - max((increase(xcp_central_current_onboarded_edge[2m]) unless increase(xcp_central_current_onboarded_edge[2m]) == 0) + on(edge) group_right xcp_central_last_config_propagation_event_timestamp_ms{edge!=&quot;&quot;, status=&ldquo;received&rdquo;, type=&ldquo;config_resync_request&rdquo; } /1000) by (edge,type) </pre></td>
</tr>
</tbody>
</table>
<h3 id="time-since-config-crs-sent-to--the-edge-seconds">Time since config CRs sent to  the edge (seconds)</h3>
<p>Sent: Time since configs like workspaces, traffic groups etc were sent to the edge.  In steady state,  a very high value is fine</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_central_current_onboarded_edge</code></td>
<td>N/A</td>
<td><pre class="language-text">time() - max((increase(xcp_central_current_onboarded_edge[1m]) unless increase(xcp_central_current_onboarded_edge[1m]) == 0) + on(edge) group_right xcp_central_last_config_propagation_event_timestamp_ms{edge!=&quot;&quot;, status=&ldquo;sent&rdquo; } /1000) by (edge,type)</pre></td>
</tr>
<tr>
<td><code>xcp_central_last_config_propagation_event_timestamp_ms</code></td>
<td><code>edge</code> <code>status</code></td>
<td><pre class="language-text">time() - max((increase(xcp_central_current_onboarded_edge[1m]) unless increase(xcp_central_current_onboarded_edge[1m]) == 0) + on(edge) group_right xcp_central_last_config_propagation_event_timestamp_ms{edge!=&quot;&quot;, status=&ldquo;sent&rdquo; } /1000) by (edge,type)</pre></td>
</tr>
</tbody>
</table>
<h3 id="messages-received-by-central-from-edges-in-last-5-min">messages received by central from edges in last 5 min</h3>
<p>Number of times any message is received by central from edges</p>
<p>Messages received by central from any edge are of three types:</p>
<ol>
<li>Periodic(per minute by default) config resync request</li>
<li>cluster state</li>
<li>Header message to ack the config received</li>
</ol>
<p>This number is combined count of all three in the last 5 min.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_central_config_propagation_event_count</code></td>
<td><code>status</code> <code>type</code></td>
<td><pre class="language-text">increase(xcp_central_config_propagation_event_count{status=&ldquo;received&rdquo;,type=&ldquo;config_resync_request&rdquo;}[5m]) unless on(edge) increase(xcp_central_current_onboarded_edge[5m]) == 0</pre></td>
</tr>
<tr>
<td><code>xcp_central_config_propagation_event_count</code></td>
<td><code>status</code> <code>type</code></td>
<td><pre class="language-text">increase(xcp_central_config_propagation_event_count{status=&ldquo;received&rdquo;,type=&ldquo;cluster_state&rdquo;}[5m]) unless on(edge) increase(xcp_central_current_onboarded_edge[5m]) == 0</pre></td>
</tr>
<tr>
<td><code>xcp_central_current_onboarded_edge</code></td>
<td>N/A</td>
<td><pre class="language-text">increase(xcp_central_config_propagation_event_count{status=&ldquo;received&rdquo;,type=&ldquo;config_resync_request&rdquo;}[5m]) unless on(edge) increase(xcp_central_current_onboarded_edge[5m]) == 0</pre></td>
</tr>
<tr>
<td><code>xcp_central_current_onboarded_edge</code></td>
<td>N/A</td>
<td><pre class="language-text">increase(xcp_central_config_propagation_event_count{status=&ldquo;received&rdquo;,type=&ldquo;cluster_state&rdquo;}[5m]) unless on(edge) increase(xcp_central_current_onboarded_edge[5m]) == 0</pre></td>
</tr>
</tbody>
</table>
<h3 id="number-of-times-config-crs-sent-by-central-to-the-edges-in-last-5m">Number of times config CRs sent by central to the edges in last 5m</h3>
<p>Number of times config CRs like workspaces. traffic groups etc sent by central in last 5m</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_central_config_propagation_event_count</code></td>
<td><code>status</code></td>
<td><pre class="language-text">increase(xcp_central_config_propagation_event_count{status=&ldquo;sent&rdquo;}[5m]) unless on(edge) increase(xcp_central_current_onboarded_edge[5m]) == 0</pre></td>
</tr>
<tr>
<td><code>xcp_central_current_onboarded_edge</code></td>
<td>N/A</td>
<td><pre class="language-text">increase(xcp_central_config_propagation_event_count{status=&ldquo;sent&rdquo;}[5m]) unless on(edge) increase(xcp_central_current_onboarded_edge[5m]) == 0</pre></td>
</tr>
</tbody>
</table>
<h3 id="config-propagation-latency-by-edge">Config Propagation Latency by Edge</h3>
<p>Distribution of time to propagate updates from Central (Management plane) to Edges. If there is no config push in last  one minute, you will see all 0s, which is expected.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_central_config_propagation_time_ms_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.99, sum(rate(xcp_central_config_propagation_time_ms_bucket[1m])) by (le, edge)) unless on(edge) increase(xcp_central_current_onboarded_edge[5m]) == 0</pre></td>
</tr>
<tr>
<td><code>xcp_central_config_propagation_time_ms_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.95, sum(rate(xcp_central_config_propagation_time_ms_bucket[1m])) by (le, edge)) unless on(edge) increase(xcp_central_current_onboarded_edge[5m]) == 0</pre></td>
</tr>
<tr>
<td><code>xcp_central_config_propagation_time_ms_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.90, sum(rate(xcp_central_config_propagation_time_ms_bucket[1m])) by (le, edge)) unless on(edge) increase(xcp_central_current_onboarded_edge[5m]) == 0</pre></td>
</tr>
<tr>
<td><code>xcp_central_config_propagation_time_ms_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.75, sum(rate(xcp_central_config_propagation_time_ms_bucket[1m])) by (le, edge)) unless on(edge) increase(xcp_central_current_onboarded_edge[5m]) == 0</pre></td>
</tr>
<tr>
<td><code>xcp_central_config_propagation_time_ms_bucket</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.50, sum(rate(xcp_central_config_propagation_time_ms_bucket[1m])) by (le, edge)) unless on(edge) increase(xcp_central_current_onboarded_edge[5m]) == 0</pre></td>
</tr>
<tr>
<td><code>xcp_central_current_onboarded_edge</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.99, sum(rate(xcp_central_config_propagation_time_ms_bucket[1m])) by (le, edge)) unless on(edge) increase(xcp_central_current_onboarded_edge[5m]) == 0</pre></td>
</tr>
<tr>
<td><code>xcp_central_current_onboarded_edge</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.95, sum(rate(xcp_central_config_propagation_time_ms_bucket[1m])) by (le, edge)) unless on(edge) increase(xcp_central_current_onboarded_edge[5m]) == 0</pre></td>
</tr>
<tr>
<td><code>xcp_central_current_onboarded_edge</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.90, sum(rate(xcp_central_config_propagation_time_ms_bucket[1m])) by (le, edge)) unless on(edge) increase(xcp_central_current_onboarded_edge[5m]) == 0</pre></td>
</tr>
<tr>
<td><code>xcp_central_current_onboarded_edge</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.75, sum(rate(xcp_central_config_propagation_time_ms_bucket[1m])) by (le, edge)) unless on(edge) increase(xcp_central_current_onboarded_edge[5m]) == 0</pre></td>
</tr>
<tr>
<td><code>xcp_central_current_onboarded_edge</code></td>
<td>N/A</td>
<td><pre class="language-text">histogram_quantile(0.50, sum(rate(xcp_central_config_propagation_time_ms_bucket[1m])) by (le, edge)) unless on(edge) increase(xcp_central_current_onboarded_edge[5m]) == 0</pre></td>
</tr>
</tbody>
</table>
<h3 id="errors-in-config-push-requests-to-the-edges-in-last-5-minutes">Errors in config push REQUESTS to the edges in last 5 minutes</h3>
<p>Central enqueues the config push request to the debouncer(an internal component of central) when:</p>
<ul>
<li>It receives event about config resources from k8s apiserver , or</li>
<li>Any edge connects first time,  or</li>
<li>It is handling a periodic resync request from any of the edges.</li>
</ul>
<p>In either case, if central meets an error in the event handling before en-queuing the config push request to the debouncer, this metric gets incremented.
So this panel is inversely related to &ldquo;config push(to the edges) requests enqueued to debouncer in last 5 min&rdquo;.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_central_config_update_error_count</code></td>
<td>N/A</td>
<td><pre class="language-text"> increase(xcp_central_config_update_error_count[5m]) OR on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="config-pushto-the-edges-requests-enqueued-to-debouncer-in-last-5-min">config push(to the edges) requests enqueued to debouncer in last 5 min</h3>
<p>Number of times central enqueued config push(to the connected edges) request to the debouncer in last 5 min. Along with count of the request, reason for the config push request are also shown.</p>
<p>Note: This metric does not indicate the count of actual config push by central. Because of debouncing, actual config push will generally be lesser than this metric. In other words, this metric shows input events for config push. Output (config push on grpc channels to edges) will be lesser because of debouncer</p>
<p>Reasons could be:</p>
<ol>
<li>ADD/DELETE/UPDATE :  These are the events received by the central from the k8s apiserver. Example:
ADD/IngressGateway means count of config push requests enqueued because of new IngressGateway CRs creation at k8s apiserver.</li>
<li>EDGE_RESYNC: This shows the count of config push requests when periodic config resync request from edge triggers config push. This will be non-zero only in rare cases when, for whatever reason, edge reported a stale set of configs and central triggers config push to refresh the configs</li>
<li>EDGE_FIRST_CONNECTION: When any edge connects to central, central syncs config to the edge. In steady state, its count must be 0. If its count is non-zero,  that indicates grpc stream between central and edge is in error and getting reconnected.</li>
<li>CENTRAL_RESYNC: central enqueues a config push request every 5 minute to reconcile configs at edges.  Note that this will result into actual config push only to those edges which are not actively sending their config version periodically. Since 1.4, edges request config resync and therefore central will actually push configs over grpc as a result of these request only if edge is &lt; 1.4.</li>
</ol>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_central_config_update_push_count</code></td>
<td>N/A</td>
<td><pre class="language-text">increase(xcp_central_config_update_push_count[5m])</pre></td>
</tr>
</tbody>
</table>
<h3 id="pending-configurations-orphan-configs">Pending configurations (orphan configs)</h3>
<p>Pending configurations are configs for which cluster could not be determined yet because the parent resource is missing.
These metrics show which configurations are currently in Pending state, and the missing Parent group configuration due to which this is in Pending state.</p>
<p>For more information on the Pending configurations can be found by using the XCP central debug endpoint - <code>/debug/cluster_scoped_configs/?pending=true</code></p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_central_pending_configs</code></td>
<td>N/A</td>
<td><pre class="language-text">sum(xcp_central_pending_configs)</pre></td>
</tr>
<tr>
<td><code>xcp_central_pending_configs</code></td>
<td>N/A</td>
<td><pre class="language-text">(xcp_central_pending_configs)</pre></td>
</tr>
</tbody>
</table>
<h3 id="number-of-connectionscluster-state-pushing-and-config-pushing">Number of connections(cluster state pushing and config pushing)</h3>
<p>Central has two type of grpc connections:</p>
<ol>
<li>edge_config_distribution: One grpc connection with each edge for pushing user configs like workspace, trafficgroup etc</li>
<li>cluster_state: One grpc connection with each edge for pushing learned cluster state(service discovery) from all other peer edges. In addition, one more grpc connection with the mpc for pushing all the learned cluster states to the tsb server.</li>
</ol>
<p>count of edge_config_distribution will be equal to the number of edges connected to the central
count of cluster_state connections will be one more that count of edge_config_distribution connections because of additional mpc connection.</p>
<p>IMPORTANT NOTE: If the cluster is not onboarded(TSB cluster object missing), but the edge is up and connected to central, in that scenario connection counts will include such edges</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_central_current_edge_connections</code></td>
<td><code>connection_type</code></td>
<td><pre class="language-text">xcp_central_current_edge_connections{connection_type=&ldquo;edge_config_distribution&rdquo;} OR on() vector(0)</pre></td>
</tr>
<tr>
<td><code>xcp_central_current_edge_connections</code></td>
<td><code>connection_type</code></td>
<td><pre class="language-text">xcp_central_current_edge_connections{connection_type=&ldquo;cluster_state&rdquo;} OR on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="validation-webhook-passed-count-in-last-5-min">validation webhook passed count in last 5 min</h3>
<p>count of requests that validation webhook passed in last 5 minutes by GVK</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_central_validation_webhook_passed_count</code></td>
<td>N/A</td>
<td><pre class="language-text">increase(xcp_central_validation_webhook_passed_count[5m]) OR on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="rate-of-webhook-validation-errors">Rate of webhook validation errors</h3>
<p>Rate of webhook validation errors by GVK</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_central_validation_webhook_failed_count</code></td>
<td>N/A</td>
<td><pre class="language-text">increase(xcp_central_validation_webhook_failed_count[5m]) OR on() vector(0)</pre></td>
</tr>
<tr>
<td><code>xcp_central_validation_webhook_http_error_count</code></td>
<td>N/A</td>
<td><pre class="language-text">increase(xcp_central_validation_webhook_http_error_count[5m]) OR on() vector(0)</pre></td>
</tr>
</tbody>
</table>
<h3 id="all-goroutines">All goroutines</h3>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>go_goroutines</code></td>
<td><code>component</code> <code>plane</code></td>
<td><pre class="language-text">go_goroutines{component=&ldquo;xcp&rdquo;,plane=&ldquo;management&rdquo;}</pre></td>
</tr>
</tbody>
</table>
<h3 id="central-specific-goroutines">Central specific goroutines</h3>
<p>This shows the number of active goroutines in XCP Central that are responsible for config pushes to edges.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>go_goroutines</code></td>
<td><code>component</code> <code>plane</code></td>
<td><pre class="language-text">increase(go_goroutines{component=&ldquo;xcp&rdquo;,plane=&ldquo;management&rdquo;}[1m])</pre></td>
</tr>
<tr>
<td><code>xcp_central_go_routine_count</code></td>
<td>N/A</td>
<td><pre class="language-text">increase(xcp_central_go_routine_count[1m])</pre></td>
</tr>
</tbody>
</table>
<h3 id="central-memory-consumption">Central memory consumption</h3>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>go_memstats_heap_inuse_bytes</code></td>
<td><code>component</code> <code>plane</code></td>
<td><pre class="language-text">go_memstats_heap_inuse_bytes{component=&ldquo;xcp&rdquo;,plane=&ldquo;management&rdquo;}</pre></td>
</tr>
<tr>
<td><code>go_memstats_stack_inuse_bytes</code></td>
<td><code>component</code> <code>plane</code></td>
<td><pre class="language-text">go_memstats_stack_inuse_bytes{component=&ldquo;xcp&rdquo;,plane=&ldquo;management&rdquo;}</pre></td>
</tr>
</tbody>
</table>
<h3 id="edges-memory-consumption">Edges&rsquo; memory consumption</h3>
<p>This shows the current memory usage for all Edges</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>go_memstats_heap_inuse_bytes</code></td>
<td><code>component</code> <code>plane</code></td>
<td><pre class="language-text">go_memstats_heap_inuse_bytes{component=&ldquo;xcp&rdquo;,plane=&ldquo;control&rdquo;}</pre></td>
</tr>
</tbody>
</table>
<h3 id="central-cpu-consumption">Central CPU consumption</h3>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>process_cpu_seconds_total</code></td>
<td><code>job</code></td>
<td><pre class="language-text">rate(process_cpu_seconds_total{job=&ldquo;central-xcp&rdquo;}[1m])</pre></td>
</tr>
</tbody>
</table>
<h3 id="all-edges-cpu-consumption">All edges&rsquo; CPU consumption</h3>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>process_cpu_seconds_total</code></td>
<td><code>job</code></td>
<td><pre class="language-text">rate(process_cpu_seconds_total{job=&ldquo;edge-xcp&rdquo;}[1m])</pre></td>
</tr>
</tbody>
</table>
<h2 id="xcp-edge-status">XCP Edge status</h2>
<h3 id="heading-1"></h3>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>process_start_time_seconds</code></td>
<td><code>cluster_name</code> <code>component</code></td>
<td><pre class="language-text">time() - process_start_time_seconds{cluster_name=&quot;$cluster&quot;,component=&ldquo;xcp&rdquo;}</pre></td>
</tr>
</tbody>
</table>
<h3 id="xcp-edge-version">XCP Edge Version</h3>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_edge_istio_versions</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">label_replace(xcp_edge_istio_versions{cluster_name=&quot;$cluster&quot;}, &ldquo;istio_versions&rdquo;, &ldquo;$1&rdquo;, &ldquo;version&rdquo;, &ldquo;(.*)&rdquo;)</pre></td>
</tr>
<tr>
<td><code>xcp_edge_version</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">label_replace(xcp_edge_version{cluster_name=&quot;$cluster&quot;}, &ldquo;xcp_version&rdquo;, &ldquo;$1&rdquo;, &ldquo;version&rdquo;, &ldquo;(.*)&rdquo;)</pre></td>
</tr>
</tbody>
</table>
<h3 id="number-of-gatewayhost-exposed">Number of gatewayHost exposed</h3>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_edge_gateway_hosts_count</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">xcp_edge_gateway_hosts_count{cluster_name=&quot;$cluster&quot;}</pre></td>
</tr>
</tbody>
</table>
<h3 id="active-connections-to-central">Active connections to central</h3>
<p>Current peer connections this edge holds against remote edges.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_edge_stream_connect_count</code></td>
<td><code>cluster_name</code> <code>statusLabel</code></td>
<td><pre class="language-text">xcp_edge_stream_connect_count{statusLabel=&ldquo;ok&rdquo;, cluster_name=&quot;$cluster&quot;} - ignoring(statusLabel) xcp_edge_stream_connect_count{statusLabel=&ldquo;close&rdquo;, cluster_name=&quot;$cluster&quot;} OR on() xcp_edge_stream_connect_count{statusLabel=&ldquo;ok&rdquo;, cluster_name=&quot;$cluster&quot;} </pre></td>
</tr>
</tbody>
</table>
<h3 id="time-since-any-message-sent-to-central-on-config-stream-seconds">Time since any message sent to central on config stream (seconds)</h3>
<p>Time since any of the following messages is sent by edge to central:</p>
<ol>
<li>Periodic(per minute) config resync request</li>
<li>Ack of last config received</li>
<li>Cluster state
Because regular periodic resync requests would be going out periodically, a high value than the resync period, 60 sec default,  is not normal.</li>
</ol>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_edge_last_push_to_central_timestamp_ms</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">time() - xcp_edge_last_push_to_central_timestamp_ms{cluster_name=&quot;$cluster&quot;} / 1000</pre></td>
</tr>
</tbody>
</table>
<h3 id="number-of-times-edge-updates-were-sent-to-central">Number of times edge updates were sent to Central</h3>
<p>The number of updates successfully sent from an edge to central. Updates can either be of the form <code>cluster state</code> OR <code>headers</code> depending upon whether cluster state or just the header is being pushed.</p>
<p>These updates can be sent for one or more of the following reasons: registration_with_central, service_subset_update (subsets of one or more services changed), config(config change), node_update, service(service change).</p>
<p>The graph represents number of times edge updates were sent to central, with the corresponding reason for the update. The last row shows how many times the <code>gwHostNamespacesChanged</code> flag was true while sending the above updates.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_edge_updates_sent_to_central_count</code></td>
<td><code>cluster_name</code> <code>trigger_reason</code></td>
<td><pre class="language-text">sum by (trigger_reason) (xcp_edge_updates_sent_to_central_count{cluster_name=&quot;$cluster&quot;,trigger_reason!=&ldquo;periodic_config_resync&rdquo;,trigger_reason!=&quot;&quot;})</pre></td>
</tr>
<tr>
<td><code>xcp_edge_updates_sent_to_central_count</code></td>
<td><code>cluster_name</code> <code>gtw_host_namespace_changed</code></td>
<td><pre class="language-text">sum(xcp_edge_updates_sent_to_central_count{cluster_name=&quot;$cluster&quot;,gtw_host_namespace_changed=&ldquo;true&rdquo;})</pre></td>
</tr>
</tbody>
</table>
<h3 id="number-of-times-cluster-states-received-by-edge-from-central-in-last-1-min">Number of times cluster states received by edge from central in last 1 min</h3>
<p>Number of times cluster states are received by edge from central in the last 1 min.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_edge_cluster_state_received_from_central_count</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">increase(xcp_edge_cluster_state_received_from_central_count{cluster_name=&quot;$cluster&quot;}[1m])</pre></td>
</tr>
</tbody>
</table>
<h3 id="number-of-times-config-crs-received-by-edge-from-central-in-last-5-min">Number of times config CRs received by edge from central in last 5 min</h3>
<p>Number of times cluster states are received by edge from central</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_edge_config_updates_received_count</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">increase(xcp_edge_config_updates_received_count{cluster_name=&quot;$cluster&quot;}[5m])</pre></td>
</tr>
</tbody>
</table>
<h3 id="translation-count">Translation count</h3>
<p>Number of Istio config translations in Edge per namespace</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_edge_istio_translations_count</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">xcp_edge_istio_translations_count{cluster_name=&quot;$cluster&quot;}</pre></td>
</tr>
</tbody>
</table>
<h3 id="number-of-times-config-status-sent-by-edge-to-central-in-last-5-min">Number of times config status sent by edge to central in last 5 min</h3>
<p>Number of times config statuses are sent by edge to central, with respective objects&rsquo; Kind.</p>
<p>Messages received by central from any edge are of three types:</p>
<ol>
<li>Periodic(per minute by default) config resync request</li>
<li>cluster state</li>
<li>Header message to ack the config received</li>
</ol>
<p>This number is combined count of all three in the last 5 min.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_edge_config_status_updates_sent_gvk</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">increase(xcp_edge_config_status_updates_sent_gvk{cluster_name=&quot;$cluster&quot;}[5m])</pre></td>
</tr>
</tbody>
</table>
<h3 id="istio-config-reconcile-time-ms">Istio config reconcile time (ms)</h3>
<p>Time (in ms) to generate and apply Istio configurations when updates are received</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_edge_istio_config_reconcile_time_ms_bucket</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">histogram_quantile(0.99, sum(rate(xcp_edge_istio_config_reconcile_time_ms_bucket{cluster_name=&quot;$cluster&quot;}[5m])) by (le))</pre></td>
</tr>
<tr>
<td><code>xcp_edge_istio_config_reconcile_time_ms_bucket</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">histogram_quantile(0.95, sum(rate(xcp_edge_istio_config_reconcile_time_ms_bucket{cluster_name=&quot;$cluster&quot;}[5m])) by (le))</pre></td>
</tr>
</tbody>
</table>
<h3 id="number-of-configs-createdupdated-by-edge-at-k8s-apiserver--every-5-minutes">Number of configs created/updated by edge at k8s apiserver  every 5 minutes</h3>
<p>Shows the activity of Edge creating objects in K8s API, grouped by object kind.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_edge_cr_added</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">increase(xcp_edge_cr_added{cluster_name=&quot;$cluster&quot;}[5m]) OR increase(xcp_edge_cr_updated{cluster_name=&quot;$cluster&quot;}[5m])</pre></td>
</tr>
<tr>
<td><code>xcp_edge_cr_updated</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">increase(xcp_edge_cr_added{cluster_name=&quot;$cluster&quot;}[5m]) OR increase(xcp_edge_cr_updated{cluster_name=&quot;$cluster&quot;}[5m])</pre></td>
</tr>
</tbody>
</table>
<h3 id="number-of-configs-deleted-by-edge-from-k8s-apiserver--every-5-minutes">Number of configs deleted by edge from k8s apiserver  every 5 minutes</h3>
<p>Shows the activity of Edge deleting objects in K8s API, grouped by object kind.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_edge_cr_deleted</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">increase(xcp_edge_cr_deleted{cluster_name=&quot;$cluster&quot;}[5m])</pre></td>
</tr>
</tbody>
</table>
<h3 id="latency-in-cluster-state-propagation-to-central-ms">latency in cluster-state propagation to central (ms)</h3>
<p>Time (in ms) taken to propagate a change in the local cluster state to remote central</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_edge_local_cluster_update_propagation_time_ms_bucket</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">histogram_quantile(0.50, sum(rate(xcp_edge_local_cluster_update_propagation_time_ms_bucket{cluster_name=&quot;$cluster&quot;}[5m])) by (le)) / 1000</pre></td>
</tr>
<tr>
<td><code>xcp_edge_local_cluster_update_propagation_time_ms_bucket</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">histogram_quantile(0.95, sum(rate(xcp_edge_local_cluster_update_propagation_time_ms_bucket{cluster_name=&quot;$cluster&quot;}[5m])) by (le)) / 1000</pre></td>
</tr>
</tbody>
</table>
<h3 id="all-goroutines-1">All goroutines</h3>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>go_goroutines</code></td>
<td><code>cluster_name</code> <code>component</code></td>
<td><pre class="language-text">go_goroutines{cluster_name=&quot;$cluster&quot;, component=&ldquo;xcp&rdquo;}</pre></td>
</tr>
</tbody>
</table>
<h3 id="edge-specific-gorountines">Edge specific gorountines</h3>
<p>This shows the number of active goroutines in XCP Edge that are responsible for config translation.</p>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>xcp_edge_go_routine_count</code></td>
<td><code>cluster_name</code></td>
<td><pre class="language-text">increase(xcp_edge_go_routine_count{cluster_name=&quot;$cluster&quot;}[1m])</pre></td>
</tr>
</tbody>
</table>
<h3 id="edge-cpu-consumption">Edge CPU consumption</h3>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>process_cpu_seconds_total</code></td>
<td><code>cluster_name</code> <code>job</code></td>
<td><pre class="language-text">rate(process_cpu_seconds_total{job=&ldquo;edge-xcp&rdquo;,cluster_name=&quot;$cluster&quot;}[1m])</pre></td>
</tr>
</tbody>
</table>
<h3 id="edge-memory-consumption">Edge memory consumption</h3>
<table>
<thead>
<tr>
<th>Metric Name</th>
<th>Labels</th>
<th>PromQL Expression</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>go_memstats_heap_inuse_bytes</code></td>
<td><code>cluster_name</code> <code>component</code></td>
<td><pre class="language-text">go_memstats_heap_inuse_bytes{component=&ldquo;xcp&rdquo;,cluster_name=&quot;$cluster&quot;}</pre></td>
</tr>
<tr>
<td><code>go_memstats_stack_inuse_bytes</code></td>
<td><code>cluster_name</code> <code>component</code></td>
<td><pre class="language-text">go_memstats_stack_inuse_bytes{component=&ldquo;xcp&rdquo;,cluster_name=&quot;$cluster&quot;}</pre></td>
</tr>
</tbody>
</table>

          </div>

          

<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/tsb/">TSB</a>
  
</div>



          
          
          <div class="article-widget">
            
<div class="container-xl row post-nav">
  
  
  
  <a class="col-6 post-nav-item btn btn-lg mb-md-1" href="/tsb/operations/features/istio-cni/" rel="next">
    <div class="meta-nav">上一页</div>
    <p>Istio CNI</p></a>
  
  
  
  <a class="col-6 post-nav-item btn btn-lg mb-md-1"  href="/tsb/operations/users/configuring-ldap/" rel="prev">
    <div class="meta-nav">下一页</div>
    <p>LDAP as the Identity Provider</p></a>
  
</div>

          </div>
          

        <div class="body-footer">
          <p>最近更新于 2023-09-18</p>

          



          


  
  
  

  

  



          


        </div>

      </article>

      <footer class="site-footer">

  



  

  
  <div class="copyright py-4 bg-footer">
      <div class="row justify-content-center">
        <div class="text-center footer-color">
          <p class="mb-0">© 2017-2023 jimmysong.io all rights reserved</p>
        </div>
    </div>
  </div>

</footer>


    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

  


<script src="/js/vendor-bundle.min.46271ef31da3f018e9cd1b59300aa265.js"></script>




  

  
  

  

  
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js" integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin="anonymous"></script>
    
    
  










  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <div class="article-metadata search-hit-type">{{relpermalink}}</div>
          <a href="{{relpermalink}}">{{title}}</a>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  












  
  
  
  
  
  
  







<script id="page-data" type="application/json">{"use_headroom":false}</script>










  
  


<script src="/zh/js/wowchemy.min.24983018b0e5661cd5fe1822254286ea.js"></script>







  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">引用</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> 复制
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> 下载
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

  <script src="/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js" type="module"></script>
<script>

var mybutton = document.getElementById("backTopBtn");


window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
    mybutton.style.display = "block";
  } else {
    mybutton.style.display = "none";
  }
}


function topFunction() {
  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;
}
</script>






<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
<script>
  anchors.add();
</script>



<script>



(function() {
  'use strict';

  if(!document.queryCommandSupported('copy')) {
    return;
  }

  function flashCopyMessage(el, msg) {
    el.className = "highlight-copy-btn";
    el.textContent = msg;
    setTimeout(function() {
      el.textContent = "";
      el.className = "highlight-copy-btn fa fa-copy";
    }, 1000);
  }

  function selectText(node) {
    var selection = window.getSelection();
    var range = document.createRange();
    range.selectNodeContents(node);
    selection.removeAllRanges();
    selection.addRange(range);
    return selection;
  }

  function addCopyButton(containerEl) {
    var copyBtn = document.createElement("button");
    copyBtn.className = "highlight-copy-btn fa fa-copy";
    copyBtn.textContent = "";

    var codeEl = containerEl.firstElementChild;
    copyBtn.addEventListener('click', function() {
      try {
        var selection = selectText(codeEl);
        document.execCommand('copy');
        selection.removeAllRanges();
        
        flashCopyMessage(copyBtn, '已复制')
        
      } catch(e) {
        console && console.log(e);
        flashCopyMessage(copyBtn, 'Failed :\'(')
      }
    });

    containerEl.appendChild(copyBtn);
  }

  
  var highlightBlocks = document.getElementsByClassName('highlight');
  Array.prototype.forEach.call(highlightBlocks, addCopyButton);
})();
</script>



<script>

function Collapse(e){
  var node = document.getElementById(e);
  if (node.className.indexOf('fa-angle-down') > -1){
    node.setAttribute("class", "fa-solid fa-angle-right");
    }else{
    node.setAttribute("class", "fa-solid fa-angle-down");
    }
}
</script>


</body>
</html>
