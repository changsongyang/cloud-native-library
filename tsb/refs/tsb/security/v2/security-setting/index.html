<!DOCTYPE html><html lang="zh" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.5.0 for Hugo" />
  

  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
    <meta name="google-site-verification" content="google69a5cccb61297807" />
    <meta name="baidu-site-verification" content="cqmZHEleVh" />
  
  
  
  
    
    
    
  
  

  <meta name="author" content="宋净超" />

  
  
  
    
  
  <meta name="description" content="SecuritySetting allows configuring security related properties such as TLS authentication and access control for traffic arriving at a proxy workload in a security group.
Security settings can be propagated along any defined security settings in the configuration hierarchy. How security settings are propagated can be configured by specifying a PropagationStrategy.
The following example creates a security group for the proxy workloads in ns1, ns2 and ns3 namespaces owned by its parent workspace w1 under tenant mycompany and defines a security setting that only allows mutual TLS authenticated traffic from other proxy workloads in the same group.
apiVersion: security.tsb.tetrate.io/v2 kind: Group metadata: name: t1 workspace: w1 tenant: mycompany organization: myorg spec: namespaceSelector: names: - &#34;*/ns1&#34; - &#34;*/ns2&#34; - &#34;*/ns3&#34; configMode: BRIDGED And the associated security settings for all proxy workloads in the group" />

  
  <link rel="alternate" hreflang="zh" href="https://lib.jimmysong.io/tsb/refs/tsb/security/v2/security-setting/" />

  
  
  
    <meta name="theme-color" content="#0a55a7" />
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css" media="print" onload="this.media='all'">

  
  
  
    
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.2c25b2854625561177dfe556e1065970.css" />

  




<script async src="https://www.googletagmanager.com/gtag/js?id=G-MP490FS739"></script>

<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', "G-MP490FS739");
</script>


  


  


  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?2a4b7f65b1839466beaa48d633aa60c1";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  
  
  

  

  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hud79519197c2c386463324871b321d647_6772_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hud79519197c2c386463324871b321d647_6772_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://lib.jimmysong.io/tsb/refs/tsb/security/v2/security-setting/" />

  
  
  
  
  
  
  
  
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary_large_image" />
  
    <meta property="twitter:site" content="@jimmysongio" />
    <meta property="twitter:creator" content="@jimmysongio" />
  
  <meta property="og:site_name" content="云原生资料库" />
  <meta property="og:url" content="https://lib.jimmysong.io/tsb/refs/tsb/security/v2/security-setting/" />
  <meta property="og:title" content="Security Setting | 云原生资料库" />
  <meta property="og:description" content="SecuritySetting allows configuring security related properties such as TLS authentication and access control for traffic arriving at a proxy workload in a security group.
Security settings can be propagated along any defined security settings in the configuration hierarchy. How security settings are propagated can be configured by specifying a PropagationStrategy.
The following example creates a security group for the proxy workloads in ns1, ns2 and ns3 namespaces owned by its parent workspace w1 under tenant mycompany and defines a security setting that only allows mutual TLS authenticated traffic from other proxy workloads in the same group.
apiVersion: security.tsb.tetrate.io/v2 kind: Group metadata: name: t1 workspace: w1 tenant: mycompany organization: myorg spec: namespaceSelector: names: - &#34;*/ns1&#34; - &#34;*/ns2&#34; - &#34;*/ns3&#34; configMode: BRIDGED And the associated security settings for all proxy workloads in the group" /><meta property="og:image" content="https://lib.jimmysong.io/media/sharing.png" />
    <meta property="twitter:image" content="https://lib.jimmysong.io/media/sharing.png" /><meta property="og:locale" content="zh" />
  
    
      <meta
        property="article:published_time"
        content="2023-08-09T12:00:00&#43;08:00"
      />
    
    <meta property="article:modified_time" content="2024-03-06T15:17:26&#43;08:00">
  

  



  

  

  





  <title>Security Setting | 云原生资料库</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " >
  <button onclick="topFunction()" id="backTopBtn" title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden="true"></i></button>
  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.62d6f8dfe8493f1c68557dde65bec362.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6 search-title">
          <p>搜索</p>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="关闭"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="搜索..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="搜索...">
        
      </div>

      
      

      
    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

      <div id="search-common-queries">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    











  


<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/"><img src="/media/logo.svg" alt="云原生资料库"
            
            ></a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="切换导航">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/"><img src="/media/logo.svg" alt="云原生资料库"
          
          ></a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#books"><span>图书</span></a>
          </li>

          
          

          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>教程</span><span class="caret"></span>
            </a>
            <div class="dropdown-menu">
              
                <a class="dropdown-item" href="/kubernetes-handbook"><span>Kubernetes 基础教程</span></a>
              
                <a class="dropdown-item" href="https://academy.tetrate.io/courses/istio-fundamentals-zh"><span>Istio 基础教程</span></a>
              
                <a class="dropdown-item" href="https://academy.tetrate.io/courses/envoy-fundamentals-zh"><span>Envoy 基础教程</span></a>
              
            </div>
          </li>

          
          

          

          
          
          
            
              
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="https://jimmysong.io/blog/" target="_blank" rel="noopener"><span>博客</span></a>
          </li>

          
          

          

          
          
          
            
              
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="https://cloudnative.to/" target="_blank" rel="noopener"><span>社区</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#tags"><span>标签</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>关于</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
            
            <li class="nav-item d-none d-lg-inline-flex">
              <a class="nav-link" href="https://jimmysong.io/contact/" data-toggle="tooltip" data-placement="bottom" title="联系" target="_blank" rel="noopener" aria-label="联系">
                <i class="fab fa-weixin" aria-hidden="true"></i>
              </a>
            </li>
          
            
            <li class="nav-item d-none d-lg-inline-flex">
              <a class="nav-link" href="https://twitter.com/jimmysongio" data-toggle="tooltip" data-placement="bottom" title="关注" target="_blank" rel="noopener" aria-label="关注">
                <i class="fab fa-twitter" aria-hidden="true"></i>
              </a>
            </li>
          
        

        
        <li class="nav-item">
            <a class="nav-link" href="https://jimmysong.io" target="_blank" rel="noopener" data-toggle="tooltip" data-placement="bottom" title="首页" aria-label="首页"><i class="fas fa-home" aria-hidden="true"></i></a>
        </li>
        

        
        
        <li class="nav-item">
            <a class="nav-link js-search" href="#" data-toggle="tooltip" data-placement="bottom" title="搜索" aria-label="搜索"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        

        
        
        
        <li class="nav-item">
          <a href="#" class="nav-link set-theme">
            <i class="fa fa-sun" aria-hidden="true" id="theme-icon"></i>
          </a>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    




<div class="container-xl docs">
  <div class="row flex-xl-nowrap">
    <div class="docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <div class="d-flex">
      <span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">
        
          tsb
        
      </span>
      <span><i class="fas fa-chevron-down"></i></span>
    </div>
  </button>

  
  <button class="form-control sidebar-search js-search d-none d-md-flex">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">搜索...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      
  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      
     
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">目录</a></li>
      </ul>
     

      <nav id="TableOfContents">
  <ul>
    <li><a href="#tetrateio-api-tsb-security-v2-authenticationsettings">AuthenticationSettings</a></li>
    <li><a href="#tetrateio-api-tsb-security-v2-authorizationrules">AuthorizationRules</a></li>
    <li><a href="#tetrateio-api-tsb-security-v2-authorizationsettings">AuthorizationSettings</a></li>
    <li><a href="#tetrateio-api-tsb-security-v2-rule">Rule</a>
      <ul>
        <li><a href="#tetrateio-api-tsb-security-v2-rule-from">From</a></li>
        <li><a href="#tetrateio-api-tsb-security-v2-rule-to">To</a></li>
      </ul>
    </li>
    <li><a href="#tetrateio-api-tsb-security-v2-securitysetting">SecuritySetting</a>
      <ul>
        <li><a href="#tetrateio-api-tsb-security-v2-authorizationsettings-mode">Mode</a></li>
        <li><a href="#tetrateio-api-tsb-security-v2-securitysetting-authenticationmode">AuthenticationMode</a></li>
      </ul>
    </li>
  </ul>
</nav>

      

    </div>
    

    <main class="py-md-3 pl-md-3 docs-content col-xl-8" role="main">

      <article class="article">

          
            
  <nav class="d-none d-md-flex" aria-label="breadcrumb">
    <ol class="breadcrumb">
      
  
    
  
    
  
    
  
    
  

    <li class="breadcrumb-item">
      <a href="/">
        
          首页
        
      </a>
    </li>
  

    <li class="breadcrumb-item">
      <a href="/tsb/">
        
          TSB 手册
        
      </a>
    </li>
  

    <li class="breadcrumb-item">
      <a href="/tsb/refs/">
        
          API
        
      </a>
    </li>
  

    <li class="breadcrumb-item">
      <a href="/tsb/refs/tsb/">
        
          tsb
        
      </a>
    </li>
  

      <li class="breadcrumb-item active" aria-current="page">
        Security Setting
      </li>
    </ol>
  </nav>




          

          <h1>Security Setting</h1>

          <div class="article-style">
            <!-- WARNING: This page is generated. Please take a look at extensions/plugin-service-bridge-api-docs/src/files/doc/page.ejs -->
<p><code>SecuritySetting</code> allows configuring security related properties
such as TLS authentication and access control for traffic arriving
at a proxy workload in a security group.</p>
<p>Security settings can be propagated along any defined security settings in the configuration hierarchy.
How security settings are propagated can be configured by specifying a <em>PropagationStrategy</em>.</p>
<p>The following example creates a security group for the proxy workloads in
<code>ns1</code>, <code>ns2</code> and <code>ns3</code> namespaces owned by its parent workspace
<code>w1</code> under tenant <code>mycompany</code> and defines a security setting that
only allows mutual TLS authenticated traffic from other proxy workloads in
the same group.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">security.tsb.tetrate.io/v2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Group</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">t1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">workspace</span><span class="p">:</span><span class="w"> </span><span class="l">w1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tenant</span><span class="p">:</span><span class="w"> </span><span class="l">mycompany</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">organization</span><span class="p">:</span><span class="w"> </span><span class="l">myorg</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">namespaceSelector</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">names</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="s2">&#34;*/ns1&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="s2">&#34;*/ns2&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="s2">&#34;*/ns3&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">configMode</span><span class="p">:</span><span class="w"> </span><span class="l">BRIDGED</span><span class="w">
</span></span></span></code></pre></div><p>And the associated security settings for all proxy workloads in the group</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">security.tsb.tetrate.io/v2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">SecuritySetting</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">defaults</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l">t1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">workspace</span><span class="p">:</span><span class="w"> </span><span class="l">w1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tenant</span><span class="p">:</span><span class="w"> </span><span class="l">mycompany</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">organization</span><span class="p">:</span><span class="w"> </span><span class="l">myorg</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">authenticationSettings</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">trafficMode</span><span class="p">:</span><span class="w"> </span><span class="l">REQUIRED</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">authorization</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l">GROUP</span><span class="w">
</span></span></span></code></pre></div><p>The following example customizes the <code>allowedSources</code> to allow
traffic from the namespaces within the group as well as the
<code>catalog-sa</code> service account from <code>ns4</code> namespace.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">security.tsb.tetrate.io/v2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">SecuritySetting</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">custom</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l">t1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">workspace</span><span class="p">:</span><span class="w"> </span><span class="l">w1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tenant</span><span class="p">:</span><span class="w"> </span><span class="l">mycompany</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">organization</span><span class="p">:</span><span class="w"> </span><span class="l">myorg</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">authenticationSettings</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">trafficMode</span><span class="p">:</span><span class="w"> </span><span class="l">REQUIRED</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">http</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">rules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">jwt</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">issuer</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;https://auth.tetrate.io&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">jwksUri</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;https://oauth2.auth.tetrate.io/certs&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">issuer</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;https://auth.tetrate.internal&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">jwksUri</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;https://oauth2.auth.tetrate.internal/certs&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">authorization</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l">CUSTOM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">serviceAccounts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="s2">&#34;ns1/*&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="s2">&#34;ns2/*&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="s2">&#34;ns3/*&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span>- <span class="s2">&#34;ns4/catalog-sa&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">http</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">external</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">uri</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;https://policy.auth.tetrate.io&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">includeRequestHeaders</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="l">authorization</span><span class="w">
</span></span></span></code></pre></div><p>The following example <strong>rejects all</strong> traffic arriving at workloads from namespaces
that belong to security group <code>t1</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">security.tsb.tetrate.io/v2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">SecuritySetting</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">defaults</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l">t1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">workspace</span><span class="p">:</span><span class="w"> </span><span class="l">w1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tenant</span><span class="p">:</span><span class="w"> </span><span class="l">mycompany</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">organization</span><span class="p">:</span><span class="w"> </span><span class="l">myorg</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">authenticationSettings</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">trafficMode</span><span class="p">:</span><span class="w"> </span><span class="l">REQUIRED</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">authorization</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l">RULES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">rules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">denyAll</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></div><p>The following example <strong>accepts all</strong> traffic arriving at workloads from namespaces
that belong to security group <code>t1</code>. All authenticated requests are accepted
because any workload is targeted to be allowed nor denied.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">security.tsb.tetrate.io/v2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">SecuritySetting</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">defaults</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l">t1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">workspace</span><span class="p">:</span><span class="w"> </span><span class="l">w1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tenant</span><span class="p">:</span><span class="w"> </span><span class="l">mycompany</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">organization</span><span class="p">:</span><span class="w"> </span><span class="l">myorg</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">authenticationSettings</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">trafficMode</span><span class="p">:</span><span class="w"> </span><span class="l">REQUIRED</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">authorization</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l">RULES</span><span class="w">
</span></span></span></code></pre></div><p>The following example <strong>accepts all</strong> traffic arriving at workloads in namespaces that belong
to security group <code>t1</code> traffic, <strong>except</strong> from workloads belonging to workspace <code>w2</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">security.tsb.tetrate.io/v2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">SecuritySetting</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">defaults</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l">t1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">workspace</span><span class="p">:</span><span class="w"> </span><span class="l">w1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tenant</span><span class="p">:</span><span class="w"> </span><span class="l">mycompany</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">organization</span><span class="p">:</span><span class="w"> </span><span class="l">myorg</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">authenticationSettings</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">trafficMode</span><span class="p">:</span><span class="w"> </span><span class="l">REQUIRED</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">authorization</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l">RULES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">rules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">deny</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span>- <span class="nt">from</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="nt">fqn</span><span class="p">:</span><span class="w"> </span><span class="l">organizations/myorg/tenants/mycompany/workspaces/w2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="nt">to</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="nt">fqn</span><span class="p">:</span><span class="w"> </span><span class="l">organizations/myorg/tenants/mycompany/workspaces/w1/securitygroups/t1</span><span class="w">
</span></span></span></code></pre></div><p>The following example accepts traffic arriving at workloads in namespaces that belong
to security group <code>t1</code> traffic, from workloads belonging to workspace <code>w2</code>.
Hence, only authenticated request to workloads in security group <code>t1</code> coming from
workloads in workspace <code>w2</code> are accepted. All other request will be rejected.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">security.tsb.tetrate.io/v2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">SecuritySetting</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">defaults</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l">t1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">workspace</span><span class="p">:</span><span class="w"> </span><span class="l">w1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tenant</span><span class="p">:</span><span class="w"> </span><span class="l">mycompany</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">organization</span><span class="p">:</span><span class="w"> </span><span class="l">myorg</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">authenticationSettings</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">trafficMode</span><span class="p">:</span><span class="w"> </span><span class="l">REQUIRED</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">authorization</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l">RULES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">rules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">allow</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span>- <span class="nt">from</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="nt">fqn</span><span class="p">:</span><span class="w"> </span><span class="l">organizations/myorg/tenants/mycompany/workspaces/w2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="nt">to</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="nt">fqn</span><span class="p">:</span><span class="w"> </span><span class="l">organizations/myorg/tenants/mycompany/workspaces/w1/securitygroups/t1</span><span class="w">
</span></span></span></code></pre></div><p>The following example uses a combination of allows and denies to show how rules are evaluated.
Let&rsquo;s say we have a workspace <code>w3</code> which contains 3 security groups, <code>sg31</code>, <code>sg32</code>, and <code>sg33</code>. Besides we also
have workspace <code>w1</code> and <code>w2</code>.
Security group <code>sg31</code> contains workloads that handle sensitive data, and we want to
only accept requests arriving from the same workspace <code>w3</code> and explicitly reject requests coming from <code>sg32</code>.
Hence, only authenticated request to workloads in security group <code>sg31</code> coming from
workloads in workspace <code>w3</code> and security group <code>sg31</code> or <code>sg33</code> will be accepted. Requests coming from <code>sg32</code>
will be rejected. Moreover, a request coming from any workload that belongs to another
workspace (<code>w1</code>, or <code>w2</code>), or security group that belong to another workspace, will also be reject
by default because it is not in the list of allowed resource FQNs.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">security.tsb.tetrate.io/v2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">SecuritySetting</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">defaults</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l">sg31</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">workspace</span><span class="p">:</span><span class="w"> </span><span class="l">w3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tenant</span><span class="p">:</span><span class="w"> </span><span class="l">mycompany</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">organization</span><span class="p">:</span><span class="w"> </span><span class="l">myorg</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">authenticationSettings</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">trafficMode</span><span class="p">:</span><span class="w"> </span><span class="l">REQUIRED</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">authorization</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l">RULES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">rules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">allow</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span>- <span class="nt">from</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="nt">fqn</span><span class="p">:</span><span class="w"> </span><span class="l">organizations/myorg/tenants/mycompany/workspaces/w3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="nt">to</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="nt">fqn</span><span class="p">:</span><span class="w"> </span><span class="l">organizations/myorg/tenants/mycompany/workspaces/w3/securitygroups/sg31</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">deny</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span>- <span class="nt">from</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="nt">fqn</span><span class="p">:</span><span class="w"> </span><span class="l">organizations/myorg/tenants/mycompany/workspaces/w3/securitygroups/sg32</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="nt">to</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="nt">fqn</span><span class="p">:</span><span class="w"> </span><span class="l">organizations/myorg/tenants/mycompany/workspaces/w3/securitygroups/sg31</span><span class="w">
</span></span></span></code></pre></div><p>The following example customizes the <code>WAFSettings</code> to enforce Web Application
Firewall rules on sidecars in namespaces reside in SecurityGroup.</p>
<p>Please <strong>DO NOT</strong> use it in production.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">security.tsb.tetrate.io/v2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">SecuritySetting</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">defaults</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l">t1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">workspace</span><span class="p">:</span><span class="w"> </span><span class="l">w1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tenant</span><span class="p">:</span><span class="w"> </span><span class="l">mycompany</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">organization</span><span class="p">:</span><span class="w"> </span><span class="l">myorg</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">waf</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">rules</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">SecRuleEngine ON</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">Include @owasp_crs/*.conf</span><span class="w">
</span></span></span></code></pre></div><p>The following example customizes the <code>Extensions</code> to enable
the execution of the WasmExtensions list specified, detailing
custom properties for the execution of each extension.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">security.tsb.tetrate.io/v2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">SecuritySetting</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">defaults</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">group</span><span class="p">:</span><span class="w"> </span><span class="l">t1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">workspace</span><span class="p">:</span><span class="w"> </span><span class="l">w1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">tenant</span><span class="p">:</span><span class="w"> </span><span class="l">mycompany</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">organization</span><span class="p">:</span><span class="w"> </span><span class="l">myorg</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">extension</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">fqn</span><span class="p">:</span><span class="w"> </span><span class="l">hello-world</span><span class="w"> </span><span class="c"># fqn of imported extensions in TSB</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">foo</span><span class="p">:</span><span class="w"> </span><span class="l">bar</span><span class="w">
</span></span></span></code></pre></div><h2 id="tetrateio-api-tsb-security-v2-authenticationsettings">AuthenticationSettings</h2>
<p>AuthenticationSettings represents configuration related to authenticating traffic
within the mesh and end-user credentials if present. It is <strong>HIGHLY RECOMMENDED</strong> to
enable mutual TLS when end-user credentials are present. Sending credentials like JWT
over plaintext is a security risk.</p>
<div class="generated-table"></div>
<table>
<thead>
<tr>
<th>Field</th>
<th class="description">Description</th>
<th>Validation Rule</th>
</tr>
</thead>
<tr>
<td>
<p>trafficMode</p>
</td>
<td>
<p><a href="../../../tsb/security/v2/security_setting#tetrateio-api-tsb-security-v2-securitysetting-authenticationmode">tetrateio.api.tsb.security.v2.SecuritySetting.AuthenticationMode</a> <br/> Traffic authentication mode is used to specify if mTLS or plaintext traffic is accepted</p>
</td>
<td>
<p>–</p>
</td>
</tr>
<tr>
<td>
<p>http</p>
</td>
<td>
<p><a href="../../../tsb/auth/v2/auth#tetrateio-api-tsb-auth-v2-authentication">tetrateio.api.tsb.auth.v2.Authentication</a> <br/> HTTP request authentication is used to configure authentication of origin/end-user
credentials like JSON Web Token (JWT). It is highly recommended to set traffic
authentication mode to REQUIRED so that it is transported only over mutual TLS</p>
</td>
<td>
<p>–</p>
</td>
</tr>
</table>
<h2 id="tetrateio-api-tsb-security-v2-authorizationrules">AuthorizationRules</h2>
<p><code>AuthorizationRules</code> specifies which target workloads are allowed or denied.
When the mode is <code>RULES</code>, by default, if no authorization rules are provided all requests will be accepted.
Currently, when a list of allow or deny rules are provided, a workload can only be targeted
by providing the workspace or security group resource the workload belongs to.
When different target workloads are allowed, denied or all workload are denied,
to evaluate if a request is accepted or rejected, denies are evaluated first, and finally allows.
Accepting or denying a request from a workload is determined by:</p>
<ul>
<li>
<p>If deny_all is true, deny the request</p>
</li>
<li>
<p>If deny is defined and there are any denied target workload, deny the request.</p>
</li>
<li>
<p>If there are no allowed target workload, allow the request.</p>
</li>
<li>
<p>If allow is defined and there are any allowed target workload, allow the request.</p>
</li>
<li>
<p>Deny the request.</p>
</li>
</ul>
<div class="generated-table"></div>
<table>
<thead>
<tr>
<th>Field</th>
<th class="description">Description</th>
<th>Validation Rule</th>
</tr>
</thead>
<tr>
<td>
<p>allow</p>
</td>
<td>
<p>List of <a href="../../../tsb/security/v2/security_setting#tetrateio-api-tsb-security-v2-rule">tetrateio.api.tsb.security.v2.Rule</a> <br/> Allow specifies a list of rules. If a request matches at least one rule, the request is accepted.
If no allow rules are provided, all requests are allowed.
Each rule must be unique, no duplicates are allowed.
A rule that is fully contained by another rule is not allowed.
For instance, defining a rule from workspace <code>w1</code> to <code>w2</code> and another rule
from security group <code>sg1</code> (which belongs to workspace <code>w1</code>) to <code>sg2</code> (which belongs to workspace <code>w2</code>)
is not allowed. It is not allowed, because from security group <code>sg1</code> to <code>sg2</code> rule is already allowed by
the rule from workspace <code>w1</code> to <code>ws2</code>.</p>
</td>
<td>
<p>–</p>
</td>
</tr>
<tr>
<td>
<p>denyAll</p>
</td>
<td>
<p><a href="https://developers.google.com/protocol-buffers/docs/proto3#scalar" target="_blank" rel="noopener">bool</a> <br/> Deny all specifies whether all requests should be rejected.
If it is true all requests will be rejected.
If it is false the list of deny rules will be evaluated.</p>
</td>
<td>
<p>–</p>
</td>
</tr>
<tr>
<td>
<p>deny</p>
</td>
<td>
<p>List of <a href="../../../tsb/security/v2/security_setting#tetrateio-api-tsb-security-v2-rule">tetrateio.api.tsb.security.v2.Rule</a> <br/> Deny specifies a list of rules. If a request matches at least one rule, the request is rejected.
If deny rules are provided, the match will never occur, so no request can be rejected.
Each rule must be unique, no duplicates are allowed.
A rule that is fully contained by another rule is not allowed.
For instance, defining a rule from workspace <code>w1</code> to <code>w2</code> and another rule
from security group <code>sg1</code> (which belongs to workspace <code>w1</code>) to <code>sg2</code> (which belongs to workspace <code>w2</code>)
is not allowed. It is not allowed, because from security group <code>sg1</code> to <code>sg2</code> rule is already denied by
the rule from workspace <code>w1</code> to <code>w2</code>.</p>
</td>
<td>
<p>–</p>
</td>
</tr>
</table>
<h2 id="tetrateio-api-tsb-security-v2-authorizationsettings">AuthorizationSettings</h2>
<p><code>AuthorizationSettings</code> define the set of service accounts in one
or more namespaces allowed to access a workload (and hence its
sidecar) in the mesh.</p>
<div class="generated-table"></div>
<table>
<thead>
<tr>
<th>Field</th>
<th class="description">Description</th>
<th>Validation Rule</th>
</tr>
</thead>
<tr>
<td>
<p>mode</p>
</td>
<td>
<p><a href="../../../tsb/security/v2/security_setting#tetrateio-api-tsb-security-v2-authorizationsettings-mode">tetrateio.api.tsb.security.v2.AuthorizationSettings.Mode</a> <br/> A short cut for specifying the set of allowed callers.</p>
</td>
<td>
<p>–</p>
</td>
</tr>
<tr>
<td>
<p>serviceAccounts</p>
</td>
<td>
<p>List of <a href="https://developers.google.com/protocol-buffers/docs/proto3#scalar" target="_blank" rel="noopener">string</a> <br/> When the mode is <code>CUSTOM</code>, <code>serviceAccounts</code> specify the allowed
set of service accounts (and the workloads using them). Must be
in the <code>&lt;namespace&gt;/&lt;service-account-name&gt;</code> format.</p>
<ul>
<li>
<p><code>./*</code> indicates all service accounts in the namespace where the sidecar resides.</p>
</li>
<li>
<p><code>ns1/*</code> indicates all service accounts in the <code>ns1</code> namespace.</p>
</li>
<li>
<p><code>ns1/svc1-sa</code> indicates <code>svc1-sa</code> service account in <code>ns1</code> namespace.</p>
</li>
</ul>
<p>Namespace should be a valid kubernetes namespace, which
follows <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#dns-label-names" target="_blank" rel="noopener">RFC 1123 Label Names</a> rules.
Service account should be a valid kubernetes service account, which
follows <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#dns-subdomain-names" target="_blank" rel="noopener">DNS Subdomain Names</a> rules.</p>
</td>
<td>
<p>repeated = {<br/>  items: <code>{string:{pattern:^\\./\\*$|^[^.*]+/[*]{1}$|^[^.*]+/[^*]+$}}</code><br/>}<br/></p>
</td>
</tr>
<tr>
<td>
<p>http</p>
</td>
<td>
<p><a href="../../../tsb/auth/v2/auth#tetrateio-api-tsb-auth-v2-authorization">tetrateio.api.tsb.auth.v2.Authorization</a> <br/> This is for configuring HTTP request authorization. Currently, we only
support authorizing through an external backend/policy engine like OPA.
Inline authorization rules for JWT are not yet supported for sidecars.</p>
</td>
<td>
<p>–</p>
</td>
</tr>
<tr>
<td>
<p>rules</p>
</td>
<td>
<p><a href="../../../tsb/security/v2/security_setting#tetrateio-api-tsb-security-v2-authorizationrules">tetrateio.api.tsb.security.v2.AuthorizationRules</a> <br/> When the mode is <code>RULES</code>, you can allow or deny workload-to-workload communication by specifying
in the <code>rules</code> field which target workloads are allowed or denied to communicate with other target workloads.
When the mode is <code>RULES</code>, if no authorization rules are provided all requests will be accepted.</p>
</td>
<td>
<p>–</p>
</td>
</tr>
</table>
<h2 id="tetrateio-api-tsb-security-v2-rule">Rule</h2>
<p><code>Rule</code> matches request from a targeted resource (and the workloads that belong to the resource),
to another targeted resource (and the workloads that belong to the resource).
A match occurs when <code>from</code> and <code>to</code> matches the request.
Only resources of type Tenant, Workspace, or Security Group can be targeted.</p>
<div class="generated-table"></div>
<table>
<thead>
<tr>
<th>Field</th>
<th class="description">Description</th>
<th>Validation Rule</th>
</tr>
</thead>
<tr>
<td>
<p>from</p>
</td>
<td>
<p><a href="../../../tsb/security/v2/security_setting#tetrateio-api-tsb-security-v2-rule-from">tetrateio.api.tsb.security.v2.Rule.From</a> <br/> <em>REQUIRED</em> <br/> From specifies the source of a request.</p>
</td>
<td>
<p>–</p>
</td>
</tr>
<tr>
<td>
<p>to</p>
</td>
<td>
<p><a href="../../../tsb/security/v2/security_setting#tetrateio-api-tsb-security-v2-rule-to">tetrateio.api.tsb.security.v2.Rule.To</a> <br/> <em>REQUIRED</em> <br/> To specifies the destination of a request.</p>
</td>
<td>
<p>–</p>
</td>
</tr>
</table>
<h3 id="tetrateio-api-tsb-security-v2-rule-from">From</h3>
<p>From includes the target resource (and the workloads that belong to the resource)
which will be the source of a request.</p>
<div class="generated-table"></div>
<table>
<thead>
<tr>
<th>Field</th>
<th class="description">Description</th>
<th>Validation Rule</th>
</tr>
</thead>
<tr>
<td>
<p>fqn</p>
</td>
<td>
<p><a href="https://developers.google.com/protocol-buffers/docs/proto3#scalar" target="_blank" rel="noopener">string</a> <br/> The target resource identified by FQN which will be the source of a request.</p>
</td>
<td>
<p>–</p>
</td>
</tr>
</table>
<h3 id="tetrateio-api-tsb-security-v2-rule-to">To</h3>
<p>To includes the target resource (and the workloads that belong to the resource)
which will be destination of a request.</p>
<div class="generated-table"></div>
<table>
<thead>
<tr>
<th>Field</th>
<th class="description">Description</th>
<th>Validation Rule</th>
</tr>
</thead>
<tr>
<td>
<p>fqn</p>
</td>
<td>
<p><a href="https://developers.google.com/protocol-buffers/docs/proto3#scalar" target="_blank" rel="noopener">string</a> <br/> The target resource identified by FQN which will be the destination of a request.</p>
</td>
<td>
<p>–</p>
</td>
</tr>
</table>
<h2 id="tetrateio-api-tsb-security-v2-securitysetting">SecuritySetting</h2>
<p>A security setting applies configuration to a set of proxy workloads in a
security group or a workspace. When applied to a security group,
missing fields will inherit values from the workspace-wide setting if any.</p>
<div class="generated-table"></div>
<table>
<thead>
<tr>
<th>Field</th>
<th class="description">Description</th>
<th>Validation Rule</th>
</tr>
</thead>
<tr>
<td>
<p>authentication</p>
</td>
<td>
<p><a href="../../../tsb/security/v2/security_setting#tetrateio-api-tsb-security-v2-securitysetting-authenticationmode">tetrateio.api.tsb.security.v2.SecuritySetting.AuthenticationMode</a> <br/> DEPRECATED: Specifies whether the proxy workloads should accept only mutual TLS
authenticated traffic or allow legacy plaintext traffic as well.
This field is deprecated in favor of <code>authentication_settings</code> and will
be removed in the future release</p>
</td>
<td>
<p>–</p>
</td>
</tr>
<tr>
<td>
<p>authorization</p>
</td>
<td>
<p><a href="../../../tsb/security/v2/security_setting#tetrateio-api-tsb-security-v2-authorizationsettings">tetrateio.api.tsb.security.v2.AuthorizationSettings</a> <br/> The set of service accounts in one or more namespaces allowed or denied to
access a workload (and hence its sidecar) in the mesh.
Authorization is affected by the security setting&rsquo;s defined propagation strategy.
If <code>STRICTER</code> is used the most restrictive AuthorizationSettings mode along the configuration
hierarchy will prevail.</p>
<p>AuthorizationSettings mode can only be changed from <code>UNSET</code> to <code>DISABLED</code> to <code>CLUSTER</code> to <code>WORKSPACE</code>
to <code>NAMESPACE</code> to <code>GROUP</code> to <code>RULES</code> to <code>CUSTOM</code>.
Restricting two <code>CUSTOM</code> AuthorizationSettings is a special case. A service account is considered stricter
if it belongs to the same namespace and it has a concrete service account other than
a wildcard. Hence, the only possibilities to restrict service accounts is from &ldquo;ns/*&rdquo; to &ldquo;ns/svc1-sa&rdquo;.
When two lists of service accounts are compared (a parent and a child list) only the service accounts
from the child list that are stricter (following the previously mentioned rules) or equal to any of
the parent defined service accounts will be used. If none of the children&rsquo;s service accounts is stricter or equal,
then the parent defined list will be used.
For instance, a parent defines &ldquo;ns/*&rdquo;, &ldquo;ns2/svc-sa&rdquo;, and &ldquo;./*&rdquo; service accounts, whereas a child defines
&ldquo;ns/svc1-sa&rdquo;, &ldquo;ns3/svc-sa&rdquo;, and &ldquo;./<em>&rdquo;. The effective strictest list will be &ldquo;ns/svc1-sa&rdquo;, and &ldquo;./</em>&rdquo;.
&ldquo;ns3/svc2-sa&rdquo; is discarded because it will extend the set of service accounts allowed to access
the workload/s, as parent&rsquo;s defined service accounts does not include &ldquo;ns3/*&rdquo; or &ldquo;ns3/svc2-sa&rdquo;.</p>
<p>Restricting two <code>rules</code> AuthorizationSettings is also a special case. To consider a <code>rules</code> stricter,
both allowed and denied rules list need to be considered as stricter.
Allowed rules can only be refined by subsets of the initial rule.
Hence, you cannot allow more workloads, only less.
For instance, if an allow rule <strong>from</strong> workspace <code>w1</code> <strong>to</strong> <code>w2</code> has been specified higher up in the hierarchy,
it can only be refined with the same resource or lineage resources lower down in the resource hierarchy.
Which means, if <code>w1</code> has a child security group <code>sg1</code>, only <code>sg1</code> and <code>w1</code> itself are considered as
a stricter <strong>from</strong> resource target.
In the same way, if <code>w2</code> has a child security group <code>sg2</code>, only <code>sg2</code> and <code>w2</code> itself are considered as
a stricter <strong>to</strong> resource target.
On the other hand, any provided list of denied rules lower down in the hierarchy,
will be considered always stricter, because all ancestor&rsquo;s denied rules are also taken into consideration.
Basically, stricter <code>rules</code> AuthorizationSettings can only allow the same or less,
and/or deny more workloads.</p>
</td>
<td>
<p>–</p>
</td>
</tr>
<tr>
<td>
<p>authenticationSettings</p>
</td>
<td>
<p><a href="../../../tsb/security/v2/security_setting#tetrateio-api-tsb-security-v2-authenticationsettings">tetrateio.api.tsb.security.v2.AuthenticationSettings</a> <br/> Authentication settings is used to set workload-to-workload traffic
and end-user/origin authentication configuration.
Authentication settings is affected by the security setting&rsquo;s defined propagation strategy.
If <code>STRICTER</code> is used the most restrictive AuthenticationSettings traffic mode along the configuration
hierarchy will prevail.
AuthenticationSettings traffic mode can only be changed from <code>UNSET</code> to <code>OPTIONAL</code> to <code>REQUIRED</code>.
Authentication settings http will use replace propagation strategy.</p>
</td>
<td>
<p>–</p>
</td>
</tr>
<tr>
<td>
<p>waf</p>
</td>
<td>
<p><a href="../../../tsb/security/v2/waf_settings#tetrateio-api-tsb-security-v2-wafsettings">tetrateio.api.tsb.security.v2.WAFSettings</a> <br/> NOTICE: this feature is in alpha stage and under active development.
it would encounter breaking changes in further release and should not be adopted in production
WAF settings is used to set firewall rules.</p>
</td>
<td>
<p>–</p>
</td>
</tr>
<tr>
<td>
<p>propagationStrategy</p>
</td>
<td>
<p><a href="../../../tsb/types/v2/types#tetrateio-api-tsb-types-v2-propagationstrategy">tetrateio.api.tsb.types.v2.PropagationStrategy</a> <br/> Propagation strategy specifies how a security setting is propagated along
the configuration hierarchy. The default strategy is <code>REPLACE</code>.
The propagation strategy from security settings can only be changed from <code>REPLACE</code>
to <code>STRICTER</code> along the settings in the configuration hierarchy. Any security setting propagation
strategy changed from the default one, higher up in the configuration hierarchy, will prevail
over any other defined security setting propagation strategy further down in the configuration hierarchy.
For instance, if an organization&rsquo;s default security setting propagation strategy is changed to <code>STRICTER</code>,
a restrictive propagation strategy will be used at tenant, workspace default security settings and group security
settings. <code>STRICTER</code> propagation strategy will be used even though, tenant, workspace or group security settings
specifies a <code>REPLACE</code> propagation strategy.</p>
<p>Security setting properties affected by the propagation strategy are:</p>
<ul>
<li>
<p>Authorization</p>
</li>
<li>
<p>AuthenticationSettings</p>
</li>
<li>
<p>Extension</p>
</li>
</ul>
<p>All the other properties will use the default <code>REPLACE</code> propagation strategy.
How each property affected by the propagation strategy will be restricted is explained in more detail
at each property.</p>
</td>
<td>
<p>–</p>
</td>
</tr>
<tr>
<td>
<p>extension</p>
</td>
<td>
<p>List of <a href="../../../tsb/types/v2/types#tetrateio-api-tsb-types-v2-wasmextensionattachment">tetrateio.api.tsb.types.v2.WasmExtensionAttachment</a> <br/> Extensions specifies all the WasmExtensions assigned to this SecuritySettings
with the specific configuration for each extension. This custom configuration
will override the one configured globally to the extension.
Each extension has a global configuration including enabling and priority
that will condition the execution of the assigned extensions.</p>
</td>
<td>
<p>–</p>
</td>
</tr>
<tr>
<td>
<p>configGenerationMetadata</p>
</td>
<td>
<p><a href="../../../tsb/types/v2/types#tetrateio-api-tsb-types-v2-configgenerationmetadata">tetrateio.api.tsb.types.v2.ConfigGenerationMetadata</a> <br/> Metadata values that will be add into the Istio generated configurations.
When using YAML APIs like<code>tctl</code> or <code>gitops</code>, put them into the <code>metadata.labels</code> or
<code>metadata.annotations</code> instead.
This field is only necessary when using gRPC APIs directly.</p>
</td>
<td>
<p>–</p>
</td>
</tr>
</table>
<h3 id="tetrateio-api-tsb-security-v2-authorizationsettings-mode">Mode</h3>
<p>A short cut for defining the common authorization patterns</p>
<div class="generated-table"></div>
<table>
<thead>
<tr>
<th>Field</th>
<th>Number</th>
<th class="description">Description</th>
</tr>
</thead>
<tr>
<td>
<p>UNSET</p>
</td>
<td>
<p>0</p>
</td>
<td>
<p>Inherit from parent if possible. Otherwise treated as <code>DISABLED</code>.</p>
</td>
</tr>
<tr>
<td>
<p>NAMESPACE</p>
</td>
<td>
<p>1</p>
</td>
<td>
<p>The workload allows traffic from any other authenticated workload in its own
namespace.</p>
</td>
</tr>
<tr>
<td>
<p>GROUP</p>
</td>
<td>
<p>2</p>
</td>
<td>
<p>The workload allows traffic from any other authenticated workload in the security group.</p>
</td>
</tr>
<tr>
<td>
<p>WORKSPACE</p>
</td>
<td>
<p>3</p>
</td>
<td>
<p>The workload allows traffic from any other authenticated workload in the workspace.</p>
</td>
</tr>
<tr>
<td>
<p>CLUSTER</p>
</td>
<td>
<p>4</p>
</td>
<td>
<p>The workload allows traffic from any other authenticated workload in the cluster.</p>
</td>
</tr>
<tr>
<td>
<p>DISABLED</p>
</td>
<td>
<p>5</p>
</td>
<td>
<p>Authorization is disabled.</p>
</td>
</tr>
<tr>
<td>
<p>CUSTOM</p>
</td>
<td>
<p>6</p>
</td>
<td>
<p>The workload allows traffic from service accounts defined explicitly.</p>
</td>
</tr>
<tr>
<td>
<p>RULES</p>
</td>
<td>
<p>7</p>
</td>
<td>
<p>The workload allows or denies traffic from any other authenticated workload that belongs
to the specified rules.</p>
</td>
</tr>
</table>
<h3 id="tetrateio-api-tsb-security-v2-securitysetting-authenticationmode">AuthenticationMode</h3>
<p>AuthenticationMode indicates whether to accept only Istio mutual
TLS authenticated traffic or allow legacy plaintext traffic as
well.</p>
<div class="generated-table"></div>
<table>
<thead>
<tr>
<th>Field</th>
<th>Number</th>
<th class="description">Description</th>
</tr>
</thead>
<tr>
<td>
<p>UNSET</p>
</td>
<td>
<p>0</p>
</td>
<td>
<p>Inherit from parent, if has one. Otherwise treated as OPTIONAL.</p>
</td>
</tr>
<tr>
<td>
<p>OPTIONAL</p>
</td>
<td>
<p>1</p>
</td>
<td>
<p>Accept both plaintext and mTLS authenticated connections.</p>
</td>
</tr>
<tr>
<td>
<p>REQUIRED</p>
</td>
<td>
<p>2</p>
</td>
<td>
<p>Accept only mutual TLS authenticated connections.</p>
</td>
</tr>
</table>

          </div>

          

<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/tsb/">TSB</a>
  
</div>



          
          
          <div class="article-widget">
            
<div class="container-xl row post-nav">
  
  
  
  <a class="col-6 post-nav-item btn btn-lg mb-md-1" href="/tsb/refs/tsb/security/v2/security-service/" rel="next">
    <div class="meta-nav">上一页</div>
    <p>Security Service</p></a>
  
  
  
  <a class="col-6 post-nav-item btn btn-lg mb-md-1"  href="/tsb/refs/tsb/registry/v2/lookup-service/" rel="prev">
    <div class="meta-nav">下一页</div>
    <p>Service Registry Lookup Service</p></a>
  
</div>

          </div>
          

        <div class="body-footer">
          <p>最近更新于 2024-03-06</p>

          





  

<p class="edit-page">
  <a href="https://github.com/rootsongjc/cloud-native-library//edit/master/content/tsb/refs/tsb/security/v2/security-setting.md">
    <i class="fas fa-pen pr-2"></i>编辑本页
  </a>
</p>



          




          


        </div>

      </article>

      <footer class="site-footer">

  



  

  
  <div class="copyright py-4 bg-footer">
      <div class="row justify-content-center">
        <div class="text-center footer-color">
          <p class="mb-0">© 2017-2024 jimmysong.io all rights reserved</p>
        </div>
    </div>
  </div>

</footer>


    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

  


<script src="/js/vendor-bundle.min.5b2c48a98fb93f10e8d01cff2874cdf3.js"></script>




  

  
  

  

  
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js" integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin="anonymous"></script>
    
    
  










  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <div class="article-metadata search-hit-type">{{relpermalink}}</div>
          <a href="{{relpermalink}}">{{title}}</a>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  












  
  
  
  
  
  
  







<script id="page-data" type="application/json">{"use_headroom":false}</script>










  
  


<script src="/zh/js/wowchemy.min.a04788cdfce708339d31c0685377d64e.js"></script>







  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">引用</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> 复制
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> 下载
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

  <script src="/js/wowchemy-publication.af9327db0521d4a01354bfc8b77a4324.js" type="module"></script>
<script>

var mybutton = document.getElementById("backTopBtn");


window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
    mybutton.style.display = "block";
  } else {
    mybutton.style.display = "none";
  }
}


function topFunction() {
  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;
}
</script>






<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
<script>
  anchors.add();
</script>



<script>



(function() {
  'use strict';

  if(!document.queryCommandSupported('copy')) {
    return;
  }

  function flashCopyMessage(el, msg) {
    el.className = "highlight-copy-btn";
    el.textContent = msg;
    setTimeout(function() {
      el.textContent = "";
      el.className = "highlight-copy-btn fa fa-copy";
    }, 1000);
  }

  function selectText(node) {
    var selection = window.getSelection();
    var range = document.createRange();
    range.selectNodeContents(node);
    selection.removeAllRanges();
    selection.addRange(range);
    return selection;
  }

  function addCopyButton(containerEl) {
    var copyBtn = document.createElement("button");
    copyBtn.className = "highlight-copy-btn fa fa-copy";
    copyBtn.textContent = "";

    var codeEl = containerEl.firstElementChild;
    copyBtn.addEventListener('click', function() {
      try {
        var selection = selectText(codeEl);
        document.execCommand('copy');
        selection.removeAllRanges();
        
        flashCopyMessage(copyBtn, '已复制')
        
      } catch(e) {
        console && console.log(e);
        flashCopyMessage(copyBtn, 'Failed :\'(')
      }
    });

    containerEl.appendChild(copyBtn);
  }

  
  var highlightBlocks = document.getElementsByClassName('highlight');
  Array.prototype.forEach.call(highlightBlocks, addCopyButton);
})();
</script>



<script>

function Collapse(e){
  var node = document.getElementById(e);
  if (node.className.indexOf('fa-angle-down') > -1){
    node.setAttribute("class", "fa-solid fa-angle-right");
    }else{
    node.setAttribute("class", "fa-solid fa-angle-down");
    }
}
</script>


</body>
</html>
